(window.webpackJsonp=window.webpackJsonp||[]).push([[7],{1419:function(e,t,n){"use strict";n.d(t,"a",function(){return V});var r=n(1),a=n(109),o=(n(1422),n(146)),i=n.n(o),l=(n(167),n(353)),c=n.n(l),s=(n(578),n(352)),u=n.n(s),m=(n(248),n(1377)),d=n.n(m),f=(n(1376),n(1371)),p=n.n(f),h=(n(1370),n(168)),g=n.n(h),v=(n(354),n(23)),y=n.n(v),b=(n(351),n(582)),w=n.n(b),E=(n(581),n(584)),S=n.n(E),k=(n(583),n(580)),C=n.n(k),R=(n(579),n(11)),O=n(16),N=n.n(O);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function T(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function I(e){return(I=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function P(e,t){return(P=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=c.a.Option,M=u.a.Group,L=p.a.RangePicker,F=C.a.CheckableTag,_={SelectInput:function(e){var t=e.selectValue,n=e.inputValue,a=e.placeholder,o=e.options,i=e.onSelectChange,l=e.onInputChange,s=e.onPressEnter,m=e.selectStyle;return r.createElement(M,{compact:!0},r.createElement(c.a,{style:m?Object.assign({width:110},m):{width:110},value:t,onChange:i},o&&o.map(function(e,t){return r.createElement(D,{key:t,value:e.value},e.title)})),r.createElement(u.a,{style:{width:238},value:n,onChange:l,placeholder:a,onPressEnter:s}))},Select:function(e){var t=e.option,n=e.label,a=e.mode,o=e.onSearch,i=e.onSelect,l=e.onBlur,s=e.onFocus,u=e.value,m=e.placeholder,d=e.showSearch,f=e.width,p=e.filterOption,h=e.onChange,g=e.allowClear,v=e.onPopupScroll;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(c.a,{allowClear:g,value:u,mode:a||!1,style:{minWidth:f||258,width:f},showSearch:d,placeholder:m,filterOption:p,onSearch:o,onSelect:i,onChange:h,onBlur:l,onPopupScroll:v,onFocus:s},t.data.map(function(e){return r.createElement(D,{key:e[t.key]||e.id,value:e[t.value]||e.id,$data:e},e[t.title])}))))},DatePicker:function(e){var t=e.label,n=e.placeholder,a=e.onChange,o=e.value,i=e.style,l=e.format,c=e.showTime;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(p.a,{format:l||!1,style:i,showTime:c,placeholder:n,value:o,onChange:a})))},RangePicker:function(e){var t=e.label,n=e.alias,a=e.placeholder,o=e.onChange,l=e.value,c=e.showTime,s=e.format;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(L,{style:{width:400},showTime:c,format:s,placeholder:a,value:l,onChange:o}),r.createElement("span",{className:"common-list-control-date-alias"},!R.a.isEmpty(n)&&n.map(function(e,t){return r.createElement(i.a,{key:t,onClick:function(){return o([N()(Date.now()-864e5*e).startOf("day"),N()()])}},e," 天内")}))))},Input:function(e){var t=e.label,n=e.value,a=e.placeholder,o=e.onChange,i=e.width,l=e.onPressEnter;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(u.a,{style:{minWidth:i||258},value:n,onChange:o,placeholder:a,onPressEnter:l})))},Checkbox:function(e){var t=e.label,n=e.value,a=e.onChange;return r.createElement(g.a,{checked:n,onChange:a},t)},CheckableTag:function(e){var t=e.label,n=e.option,a=e.value,o=e.onChange;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},!R.a.isEmpty(n)&&n.map(function(e){return r.createElement(F,{key:e.value,checked:e.value===a,onChange:function(){o(e)}},e.title)})))},Label:function(e,t){var n=e.label;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},t))},Custom:function(e){return r.createElement("div",null,(void 0).props.children)}},V=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=j(this,I(t).apply(this,arguments))).state={collapse:!0},e.toggleCollapse=function(t){e.setState({collapse:!e.state.collapse})},e.renderSearcher=function(){var t=e.props.config,n=t.searcher,a=t.table,o=e.state.collapse;return n&&r.createElement("section",{className:"common-list-search"},e.renderWidgets(n.widgets),a&&a.tableHeader&&a.tableHeader(),r.createElement("div",{className:"common-list-search-right"},!n.hideSearcher&&r.createElement(r.Fragment,null,r.createElement(i.a,{type:"primary",onClick:n.onSearch},"查询"),r.createElement(i.a,{onClick:n.onReset},"重置")),n.collapseControl&&n.collapseControl.showMoreBtn&&r.createElement("span",{className:"common-list-serach-more"},r.createElement("a",{onClick:e.toggleCollapse},o?"更多":"收起"," ",r.createElement(y.a,{type:o?"down":"up"})))))},e.renderWidgets=function(t){var n=e.state.collapse,a=e.props.config.searcher;return t&&r.createElement("div",{className:"common-list-search-left"},t.map(function(t,o){return Array.isArray(t)?r.createElement("div",{key:o,className:"common-list-search-row",style:{display:a.collapseControl&&a.collapseControl.showMoreBtn&&n&&o>0?"none":"flex"}},t.map(function(t){return r.createElement("div",{key:t.label,className:"common-list-search-col",style:Object.assign({},t.style)},_[t.type]&&_[t.type](t,t.children?e.renderWidgets(t.children):null))})):r.createElement("div",{key:t.label,className:"common-list-search-row ".concat(t.className)},_[t.type]&&_[t.type](t,t.children?e.renderWidgets(t.children):null))}))},e.renderAddBtn=function(){var t=e.props.config,n=t.addBtn,a=t.searcher;return n&&r.createElement("section",{className:"common-list-addbtn",style:n.style},"function"==typeof n.title?r.createElement(n.title,null):n.title,r.createElement("div",{className:"common-list-search-batch"},a.batchControl.showBatchControl&&r.createElement(c.a,{placeholder:a.batchControl.placeholder,style:{minWidth:120},defaultValue:void 0,onChange:a.batchControl.onBatch},a.batchControl.options.map(function(e){return r.createElement(D,{key:e.value,value:e.value},e.title)}))))},e.renderTableHeader=function(){var t=e.props.config.tableHeader;return r.createElement("section",{className:"common-list-table-header"},t&&t())},e.renderTable=function(){var t=e.props.config.table,n=t.rowKey,a=t.rowSelection,o=t.columns,i=t.dataSource,l=t.pagination,c=t.onChange,s=t.loading,u=t.locale;return r.createElement("section",{className:"common-list-table"},r.createElement(d.a,{locale:u,rowKey:n||"id",rowSelection:a,columns:o,dataSource:i,loading:s,pagination:l,onChange:c}))},e.renderCards=function(){var t=e.props.config.cards,n=t.dataSource,a=t.loading,o=t.pagination,i=t.renderCard,l=t.addBtn;return r.createElement("div",{className:"common-list-cards-wrapper"},r.createElement("ul",{className:"common-list-cards"},a?r.createElement("div",{className:"common-list-cards-loading"},r.createElement(S.a,null)):r.createElement(r.Fragment,null,r.createElement("li",{className:"common-list-card add-btn"},r.createElement("div",{className:"common-list-card-item",onClick:l.onAddBtnClick},l.icon?r.createElement("img",{src:l.icon,alt:""}):r.createElement(y.a,{type:"plus-circle"}),r.createElement("p",null,l.title))),n.map(function(e){return r.createElement("li",{className:"common-list-card"},r.createElement("div",{className:"common-list-card-item"},i(e)))}))),r.createElement("section",{className:"common-list-cards-pagination"},r.createElement(w.a,Object.assign({},o))))},e}var n,o,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&P(e,t)}(t,a["a"]),n=t,(o=[{key:"render",value:function(){var e=this.props.config;return r.createElement("div",{className:"common-list"},this.renderSearcher(),this.renderAddBtn(),this.renderTableHeader(),e.table&&this.renderTable(),e.cards&&this.renderCards())}}])&&T(n.prototype,o),l&&T(n,l),t}()},1420:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(1),a=n(1375),o=n.n(a),i=(n(1374),n(11));n(1421);function l(e){var t=i.a.getPageBreadcrumb(e.location.pathname),n=e.title,a=e.links,l=e.tabs,c=e.currentTab;return r.createElement("div",{className:"common-header"},r.createElement("section",{className:"common-header-breadcrumb"},t&&r.createElement(o.a,null,t.map(function(e,t){return r.createElement(o.a.Item,{key:t},e.title)}))),r.createElement("section",{className:"common-header-title"},r.createElement("h2",null,n),r.createElement("div",{className:"common-header-links"},a&&a.map(function(t,n){return r.createElement("a",{key:n,onClick:function(){e.history.push(t.path)}},t.title)}))),r.createElement("section",{className:"common-header-tabs"},l&&l.map(function(t,n){return r.createElement("a",{onClick:function(){e.onTabClick(t.id)},className:"".concat(c===t.id?"tab-active":""," ")},r.createElement("span",null,t.title),t.tipComponent&&t.tipComponent())})))}},1421:function(e,t,n){},1422:function(e,t,n){},1423:function(e,t,n){"use strict";var r=function(e){var t=e;return 15===e.length&&(t=function(e){if(/^\d{15}$/.test(e)){e=e.substr(0,6)+"19"+e.substr(6,e.length-6);for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=0,r=0;r<e.length;r++)n+=parseInt(e.substr(r,1))*t[r];return e+["1","0","X","9","8","7","6","5","4","3","2"][n%11]}return e}(e)),function(e){if(!/^\d{17}(\d|x)$/i.test(e))return!1;return null!=={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙",21:"辽宁",22:"吉林",23:"黑龙",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",83:"台湾",91:"国外"}[parseInt(e.substr(0,2))]}(t)},a=function(e){return/^[HMhm]{1}([0-9]{8})$/.test(e)},o=function(e){return/^[0-9]{8}$/.test(e)||/^[0-9]{10}$/.test(e)},i=function(e){return/^[a-zA-Z]{5, 17}$/.test(e)||/^[a-zA-Z0-9]$/.test(e)},l=n(11);function c(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return u});var s={isNonEmpty:function(e,t,n){if(0!==e&&l.a.isEmpty(e))return n&&n(),t},maxLength:function(e,t,n,r){if(e.length>t)return r&&r(),n},minLength:function(e,t,n,r){if(e.length<t)return r&&r(),n},isEmail:function(e,t,n){if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e))return n&&n(),t},isMobile:function(e,t,n){if(!/^(13[0-9]|14[57]|15[012356789]|16[0-9]|18[0-9]|17[0-9]|19[0-9])\d{8}$/.test(e))return n&&n(),t},isID:function(e,t,n,l){var c=null;if("id"===t?c=r:"HKMC"===t?c=a:"TW"===t?c=o:"PSPort"===t&&(c=i),!c(e))return l&&l(),n},isNumber:function(e,t,n){if(e&&Number.isNaN(Number(e)))return n&&n(),t},isHexColor:function(e,t,n){var r=e.toString();if(!r||!function(e){if("#"!==e[0])return!1;var t=e.slice(1);return 6===t.length&&/^[0-9a-fA-f]{6}$/.test(t)}(r))return n&&n(),t},customReg:function(e,t,n,r){var a=e.toString();if(!a||!new RegExp(t).test(a))return r&&r(),n}},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=[]}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){var n=this,r=!0,a=!1,o=void 0;try{for(var i,l=function(){var t=i.value,r=t.strategy.split(":");n.cache.push(function(){var n=r.shift();return r.unshift(e),r.push(t.errMsg),r.push(t.cb),s[n].apply(null,r)})},c=t[Symbol.iterator]();!(r=(i=c.next()).done);r=!0)l()}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}}},{key:"start",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.cache[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=(0,r.value)();if(o)return o}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}}])&&c(t.prototype,n),r&&c(t,r),e}()},1426:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(1),a=n(582),o=n.n(a),i=(n(581),n(1387)),l=n.n(i);n(1386),n(1427);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=u(this,m(t).apply(this,arguments))).$carousel=null,e.changeGalleryIndex=function(t,n){e.props.changeGalleryIndex&&e.props.changeGalleryIndex(t-1)},e}var n,a,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,r["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.props.activeIndex;this.$carousel.goTo(e)}},{key:"componentDidUpdate",value:function(){var e=this.props.activeIndex;this.$carousel.goTo(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.source,a=t.activeIndex;return r.createElement("div",{className:"gallery"},r.createElement("section",{className:"gallery-carousel"},r.createElement(l.a,{ref:function(t){return e.$carousel=t},dots:!1},n&&n.map(function(e){return r.createElement("div",{className:"gallery-item"},r.createElement("h3",{className:"gallery-item-img",style:{backgroundImage:"url(".concat(e.src||e.url||e.imgUrl||e.colorImgUrl,")")}}))}))),r.createElement("section",{className:"gallery-pagination"},r.createElement(o.a,{pageSize:1,current:a+1,total:n.length,onChange:this.changeGalleryIndex})))}}])&&s(n.prototype,a),i&&s(n,i),t}();f.defaultProps={activeIndex:0,source:[]}},1427:function(e,t,n){},1428:function(e,t,n){"use strict";var r=n(1),a=n.n(r),o=n(1388),i=(n(1429),n(23)),l=n.n(i);n(351);function c(e){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==c(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=u(this,m(t).apply(this,arguments))).state={expanded:!1,truncated:!1},e.handleTruncate=function(t){e.state.truncated!==t&&e.setState({truncated:t})},e.toggleLines=function(t){t.preventDefault(),e.setState({expanded:!e.state.expanded})},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,r["Component"]),n=t,(i=[{key:"render",value:function(){var e=this.props,t=e.children,n=e.more,r=e.less,i=e.lines,c=e.width,s=this.state,u=s.expanded,m=s.truncated;return a.a.createElement("div",{className:"ellipsis-text"},a.a.createElement(o.a,{width:c,lines:!u&&i,ellipsis:a.a.createElement("span",null,"...",a.a.createElement("a",{href:"#",onClick:this.toggleLines,className:"expand-text"},n," ",a.a.createElement(l.a,{type:"down"}))),onTruncate:this.handleTruncate},a.a.createElement("div",{style:{width:c}},t)),!m&&u&&a.a.createElement("span",null," ",a.a.createElement("a",{href:"#",className:"expand-text",onClick:this.toggleLines},r)))}}])&&s(n.prototype,i),c&&s(n,c),t}();f.defaultProps={lines:3,more:"更多",less:"收起 >"},t.a=f},1429:function(e,t,n){},1430:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(1);n(1431);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function c(e,t){return(c=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var s={hot:"hot",normal:"normal",wait:"wait",block:"block"},u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,l(t).apply(this,arguments))}var n,a,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&c(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.onTagClick,n=e.active,a=e.text,o=e.type;return r.createElement("span",{className:"status-tag ".concat(n?"active":""," ").concat(s[o]),onClick:t},a)}}])&&o(n.prototype,a),u&&o(n,u),t}()},1431:function(e,t,n){},1432:function(e,t,n){"use strict";n.d(t,"a",function(){return k});var r=n(2),a=n(1),o=n(109),i=n(1369),l=n.n(i),c=(n(1368),n(1385)),s=n.n(c),u=(n(1384),n(1379)),m=n.n(u),d=(n(1378),n(23)),f=n.n(d),p=(n(351),n(16)),h=n.n(p),g=n(1426),v=(n(1433),n(11));function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function E(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function S(e,t){return(S=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var k=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=w(t).apply(this,arguments),(e=!o||"object"!==y(o)&&"function"!=typeof o?E(n):o).state={showPopconfirm:!1,weight:null},e.renderWeightElem=function(t){return a.createElement("div",null,a.createElement("span",null,"权重  "),a.createElement(m.a,{min:0,onChange:e.changeWeight.bind(E(e),t)}))},e.changeWeight=function(t,n){e.setState({weight:{key:t,value:n}})},e.confirmWeight=function(){return r.a(E(e),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({weight:{},showPopconfirm:!1});case 1:case"end":return e.stop()}},e,this)}))},e.cancelWeight=function(){return e.setState({weight:{},showPopconfirm:!1})},e.handleOk=function(){e.props.onOk&&e.props.onOk()},e.handleCancel=function(){e.props.onCancel&&e.props.onCancel()},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&S(e,t)}(t,o["a"]),n=t,(i=[{key:"render",value:function(){var e=this,t=this.props,n=t.title,r=t.visible,o=t.onlyCarousel,i=t.isRecommend,c=this.props,u=this.state.showPopconfirm,m=c.recommendStartTime&&c.recommendEndTime?"".concat(c.recommendStartTime&&h()(c.recommendStartTime).format("YYYY.MM.DD HH:mm:ss")," ~ ").concat(c.recommendEndTime&&h()(c.recommendEndTime).format("YYYY.MM.DD HH:mm:ss")):"";return a.createElement(l.a,{width:800,title:n||"动态详情",visible:r,onOk:this.handleOk,okText:c.okText||(1==c.isRecommend?"取消推荐":"推荐"),cancelText:c.cancelText||"取消",onCancel:this.handleCancel,className:"feed-detail-modal"},a.createElement("section",{className:"feed-detail-carousel"},!v.a.isEmpty(c.feedImg)&&a.createElement(g.a,{source:c.feedImg,activeIndex:c.activeGalleryIndex,changeGalleryIndex:c.changeGalleryIndex})),!o&&a.createElement(a.Fragment,null,a.createElement("p",{className:"feed-detail-content",dangerouslySetInnerHTML:{__html:c.memo}}),a.createElement("div",{className:"feed-detail-runlink"},a.createElement("a",{href:"https://wap.thejoyrun.com/PoWeb.aspx?uid=".concat(c.userId,"&fid=").concat(c.id),target:"_blank"},"跑步记录 >")),a.createElement("div",{className:"feed-detail-profile"},a.createElement("p",null,a.createElement("img",{src:c.faceurl,alt:""}),a.createElement("span",{className:"feed-detail-profile-name"},c.nick),a.createElement("span",{className:"feed-detail-profile-fans"},"（ID：",c.userId," · 粉丝 ",c.profile&&c.profile.fansTotal,"）")),a.createElement("p",{className:"feed-detail-profile-site"},a.createElement("span",null,"发布于 "),a.createElement("strong",null,c.province,"·",c.city)),a.createElement("p",{className:"feed-detail-profile-time"},h()(1e3*c.dateline).format("YYYY.MM.DD hh:mm"))),a.createElement("div",{className:"feed-detail-data"},"recommend"!==c.type?a.createElement("p",null,"热度 ",a.createElement("strong",null,c.hot||"--")," |"):a.createElement("p",null,"权重 ",a.createElement("strong",null,c.weight)," ",a.createElement(s.a,{visible:u,icon:null,title:this.renderWeightElem(c.id),overlayClassName:"feed-detail-popconfirm",onConfirm:this.confirmWeight,onCancel:this.cancelWeight,okText:"确定",cancelText:"取消"},a.createElement(f.a,{type:"edit",onClick:function(){return e.setState({showPopconfirm:!0})}}))," |"),a.createElement("p",null," 点赞 ",a.createElement("strong",null,c.likeCount)," |"),a.createElement("p",null," 评论 ",a.createElement("strong",null,c.reCount)," |"),a.createElement("p",null," 视频播放 ",a.createElement("strong",null,c.pv))),m&&i&&a.createElement("div",{className:"feed-detail-recommend-time"},a.createElement("span",null,"推荐时间："),a.createElement("span",null,m))))}}])&&b(n.prototype,i),c&&b(n,c),t}()},1433:function(e,t,n){},1442:function(e,t,n){},1443:function(e,t,n){},1444:function(e,t,n){},1509:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(1),o=n(109),i=n(1369),l=n.n(i),c=(n(1368),n(1379)),s=n.n(c),u=(n(1378),n(23)),m=n.n(u),d=(n(351),n(1383)),f=n.n(d),p=(n(586),n(1370),n(167),n(120)),h=n(110),g=n(1420),v=n(1419),y=n(200),b=n(146),w=n.n(b),E=n(1385),S=n.n(E),k=(n(1384),n(11)),C=n(16),R=n.n(C),O=n(1430),N=n(1428);function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function T(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var j=function(e){var t={selectedRowKeys:e.state.selectedRowKeys,onChange:function(t,n){"topic"===e.state.currentTab&&e.setState({selectedTopicKeys:n.map(function(e){return e.fid})}),e.setState({selectedRowKeys:t,showPopconfirmId:0})}},n=e.state.currentTab,o=e.state.showPopconfirmId,i=[];"topic"===n?i=[{id:"0",title:"按热度",field:"isHeat"},{id:"1",title:"按赞数",field:"isHeat"},{id:"2",title:"按发布时间",field:"isHeat"}]:(i=[{id:"1",title:"按发布时间",field:"isLikeCount"},{id:"0",title:"按赞数",field:"isLikeCount"}],"recommend"===n&&(i=[{id:"0",title:"按发布时间",field:"isWeight"},{id:"1",title:"按权重",field:"isWeight"},{id:"3",title:"按推荐时间",field:"isWeight"}]));var l=[{title:"FID",dataIndex:"topic"===n?"fid":"id"},{title:"动态详情",render:function(t,r){var i=k.a.parseEmoji(r.memo);return a.createElement("div",{className:"feed-table-detail"},a.createElement("ul",{className:"feed-table-detail-imgs"},!k.a.isEmpty(r.feedImg)&&r.feedImg.map(function(t,o){return a.createElement("li",{onClick:function(){r.video?e.setState({showVideoPlayer:!0,videoUrl:r.video}):(e.setState({activeIndex:o,visible:!0}),e.toggleFeedDetailModal(Object.assign({},r,{type:n}),!0))}},a.createElement("a",null,a.createElement("img",{src:t.imgUrl,alt:""})))})),r.memo&&r.memo.length>200?a.createElement(N.a,{width:600},a.createElement("p",{className:"feed-table-detail-content",dangerouslySetInnerHTML:{__html:i}})):a.createElement("p",{className:"shoe-list-table-detail-content",dangerouslySetInnerHTML:{__html:i}}),a.createElement("div",{className:"feed-table-detail-runlink"},1==r.isRun&&a.createElement("a",{href:"https://wap.thejoyrun.com/PoWeb.aspx?uid=".concat(r.userId||r.uid,"&fid=").concat(r.id||r.fid),target:"_blank"},"跑步记录 >")),a.createElement("div",{className:"feed-table-detail-profile"},a.createElement("p",null,a.createElement("img",{src:r.faceurl,alt:""}),a.createElement("span",{className:"feed-table-detail-profile-name"},r.nick),a.createElement("span",{className:"feed-table-detail-profile-fans"},"（ID：",r.userId||r.uid," · 粉丝 ",r.fansTotal,"）")),a.createElement("p",{className:"feed-table-detail-profile-site"},a.createElement("span",null,"发布于 "),a.createElement("strong",null,r.province,"·",r.city)),a.createElement("p",{className:"feed-table-detail-profile-time"},R()(1e3*r.dateline).format("YYYY.MM.DD HH:mm:ss"))),a.createElement("div",{className:"feed-table-detail-data feed-data-".concat(r.id)},"all"===n||"topic"===n?a.createElement("p",null,"热度 ",a.createElement("strong",null,r.heat||"--")," |"):a.createElement("p",null,"权重 ",a.createElement("strong",null,r.weight)," ",a.createElement(S.a,{visible:r.id===o,icon:null,title:e.renderWeightElem(r.id),getPopupContainer:function(){return document.getElementsByClassName("feed-data-".concat(r.id))[0]},overlayClassName:"feed-table-detail-popconfirm",onConfirm:e.confirmWeight.bind(void 0,r),onCancel:e.cancelWeight,okText:"确定",cancelText:"取消"},a.createElement(m.a,{type:"edit",onClick:function(){return e.setState({showPopconfirmId:r.id})}}))," |"),a.createElement("p",null," 点赞 ",a.createElement("strong",null,r.likeCount)," |"),a.createElement("p",null," 评论 ",a.createElement("strong",null,r.reCount)," |"),a.createElement("p",null," 视频播放 ",a.createElement("strong",null,r.pv))))}},{width:300,title:"操作",render:function(t,r){return a.createElement("div",{className:"feed-table-operation"},a.createElement("span",{className:"feed-table-operation-recommend ".concat("active"),onClick:e.toggleRecommendStatus.bind(e,r)},a.createElement(O.a,{active:0!==r.isRecommend,type:{0:"block",1:"hot"}[r.isRecommend],text:"荐"})),a.createElement("span",{onClick:e.toggleFeedDetailModal.bind(e,Object.assign({},r,{type:n}),!1),className:"feed-table-operation-view"},"查看"))}}],c=[[{type:"SelectInput",label:"用户",placeholder:"请输入用户 ID 或昵称",options:[{title:"用户 ID",value:"userId"},{title:"用户昵称",value:"nick"}],inputValue:e.state.userValue,selectValue:e.state.userField,onSelectChange:function(t){e.setUserField(t)},onInputChange:function(t){e.setUserValue(t.target.value)}}],{type:"RangePicker",label:"起止日期",placeholder:["开始日期","结束日期"],showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",alias:[1,7,30],value:e.state.dateRange||[],onChange:function(t){e.onDateRangeChange(t)}},{type:"Label",label:"其他选项",className:"other-opts",children:[{type:"Select",label:"排序",showSearch:!1,placeholder:"请选择排序选项",style:{marginLeft:30},value:e.state.sortValue,option:{key:"id",value:"id",title:"title",data:i},onSelect:function(t,n){e.onSortSelect(t,n)},onBlur:function(){}},{type:"Label",label:"筛选",className:"other-opts",children:[[{type:"Select",label:"",showSearch:!1,placeholder:"视频",value:e.state.isVideo,option:{key:"id",value:"id",title:"title",data:[{id:void 0,title:"全部"},{id:"1",title:"视频动态"}]},onSelect:function(t,n){e.onFilterSelect("isVideo",t,n)},onBlur:function(){}},{type:"Select",showSearch:!1,placeholder:"图片",value:e.state.isImg,option:{key:"id",value:"id",title:"title",data:[{id:void 0,title:"全部"},{id:"0",title:"无图"},{id:"1",title:"单图"},{id:"2",title:"多图"}]},onSelect:function(t,n){e.onFilterSelect("isImg",t,n)},onBlur:function(){}},{type:"Select",showSearch:!1,placeholder:"话题",value:e.state.memoNum,option:{key:"id",value:"id",title:"title",data:[{id:void 0,title:"全部"},{id:"1",title:"非仅话题"}]},onSelect:function(t,n){e.onFilterSelect("memoNum",t,n)},onBlur:function(){}}]]}]}];"topic"==n&&c[0].push({type:"Input",label:"话题名称",placeholder:"请输入话题名称",value:e.state.topicName||void 0,onChange:function(t){e.onTopicNameChange(t.target.value)},onPressEnter:function(t){e.onSearch()}});var s={batchControl:{placeholder:"更多操作",showBatchControl:!k.a.isEmpty(e.state.selectedRowKeys),options:[{title:"取消推荐",value:"unrecommend"}],onBatch:function(t,n){e.onBatch(t)}},widgets:c,onSearch:function(){e.onSearch()},onReset:function(){e.onReset()}};"all"!==e.state.currentTab&&"topic"!==e.state.currentTab||(s.batchControl.options=[{title:"推荐",value:"recommend"}].concat(T(s.batchControl.options)));var u=10;u="topic"===e.state.currentTab?e.props.feed.feedListMeta.total:e.props.feed.feedList[0]&&e.props.feed.feedList[0].total;var d=Object.assign({},e.props.common.paginationConfig,{pageSizeOptions:"all"===e.state.currentTab?["10","20","30"]:["10","20","30","40","50"],current:e.state.currentPage,total:u,showTotal:!1,onChange:function(e,t){},onShowSizeChange:function(t,n){var r=e.props.feed.feedList[(void 0).props.feed.feedList.length-1];e.resetPagination(n,t,r?r.id:0)}}),f="recommend"===e.state.currentTab?{visibility:"visible",position:"absolute",justifyContent:"flex-end",top:176,right:40}:{visibility:"hidden"};return{addBtn:{title:function(){return a.createElement(S.a,{title:"当前操作将会将全部推荐动态的权重值置为 0，请问是否继续？",onConfirm:function(){return r.a(void 0,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.$api.feed.resetRecommendFeedsWeight({});case 2:if(0==(n=t.sent).data.ret){t.next=7;break}return t.abrupt("return",e.$msg.error(n.data.msg));case 7:e.getDataList(e.state.filter);case 8:case"end":return t.stop()}},t)}))},onCancel:function(){}},a.createElement(w.a,{style:f,type:"link"},"权重值归零"))},style:{marginTop:"recommend"===e.state.currentTab?-40:-90,justifyContent:"recommend"===e.state.currentTab?"flex-end":"space-between"}},searcher:s,table:{rowSelection:t,columns:l,dataSource:e.props.feed.feedList,loading:e.state.tableLoading,pagination:d,onChange:function(t,n,r){var a={pageNum:t.current,limit:t.pageSize};if("all"===e.state.currentTab)if(e.state.filter.pageNum==t.current)a.lastFid=0;else{var o=e.props.feed.feedList[e.props.feed.feedList.length-1];a.lastFid=o?o.id:0}if(!k.a.isEmpty(n))for(var i=0,l=Object.entries(n);i<l.length;i++){var c=x(l[i],2),s=c[0],u=c[1];a[s]=u?u[0]:void 0}k.a.isEmpty(r)||(a.orderBy="".concat(r.field),a.sort="".concat("descend"===r.order?"desc":"asc")),e.setState({filter:Object.assign({},e.state.filter,a),currentPage:t.current},function(){e.getDataList(e.state.filter)})}}}},I=(n(1442),n(1375)),P=n.n(I),D=(n(1374),n(1373)),M=n.n(D),L=(n(1372),n(352)),F=n.n(L),_=(n(248),n(1381)),V=n.n(_);n(1380);function Y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var $=function(e){var t=[{title:"分群名称",render:function(e,t){return a.createElement("span",null,t.groupName)}},{title:"创建时间",render:function(e,t){return a.createElement("span",null,R()(t.createTime).format("YYYY.MM.DD HH:mm:ss"))}},{title:"人数",dataIndex:"userNum"},{title:"操作",render:function(t,n){return a.createElement("div",{className:"common-list-table-operation"},a.createElement("span",{onClick:function(){return r.a(void 0,void 0,void 0,regeneratorRuntime.mark(function t(){var r,a,o,i,l;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.props.common.paginationConfig,a=r.defaultPageSize,o=r.defaultCurrent,i="/admin/community/tool/feed/group-list?groupId=".concat(n.groupId,"&groupName=").concat(n.groupName,"#feed"),e.props.history.push(i),t.next=5,e.$api.feed.getGroupList({params:{pageNum:1,limit:10,grounpId:n.groupId}});case 5:l=t.sent,e.setState({groupOptions:l.data.data.list,groupOptionsMeta:Object.assign({},e.state.groupOptionsMeta,{total:l.data.data.total}),groupValue:n.groupName,filter:{grounpId:n.groupId}},function(){e.resetPagination(a,o)});case 7:case"end":return t.stop()}},t)}))}},"查看动态"),a.createElement("span",{className:"common-list-table-operation-spliter"}),a.createElement("span",{className:"common-list-table-operation-delete",onClick:function(){}},a.createElement(S.a,{title:"请问是否确认删除分群？",onConfirm:e.deleteGroup.bind(e,n)},"删除分群")))}}],n={hideSearcher:!0,batchControl:{placeholder:"请选择",showBatchControl:!k.a.isEmpty(e.state.selectedRowKeys),options:[{title:"删除分群",value:"normal"}],onBatch:function(t){e.onBatch(t)}},widgets:[]},o=Object.assign({},e.props.common.paginationConfig,{current:e.state.currentPage,total:e.props.feed.groupListMeta.total,onChange:function(e,t){},onShowSizeChange:function(t,n){e.resetPagination(n,t)}});return{addBtn:!1,searcher:n,table:{tableHeader:function(){return a.createElement("div",{className:"group-table-header"},a.createElement("h3",null,"分群管理"),a.createElement(w.a,{type:"primary",onClick:function(){e.toggleModal()}},"创建分群"))},rowKey:"commentId",columns:t,loading:e.state.tableLoading,dataSource:e.props.feed.groupList,pagination:o,onChange:function(t,n,r){var a={pageNum:t.current,limit:t.pageSize};if(!k.a.isEmpty(n))for(var o=0,i=Object.entries(n);o<i.length;o++){var l=Y(i[o],2),c=l[0],s=l[1];a[c]=s?s[0]:void 0}e.setState({filter:Object.assign({},e.state.filter,a),currentPage:t.current},function(){e.getDataList(e.state.filter)})}}}};function H(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function G(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}var B=function(e){var t={selectedRowKeys:e.state.selectedRowKeys,onChange:function(t,n){e.setState({selectedRowKeys:t})}},n=e.state.currentTab,r=[{title:"动态详情",render:function(t,r){return a.createElement("div",{className:"feed-table-detail"},a.createElement("ul",{className:"feed-table-detail-imgs"},!k.a.isEmpty(r.feedImg)&&r.feedImg.map(function(t,o){return a.createElement("li",{onClick:function(){r.video?e.setState({showVideoPlayer:!0,videoUrl:r.video}):(e.setState({activeIndex:o}),e.toggleFeedDetailModal(Object.assign({},r,{type:n}),!0))}},a.createElement("a",null,a.createElement("img",{src:t.imgUrl,alt:""})))})),a.createElement("p",{className:"feed-table-detail-content",dangerouslySetInnerHTML:{__html:r.memo}}),a.createElement("div",{className:"feed-table-detail-runlink"},1==r.isRun&&a.createElement("a",{href:"https://wap.thejoyrun.com/PoWeb.aspx?uid=".concat(r.uid,"&fid=").concat(r.fid),target:"_blank"},"跑步记录 >")),a.createElement("div",{className:"feed-table-detail-profile"},a.createElement("p",null,a.createElement("img",{src:r.faceurl,alt:""}),a.createElement("span",{className:"feed-table-detail-profile-name"},r.nick),a.createElement("span",{className:"feed-table-detail-profile-fans"},"（ID：",r.uid," · 粉丝 ",r.fansTotal,"）")),a.createElement("p",{className:"feed-table-detail-profile-site"},a.createElement("span",null,"发布于 "),a.createElement("strong",null,r.province,"·",r.city)),a.createElement("p",{className:"feed-table-detail-profile-time"},R()(1e3*r.dateline).format("YYYY.MM.DD HH:mm:ss"))),a.createElement("div",{className:"feed-table-detail-data feed-data-".concat(r.id)},a.createElement("p",null,"热度 ",a.createElement("strong",null,r.hot||"--")," |"),a.createElement("p",null," 点赞 ",a.createElement("strong",null,r.likeCount)," |"),a.createElement("p",null," 评论 ",a.createElement("strong",null,r.reCount)," |"),a.createElement("p",null," 视频播放 ",a.createElement("strong",null,r.pv))))}},{width:300,title:"操作",render:function(t,r){return a.createElement("div",{className:"feed-table-operation"},a.createElement("span",{className:"feed-table-operation-recommend ".concat("active"),onClick:e.toggleRecommendStatus.bind(e,r)},a.createElement(O.a,{active:0!==r.isRecommend,type:{0:"block",1:"hot"}[r.isRecommend],text:"荐"})),a.createElement("span",{onClick:e.toggleFeedDetailModal.bind(e,Object.assign({},r,{type:n}),!1),className:"feed-table-operation-view"},"查看"))}}],o={batchControl:{placeholder:"更多操作",showBatchControl:!k.a.isEmpty(e.state.selectedRowKeys),options:[{title:"推荐",value:"recommend"},{title:"取消推荐",value:"unrecommend"}],onBatch:function(t){e.onBatch(t)}},widgets:[{type:"Select",label:"所属分群",showSearch:!0,placeholder:"请输入分群名称",value:e.state.groupValue,option:{key:"groupId",value:"groupName",title:"groupName",data:e.state.groupOptions||[]},onFocus:function(){e.onGroupFocus()},onSearch:function(t){e.onGroupSearch(t)},onChange:function(t,n){e.onGroupSelect(t,n)},onSelect:function(e,t){},onBlur:function(){},onPopupScroll:function(t){e.onGroupPopupScroll(t)}},{type:"SelectInput",label:"用户",placeholder:"请输入用户 ID 或昵称",options:[{title:"用户 ID",value:"uid"},{title:"用户昵称",value:"nick"}],inputValue:e.state.userValue,selectValue:e.state.userField,onSelectChange:function(t){e.setUserField(t)},onInputChange:function(t){e.setUserValue(t.target.value)}},{type:"RangePicker",label:"起止日期",placeholder:["开始日期","结束日期"],showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",alias:[1,7,30],value:e.state.dateRange||[],onChange:function(t){e.onDateRangeChange(t)}},{type:"Label",label:"其他选项",className:"other-opts",children:[{type:"Select",label:"排序",showSearch:!1,placeholder:"请选择排序选项",style:{marginLeft:30},value:e.state.sortValue,option:{key:"id",value:"id",title:"title",data:[{id:"1",title:"按发布时间"},{id:"0",title:"按赞数"}]},onSelect:function(t,n){e.onSortSelect(t,n)},onBlur:function(){}},{type:"Label",label:"筛选",className:"other-opts",children:[[{type:"Select",label:"",showSearch:!1,placeholder:"视频",value:e.state.isVideo,option:{key:"id",value:"id",title:"title",data:[{id:void 0,title:"全部"},{id:"1",title:"视频动态"}]},onSelect:function(t,n){e.onFilterSelect("isVideo",t,n)},onBlur:function(){}},{type:"Select",showSearch:!1,placeholder:"图片",value:e.state.isImg,option:{key:"id",value:"id",title:"title",data:[{id:void 0,title:"全部"},{id:"0",title:"无图"},{id:"1",title:"单图"},{id:"2",title:"多图"}]},onSelect:function(t,n){e.onFilterSelect("isImg",t,n)},onBlur:function(){}},{type:"Select",showSearch:!1,placeholder:"话题",value:e.state.memoNum,option:{key:"id",value:"id",title:"title",data:[{id:void 0,title:"全部"},{id:"0",title:"仅话题"}]},onSelect:function(t,n){e.onFilterSelect("memoNum",t,n)},onBlur:function(){}}]]}]}],onSearch:function(){e.onSearch()},onReset:function(){e.onReset()}};"all"===e.state.currentTab&&(o.batchControl.options=[{title:"推荐",value:"recommend"}].concat(G(o.batchControl.options)));var i=Object.assign({},e.props.common.paginationConfig,{current:e.state.currentPage,total:e.props.feed.feedList[0]&&e.props.feed.feedList[0].total||10,showTotal:!1,onChange:function(e,t){},onShowSizeChange:function(t,n){e.resetPagination(n,t)}}),l={rowKey:"fid",rowSelection:t,columns:r,dataSource:e.props.feed.feedList,loading:e.state.tableLoading,pagination:i,onChange:function(t,n,r){var a={pageNum:t.current,limit:t.pageSize};if(!k.a.isEmpty(n))for(var o=0,i=Object.entries(n);o<i.length;o++){var l=H(i[o],2),c=l[0],s=l[1];a[c]=s?s[0]:void 0}k.a.isEmpty(r)||(a.orderBy="".concat(r.field),a.sort="".concat("descend"===r.order?"desc":"asc")),e.setState({filter:Object.assign({},e.state.filter,a),currentPage:t.current},function(){e.getDataList(e.state.filter)})}};return e.state.groupValue||(l.locale={emptyText:"请选择所属分组"}),{addBtn:{title:function(){return a.createElement(w.a,{style:{visibility:"hidden"},type:"primary",onClick:function(){return e.goToEditor({})}},a.createElement(m.a,{type:"plus"})," 添加")},style:{marginTop:-90}},searcher:o,table:l}},K=n(1423),W=n(1432),U=n(585),A=n.n(U),z=n(147),q=n.n(z),Z=n(1382),J=n.n(Z),X=n(1393),Q=n(1371),ee=n.n(Q);function te(e){var t=e.recommendStartTime,n=e.recommendDateRange,r=e.onRecommendDateChange;return a.createElement("div",null,a.createElement("div",null,a.createElement("span",null,"推荐时间："),a.createElement(ee.a,{style:{width:200},defaultValue:t,format:"YYYY-MM-DD HH:mm:ss",disabled:!0}),"  ",a.createElement(ee.a,{style:{width:200},onChange:function(e){r(e.startOf("day"))},format:"YYYY-MM-DD HH:mm:ss",value:n})),a.createElement("div",{style:{marginTop:10}},a.createElement("span",null,"时间选择："),a.createElement("span",{className:"common-list-control-date-alias"},[1,3,5,7].map(function(e,t){return a.createElement(a.Fragment,null,"  ",a.createElement(w.a,{key:t,onClick:function(){return r(R()().add(e,"days").startOf("day"))}},e," 天"))}),[1,2,3].map(function(e,t){return a.createElement(a.Fragment,null,"  ",a.createElement(w.a,{key:t,onClick:function(){return r(R()().add(e,"months").startOf("day"))}},e," 个月"))}),a.createElement(a.Fragment,null,"  ",a.createElement(w.a,{onClick:function(){return r(R()().add(10,"years").startOf("day"))}},"长期")))),a.createElement("span",{className:"common-list-control"},"  "))}function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function oe(e){return(oe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ie(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ce=null,se=null,ue=M.a.Item,me=l.a.confirm,de=[{id:"group",title:"分群管理",path:"/admin/community/tool/feed/group-list#group"},{id:"feed",title:"分群动态",path:"/admin/community/tool/feed/group-list#feed"}],fe=function(e){function t(e){var n,o,i;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),o=this,i=oe(t).call(this,e),(n=!i||"object"!==ne(i)&&"function"!=typeof i?ie(o):i).state={currentTab:"group",filter:{limit:20,pageNum:1},currentFeed:null,groupOptions:[],groupOptionsMeta:{total:0,pageNum:1,limit:20},recommendDateRange:null,groupValue:void 0,selectedRowKeys:[],userField:"uid",videoUrl:"",showVideoPlayer:!1,isSameGroupName:!1,userValue:void 0,isVideo:void 0,isImg:void 0,memoNum:void 0,dateRange:[],sortValue:void 0,filterValue:void 0,tableLoading:!1,visible:!1,groupName:void 0,groupFile:null,showModal:!1,onlyCarousel:!1,activeIndex:0},n.toggleFeedDetailModal=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];setTimeout(function(){n.setState({currentFeed:e,onlyCarousel:t,showModal:!n.state.showModal}),n.state.showModal||n.setState({activeIndex:0})},300)},n.toggleRecommendStatus=function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.isRecommend?this.cancelOperation(e.fid):this.doOperation(e.fid);case 1:case"end":return t.stop()}},t,this)}))},n.onRecommendDateChange=function(e){n.setState({recommendDateRange:e},function(){ce.update({content:a.createElement(te,{recommendStartTime:se,recommendDateRange:n.state.recommendDateRange,onRecommendDateChange:n.onRecommendDateChange})})})},n.doOperation=function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:se||(se=R()()),ce=me({icon:"",width:820,title:"推荐时间",okText:"推荐",cancelText:"取消",content:a.createElement(te,{recommendStartTime:se,recommendDateRange:this.state.recommendDateRange,onRecommendDateChange:this.onRecommendDateChange}),onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.state.recommendDateRange,!k.a.isEmpty(n)){t.next=4;break}return this.$msg.warning("请输入推荐时间"),t.abrupt("return",Promise.reject());case 4:return t.next=6,this.$api.feed.recommendFeeds({params:{fids:e,recommendStartTime:se.format("YYYY-MM-DD HH:mm:ss"),recommendEndTime:n.format("YYYY-MM-DD HH:mm:ss")}});case 6:0==(r=t.sent).data.ret?(this.getDataList(this.state.filter),this.setState({showModal:!1,recommendDateRange:null}),se=null):this.$msg.error(r.data.msg);case 8:case"end":return t.stop()}},t,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({recommendDateRange:null}),se=null;case 2:case"end":return e.stop()}},e,this)}))}});case 2:case"end":return t.stop()}},t,this)}))},n.cancelOperation=function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:me({title:"动态取消推荐操作",content:a.createElement("span",null,"请问是否取消推荐当前选中的动态"),onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$api.feed.unrecommendFeeds({params:{fids:e}});case 2:0==(n=t.sent).data.ret?(this.getDataList(this.state.filter),this.setState({showModal:!1})):this.$msg.error(n.data.msg);case 4:case"end":return t.stop()}},t,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}});case 1:case"end":return t.stop()}},t)}))},n.onTabClick=function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n,r=this;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:"feed"===e.id?(this.props.history.push(e.path),this.getDataList(this.state.filter)):(delete(n=this.state.filter).grounpId,this.setState({currentTab:e.id,groupValue:void 0,filter:Object.assign({},n)},function(){r.props.history.push(e.path),r.getDataList(r.state.filter)}));case 1:case"end":return t.stop()}},t,this)}))},n.deleteGroup=function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$api.feed.deleteGroup({params:{grounpId:e.groupId}});case 2:0==(n=t.sent).data.ret?(this.$msg.success("分群删除成功"),this.getDataList(this.state.filter)):this.$msg.error(n.data.msg);case 4:case"end":return t.stop()}},t,this)}))},n.onGroupFocus=function(){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.feed.getGroupList({params:{limit:20,pageNum:1}});case 2:t=e.sent,this.setState({groupOptions:t.data.data.list,groupOptionsMeta:{total:t.data.data.total,limit:t.data.data.limit,pageNum:t.data.data.pageNum}});case 4:case"end":return e.stop()}},e,this)}))},n.onGroupSearch=q()(function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.$api.feed.getGroupList({params:{groupName:e,pageNum:1,limit:20}});case 2:n=t.sent,this.setState({groupOptions:n.data.data.list,groupOptionsMeta:{total:n.data.data.total,limit:n.data.data.limit,pageNum:n.data.data.pageNum}});case 4:case"end":return t.stop()}},t,this)}))},500),n.onGroupSelect=function(e,t){var r=k.a.isEmpty(t.props.$data)?void 0:t.props.$data.groupId;n.setState({groupValue:e,filter:Object.assign({},n.state.filter,{grounpId:r})},function(){n.getDataList(n.state.filter)})},n.onGroupPopupScroll=A()(function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n,r,a,o,i;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.state,r=n.groupOptions,a=n.groupOptionsMeta,o=n.groupValue,!(!(!e||!e.target)&&e.target.scrollHeight-(e.target.scrollTop+e.target.clientHeight)<=10&&a.total>r.length)){t.next=7;break}return t.next=5,this.$api.feed.getGroupList({params:{groupName:o,pageNum:a.pageNum+1,limit:a.limit}});case 5:i=t.sent,this.setState({groupOptions:J()(this.state.groupOptions,i.data.data.list,"groupId"),groupOptionsMeta:{total:i.data.data.total,pageNum:i.data.data.pageNum,limit:i.data.data.limit}});case 7:case"end":return t.stop()}},t,this)}))},300),n.resetPagination=function(e,t){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function n(){var a=this;return regeneratorRuntime.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:this.setState({filter:Object.assign({},this.state.filter,{limit:e,pageNum:t})},function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.filter,this.getDataList(t);case 2:case"end":return e.stop()}},e,this)}))});case 1:case"end":return n.stop()}},n,this)}))},n.getDataList=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=Object.assign({},n.state.filter,e);n.setState({filter:t,tableLoading:!0},function(){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,n=t.currentTab,r=t.filter,"group"!==n){e.next=6;break}return e.next=4,this.$store.feed.getGroupList({params:Object.assign({},r)});case 4:e.next=8;break;case 6:return e.next=8,this.$store.feed.getFeedList({params:r},n);case 8:this.setState({tableLoading:!1});case 9:case"end":return e.stop()}},e,this)}))})},n.onGroupNameChange=function(e){var t=e.target.value?e.target.value.trim():"";n.setState({groupName:t}),n.checkGroupName(e.target.value)},n.checkGroupName=function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n={groupName:e},t.next=3,this.$api.feed.checkGroupName({params:n});case 3:r=t.sent,this.setState({isSameGroupName:1!==r.data.data}),0==r.data.data&&e&&this.$msg.warn("".concat(e," 分群名称已存在"));case 6:case"end":return t.stop()}},t,this)}))},n.renderGroupComponent=function(){return"group"===n.state.currentTab?a.createElement(v.a,Object.assign({},n.props,{config:$(ie(n))})):a.createElement(v.a,Object.assign({},n.props,{config:B(ie(n))}))},n.renderModal=function(){var e=n.state.groupFile;return a.createElement(l.a,{title:"创建分群",visible:n.state.visible,onOk:n.onModalOk,onCancel:n.onModalCancel},a.createElement(M.a,null,a.createElement(ue,{required:!0,label:"分群名称"},a.createElement(F.a,{value:n.state.groupName,onChange:n.onGroupNameChange})),a.createElement(ue,{required:!0,label:"上传文件"},a.createElement(V.a,{style:{width:104,height:104},className:"logo-square",accept:"text/csv",fileList:e,beforeUpload:function(e){return e.name.indexOf("csv")<0?(n.$msg.warn("请上传 CSV 格式文件"),!1):!(e.size/1024/1024>2)||(n.$msg.warn("上传文件不得超过 2M"),!1)},customRequest:function(e){n.setState({groupFile:[e.file]})},onRemove:function(e){n.setState({groupFile:null})}},a.createElement(w.a,null,a.createElement(m.a,{type:"upload"})," 点击上传")),a.createElement("span",null,a.createElement("span",{style:{marginRight:8}},"支持扩展名：.csv"),a.createElement("a",{href:"https://joyrun-web-cdn.thejoyrun.com/neo/file/feed-template.csv",download:"分群动态模板.csv",style:{color:"#1890ff"}},"[下载模板]")))))},n.onSearch=function(){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.filter).uid||!Number.isNaN(Number(t.uid))){e.next=3;break}return e.abrupt("return",this.$msg.error("请输入正确用户 ID"));case 3:this.setState({filter:Object.assign({},t,{pageNum:1}),currentPage:1},function(){n.getDataList(n.state.filter)});case 4:case"end":return e.stop()}},e,this)}))},n.onReset=function(){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={pageNum:1,limit:this.state.filter.limit},n=this.props.location.pathname+this.props.location.hash,this.props.history.replace(n),this.setState({userValue:void 0,dateRange:[],sortValue:void 0,filterValue:void 0,groupValue:void 0,filter:t,currentPage:1,isVideo:void 0,isImg:void 0,memoNum:void 0},function(){r.getDataList(r.state.filter)});case 4:case"end":return e.stop()}},e,this)}))},n.onBatch=function(e){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function t(){var n;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.state.selectedRowKeys,!e||!k.a.isEmpty(n)){t.next=3;break}return t.abrupt("return",this.$msg.warning("请选择至少一条记录"));case 3:if("recommend"!==e){t.next=8;break}return t.next=6,this.doOperation(n.join(","));case 6:t.next=11;break;case 8:if("unrecommend"!==e){t.next=11;break}return t.next=11,this.cancelOperation(n.join(","));case 11:this.setState({selectedRowKeys:[]});case 12:case"end":return t.stop()}},t,this)}))},n.setUserField=function(e){var t,r=n.state.filter;"uid"!==e?(t=r.uid,delete r.uid):"nick"!==e&&(t=r.nick,delete r.nick),n.setState({userField:e,filter:Object.assign({},r,re({},e,t))})},n.setUserValue=function(e){n.setState({userValue:e,filter:Object.assign({},n.state.filter,re({},n.state.userField,e||void 0))})},n.onDateRangeChange=function(e){var t=Object.assign({},n.state.filter);k.a.isEmpty(e)?(t.startTime=void 0,t.endTime=void 0):(t.startTime=e[0].unix(),t.endTime=e[1].unix()),n.setState({dateRange:e,filter:t})},n.onSortSelect=function(e,t){n.setState({sortValue:e,filter:Object.assign({},n.state.filter,{isLikeCount:e})})},n.onFilterSelect=function(e,t,r){var a;n.setState((re(a={},e,t),re(a,"filter",Object.assign({},n.state.filter,re({},e,t||void 0))),a))},n.changeGalleryIndex=function(e){n.setState({activeIndex:e})},n.onModalOk=function(){return r.a(ie(n),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,n=t.groupName,r=t.groupFile,a=this.props.common.userInfo,o={groupName:n,files:k.a.isEmpty(r)?null:r[0],createUser:a.empId,updateUser:a.empId},!(i=this.getValidation(o))){e.next=6;break}return e.abrupt("return",this.$msg.warn(i));case 6:return l=k.a.getFormData(o),e.next=9,this.$api.feed.createGroup(l);case 9:if(0!=e.sent.data.ret){e.next=17;break}return this.$msg.success("".concat(n," 分群创建成功")),this.getDataList(this.state.filter),this.onModalCancel(),e.abrupt("return",!1);case 17:return e.abrupt("return",this.$msg.error("".concat(n," 分群创建失败")));case 18:case"end":return e.stop()}},e,this)}))},n.onModalCancel=function(){n.setState({groupFile:null,groupName:void 0},function(){n.toggleModal()})},n.toggleModal=function(){n.setState({visible:!n.state.visible})},n.getValidation=function(e){var t=new K.a;t.add(e.groupName,[{strategy:"isNonEmpty",errMsg:"请输入分群名称"},{strategy:"maxLength:20",errMsg:"分群名称不得超过 20 个字"}]),t.add(e.files,[{strategy:"isNonEmpty",errMsg:"请上传文件"}]);var r=t.start();return n.state.isSameGroupName&&(r="".concat(n.state.groupName," 分群名称已存在")),r},n.onVideoPlayerClose=function(){n.setState({showVideoPlayer:!1,videoUrl:""})},n.checkGroupName=q()(n.checkGroupName,800),n}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,o["a"]),n=t,c=[{key:"getDerivedStateFromProps",value:function(e,t){return{currentTab:e.location.hash.slice(1)}}}],(i=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,l,c,s,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.common.paginationConfig,n=t.defaultPageSize,r=t.defaultCurrent,a=this.props.location,o=a.hash,!(i=this.$qs.parse(a.search)).groupId||"#feed"!==o){e.next=11;break}return e.next=7,this.$api.feed.getGroupList({params:{pageNum:1,limit:20}});case 7:l=e.sent,this.setState({groupOptions:l.data.data.list,groupOptionsMeta:Object.assign({},this.state.groupOptionsMeta,{total:l.data.data.total,pageNum:l.data.data.pageNum,limit:l.data.data.limit}),groupValue:i.groupName,filter:{grounpId:i.groupId}},function(){u.resetPagination(n,r)}),e.next=20;break;case 11:if(i.groupId||"#feed"!==o){e.next=19;break}return e.next=14,this.$api.feed.getGroupList({params:{pageNum:1,limit:20}});case 14:c=e.sent,s=c.data.data.list,this.setState({groupOptions:s,groupOptionsMeta:Object.assign({},this.state.groupOptionsMeta,{total:c.data.data.total,limit:c.data.data.limit,pageNum:c.data.data.pageNum}),groupValue:k.a.isEmpty(s)?"":s[0].groupName,filter:{grounpId:k.a.isEmpty(s)?void 0:s[0].groupId}},function(){u.resetPagination(n,r)}),e.next=20;break;case 19:this.resetPagination(n,r);case 20:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){var e=this,t=this.state,n=t.currentTab,r=t.currentFeed,o=t.showModal,i=t.onlyCarousel,c=t.activeIndex,s=t.videoUrl;return a.createElement("div",{className:"group-list"},a.createElement("section",{style:{marginLeft:24}},a.createElement(P.a,null,de.map(function(t){return a.createElement(P.a.Item,null,a.createElement("a",{onClick:e.onTabClick.bind(e,t),style:n===t.id?{color:"#1890ff"}:{}},t.title))}))),a.createElement("section",null,this.renderGroupComponent()),a.createElement("section",null,this.renderModal()),a.createElement("section",null,a.createElement("section",{className:"feed-modal"},a.createElement(W.a,Object.assign({title:i?"查看图片":"",visible:o},r,{onlyCarousel:i,onOk:this.toggleRecommendStatus.bind(this,r),onCancel:this.toggleFeedDetailModal.bind(this,null),activeGalleryIndex:c,changeGalleryIndex:this.changeGalleryIndex})))),a.createElement("section",null,a.createElement(l.a,{title:"播放视频",width:800,maskClosable:!0,onCancel:this.onVideoPlayerClose,visible:this.state.showVideoPlayer,footer:null},s&&a.createElement(X.Player,null,a.createElement("source",{src:s})))))}}])&&ae(n.prototype,i),c&&ae(n,c),t}(),pe=fe=r.b([Object(h.b)("common","feed"),h.c,M.a.create()],fe);n(1443);function he(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,l=e[Symbol.iterator]();!(r=(i=l.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var ge=function(e){var t={selectedRowKeys:e.state.selectedRowKeys,onChange:function(t,n){e.setState({selectedRowKeys:t})}},n=e.state.currentTab,r=[{title:"动态详情",width:800,render:function(t,r){var o=k.a.parseEmoji(r.memo);return a.createElement("div",{className:"feed-table-detail"},a.createElement("ul",{className:"feed-table-detail-imgs"},!k.a.isEmpty(r.feedImg)&&r.feedImg.map(function(t,o){return a.createElement("li",{onClick:function(){r.video?e.setState({showVideoPlayer:!0,videoUrl:r.video}):(e.setState({activeIndex:o}),e.toggleFeedDetailModal(Object.assign({},r,{type:n}),!0))}},a.createElement("a",null,a.createElement("img",{src:t.imgUrl,alt:""})))})),r.memo&&r.memo.length>200?a.createElement(N.a,{width:600},a.createElement("p",{className:"feed-table-detail-content",dangerouslySetInnerHTML:{__html:o}})):a.createElement("p",{className:"shoe-list-table-detail-content",dangerouslySetInnerHTML:{__html:o}}))}},{title:"关键词",dataIndex:"keyword"},{title:"操作",render:function(t,n){return a.createElement("div",{className:"common-list-table-operation"},a.createElement("span",{className:"feed-table-operation-recommend ".concat("active"),onClick:e.toggleRecommendStatus.bind(e,n)},a.createElement(O.a,{active:0!==n.isRecommend,type:{0:"block",1:"hot"}[n.isRecommend],text:"荐"})),a.createElement("span",{className:"common-list-table-operation-spliter"}),a.createElement("span",{onClick:function(){}},"删除"))}}],o={batchControl:{placeholder:"更多操作",showBatchControl:!k.a.isEmpty(e.state.selectedRowKeys),options:[{title:"通过",value:"pass"},{title:"屏蔽",value:"block"},{title:"删除",value:"delete"}],onBatch:function(t){e.onBatch(t)}},widgets:[{type:"CheckableTag",label:"来源",value:e.state.checkedTag,option:[{title:"小红书",value:"1"},{title:"今日头条",value:"2"},{title:"美图秀秀",value:"3"}],onChange:function(t){e.setState({checkedTag:t.value,filter:Object.assign({},e.state.filter,{source:t.value})})}},{type:"Input",label:"搜索",placeholder:"请输入关键词",value:e.state.keyword||void 0,onChange:function(t){e.onKeywordChange(t.target.value)}},{type:"RangePicker",label:"时间",placeholder:["开始日期","结束日期"],showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",alias:[1,7,30],value:e.state.dateRange||[],onChange:function(t){e.onDateRangeChange(t)}},{type:"Label",label:"其他选项",className:"other-opts",children:[{type:"Select",label:"排序",showSearch:!1,placeholder:"请选择排序选项",style:{marginLeft:30},value:e.state.sortValue,option:{key:"id",value:"id",title:"title",data:[{id:void 0,title:"全部"},{id:"time",title:"按爬取时间从新到旧"},{id:"word",title:"按字数从多到少"}]},onSelect:function(t,n){e.onSortSelect(t,n)},onBlur:function(){}}]}],onSearch:function(){e.onSearch()},onReset:function(){e.onReset()}},i=Object.assign({},e.props.common.paginationConfig,{current:e.state.currentPage,total:e.props.community.crawlerList[0]&&e.props.community.crawlerList[0].total||10,showTotal:!1,onChange:function(e,t){},onShowSizeChange:function(t,n){e.resetPagination(n,t)}});return{addBtn:{title:function(){return a.createElement(w.a,{style:{visibility:"hidden"},type:"primary",onClick:function(){}},a.createElement(m.a,{type:"plus"}),"创建")}},searcher:o,table:{rowKey:"fid",rowSelection:t,columns:r,dataSource:e.props.community.crawlerList,loading:e.state.tableLoading,pagination:i,onChange:function(t,n,r){var a={pageNum:t.current,limit:t.pageSize};if(!k.a.isEmpty(n))for(var o=0,i=Object.entries(n);o<i.length;o++){var l=he(i[o],2),c=l[0],s=l[1];a[c]=s?s[0]:void 0}k.a.isEmpty(r)||(a.orderBy="".concat(r.field),a.sort="".concat("descend"===r.order?"desc":"asc")),e.setState({filter:Object.assign({},e.state.filter,a),currentPage:t.current},function(){e.getDataList(e.state.filter)})}}}};function ve(e){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ye(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function be(e){return(be=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function we(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function Ee(e,t){return(Ee=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Se=l.a.confirm,ke=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=be(t).apply(this,arguments),(e=!o||"object"!==ve(o)&&"function"!=typeof o?we(n):o).state={tableLoading:!1,modalVisible:!1,currentPage:1,checkedTag:"1",filter:{},selectedRowKeys:[],sortValue:void 0,keyword:void 0,showModal:!1,currentFeed:null,onlyCarousel:!1,activeIndex:0,videoUrl:"",showVideoPlayer:!1},e.resetPagination=function(t,n){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return");case 2:case"end":return e.stop()}},e,this)}))},e.getDataList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},e.state.filter,t);e.setState({filter:n,tableLoading:!0},function(){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.community.getCrawlerList({params:n});case 2:this.setState({tableLoading:!1});case 3:case"end":return e.stop()}},e,this)}))})},e.toggleRecommendStatus=function(t){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.fid||t.id,t.isRecommend?this.cancelOperation(n):this.doOperation(n);case 2:case"end":return e.stop()}},e,this)}))},e.onKeywordChange=function(t){e.setState({keyword:t,filter:Object.assign({},e.state.filter,{keyword:t||void 0})})},e.onSortSelect=function(t,n){e.setState({sortValue:t,filter:Object.assign({},e.state.filter,{sort:t||void 0})})},e.onDateRangeChange=function(t){var n=Object.assign({},e.state.filter);k.a.isEmpty(t)||(n.createTimeStart=t[0].format("YYYY-MM-DD HH:mm:ss"),n.createTimeEnd=t[1].format("YYYY-MM-DD HH:mm:ss")),e.setState({dateRange:t,filter:n})},e.onSearch=function(){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.filter,this.setState({filter:Object.assign({},t,{pageNum:1}),currentPage:1},function(){n.getDataList(n.state.filter)});case 2:case"end":return e.stop()}},e,this)}))},e.onReset=function(){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={pageNum:1,pageSize:this.state.filter.pageSize,source:"1"},this.setState({dateRange:[],filter:t,currentPage:1,checkedTag:"1",sortValue:void 0},function(){n.getDataList(n.state.filter)});case 2:case"end":return e.stop()}},e,this)}))},e.onBatch=function(t){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state.selectedRowKeys,!t||!k.a.isEmpty(n)){e.next=3;break}return e.abrupt("return",this.$msg.warning("请选择至少一条记录"));case 3:case 4:case"end":return e.stop()}},e,this)}))},e.toggleFeedDetailModal=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];setTimeout(function(){e.setState({currentFeed:t,onlyCarousel:n,showModal:!e.state.showModal}),e.state.showModal||e.setState({activeIndex:0})},300)},e.changeGalleryIndex=function(t){e.setState({activeIndex:t})},e.onVideoPlayerClose=function(){e.setState({showVideoPlayer:!1,videoUrl:""})},e.doOperation=function(t){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:recomendConfirm=Se({width:800,title:"推荐时间",okText:"推荐",cancelText:"取消",content:"",onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.props.community.currentCrawler,e.next=3,this.$api.feed.recommendFeeds({params:{fids:t}});case 3:0==(n=e.sent).data.ret?(this.getDataList(this.state.filter),this.props.community.setCurrentCrawler({})):this.$msg.error(n.data.msg);case 5:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.community.setCurrentCrawler({});case 1:case"end":return e.stop()}},e,this)}))}});case 1:case"end":return e.stop()}},e)}))},e.cancelOperation=function(t){return r.a(we(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({showPopconfirmId:0}),Se({title:"动态取消推荐操作",content:a.createElement("span",null,"请问是否取消推荐当前选中的动态"),onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.feed.unrecommendFeeds({params:{fids:t}});case 2:0==(n=e.sent).data.ret?(this.getDataList(this.state.filter),this.setState({showModal:!1,selectedRowKeys:[],selectedTopicKeys:[]})):this.$msg.error(n.data.msg);case 4:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}});case 2:case"end":return e.stop()}},e,this)}))},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&Ee(e,t)}(t,o["a"]),n=t,(i=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.common.paginationConfig,n=t.defaultPageSize,r=t.defaultCurrent,this.resetPagination(n,r);case 2:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){var e=this.state,t=(e.modalVisible,e.currentFeed),n=e.showModal,r=e.onlyCarousel,o=e.activeIndex;return a.createElement("div",{className:"crawler-list"},a.createElement(v.a,Object.assign({},this.props,{config:ge(this)})),a.createElement("section",{className:"feed-modal"},a.createElement(W.a,Object.assign({title:r?"查看图片":"",visible:n},t,{onlyCarousel:r,okText:"确认",cancelText:"返回",onOk:this.toggleFeedDetailModal.bind(this,null),onCancel:this.toggleFeedDetailModal.bind(this,null),activeGalleryIndex:o,changeGalleryIndex:this.changeGalleryIndex}))),a.createElement("section",null,a.createElement(l.a,{width:800,title:"播放视频",maskClosable:!0,onCancel:this.onVideoPlayerClose,visible:this.state.showVideoPlayer,footer:null},this.state.videoUrl&&a.createElement(X.Player,null,a.createElement("source",{src:this.state.videoUrl})))))}}])&&ye(n.prototype,i),c&&ye(n,c),t}(),Ce=ke=r.b([Object(h.b)("common","community"),h.c],ke);n(1444);function Re(e){return(Re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function Oe(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function xe(e){return(xe=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Te(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function je(e,t){return(je=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Ie=l.a.confirm,Pe=null,De=null,Me=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=xe(t).apply(this,arguments),(e=!o||"object"!==Re(o)&&"function"!=typeof o?Te(n):o).state={currentTab:"all",filter:{},selectedRowKeys:[],selectedTopicKeys:[],userField:"userId",userValue:void 0,dateRange:[],recommendDateRange:null,weight:null,sortValue:void 0,filterValue:void 0,topicName:void 0,videoUrl:"",showVideoPlayer:!1,isVideo:void 0,isImg:void 0,memoNum:void 0,showPopconfirmId:0,badgeChecked:0,runChecked:0,currentFeed:null,showModal:!1,onlyCarousel:!1,activeIndex:0,visible:!1,tableLoading:!1,currentPage:1},e.getDataList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},e.state.filter,t);e.setState({filter:n,tableLoading:!0},function(){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.state,n=t.currentTab,r=t.filter,"all"!==n&&"recommend"!==n&&"topic"!==n){e.next=5;break}return e.next=4,this.$store.feed.getFeedList({params:r},n);case 4:this.setState({tableLoading:!1});case 5:case"end":return e.stop()}},e,this)}))})},e.toggleFeedDetailModal=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];setTimeout(function(){e.setState({currentFeed:t,onlyCarousel:n,showModal:!e.state.showModal}),e.state.showModal||e.setState({activeIndex:0})},300)},e.renderWeightElem=function(t){return a.createElement("div",{key:t},a.createElement("span",null,"权重  "),a.createElement(s.a,{min:0,onChange:e.changeWeight.bind(Te(e),t)}))},e.onRecommendDateChange=function(t){e.setState({recommendDateRange:t},function(){Pe.update({content:a.createElement(te,{recommendStartTime:De,recommendDateRange:e.state.recommendDateRange,onRecommendDateChange:e.onRecommendDateChange})})})},e.doOperation=function(t){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({showPopconfirmId:0}),De||(De=R()()),Pe=Ie({icon:"",width:820,title:"推荐时间",okText:"推荐",cancelText:"取消",content:a.createElement(te,{recommendStartTime:De,recommendDateRange:this.state.recommendDateRange,onRecommendDateChange:this.onRecommendDateChange}),onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state.recommendDateRange,!k.a.isEmpty(n)){e.next=4;break}return this.$msg.warning("请输入推荐时间"),e.abrupt("return",Promise.reject());case 4:return e.next=6,this.$api.feed.recommendFeeds({params:{fids:t,recommendStartTime:De.format("YYYY-MM-DD HH:mm:ss"),recommendEndTime:n.format("YYYY-MM-DD HH:mm:ss")}});case 6:0==(r=e.sent).data.ret?(this.getDataList(this.state.filter),this.setState({showModal:!1,selectedRowKeys:[],selectedTopicKeys:[],recommendDateRange:null}),De=null):this.$msg.error(r.data.msg);case 8:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({recommendDateRange:null}),De=null;case 2:case"end":return e.stop()}},e,this)}))}});case 3:case"end":return e.stop()}},e,this)}))},e.cancelOperation=function(t){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({showPopconfirmId:0}),Ie({title:"动态取消推荐操作",content:a.createElement("span",null,"请问是否取消推荐当前选中的动态"),onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.feed.unrecommendFeeds({params:{fids:t}});case 2:0==(n=e.sent).data.ret?(this.getDataList(this.state.filter),this.setState({showModal:!1,selectedRowKeys:[],selectedTopicKeys:[]})):this.$msg.error(n.data.msg);case 4:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}});case 2:case"end":return e.stop()}},e,this)}))},e.changeWeight=function(t,n){return n&&Number.isNaN(Number(n))?e.$msg.error("请输入正确权重值"):n&&n.toString().length>5?e.$msg.error("权重值不得超过 5 位"):void e.setState({weight:{key:t,value:n}})},e.confirmWeight=function(t){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.weight,e.next=3,this.$api.feed.updateWeight({params:{fid:t.key,weight:t.value}});case 3:0==(n=e.sent).data.ret?(this.$msg.success("修改权重成功"),this.getDataList(this.state.filter),this.cancelWeight()):this.$msg.error(n.data.msg);case 5:case"end":return e.stop()}},e,this)}))},e.cancelWeight=function(){e.setState({showPopconfirmId:0,weight:void 0})},e.toggleRecommendStatus=function(t){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=t.fid||t.id,t.isRecommend?this.cancelOperation(n):this.doOperation(n);case 2:case"end":return e.stop()}},e,this)}))},e.resetPagination=function(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({filter:Object.assign({},this.state.filter,{limit:t,pageNum:n,lastFid:a})},function(){return r.a(o,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.filter,this.getDataList(t);case 2:case"end":return e.stop()}},e,this)}))});case 1:case"end":return e.stop()}},e,this)}))},e.onSearch=function(){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.filter).userId||!Number.isNaN(Number(t.userId))){e.next=3;break}return e.abrupt("return",this.$msg.error("请输入正确用户 ID"));case 3:delete t.lastFid,this.setState({filter:Object.assign({},t,{pageNum:1}),currentPage:1,showPopconfirmId:0},function(){n.getDataList(n.state.filter)});case 5:case"end":return e.stop()}},e,this)}))},e.onReset=function(){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={pageNum:1,limit:this.state.filter.limit},this.setState({userValue:void 0,dateRange:[],selectedRowKeys:[],selectedTopicKeys:[],sortValue:void 0,isWeight:void 0,filterValue:void 0,topicName:void 0,badgeChecked:0,runChecked:0,isVideo:void 0,isImg:void 0,memoNum:void 0,filter:t,currentPage:1,showPopconfirmId:0},function(){n.getDataList(n.state.filter)});case 2:case"end":return e.stop()}},e,this)}))},e.onBatch=function(t){return r.a(Te(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,r=n.selectedRowKeys,a=n.selectedTopicKeys,o=[],o="topic"===this.state.currentTab?a:r,!t||!k.a.isEmpty(o)){e.next=5;break}return e.abrupt("return",this.$msg.warning("请选择至少一条记录"));case 5:if("recommend"!==t){e.next=10;break}return e.next=8,this.doOperation(o.join(","));case 8:e.next=13;break;case 10:if("unrecommend"!==t){e.next=13;break}return e.next=13,this.cancelOperation(o.join(","));case 13:case"end":return e.stop()}},e,this)}))},e.onTabClick=function(t){e.setState({currentTab:t},function(){if(e.onReset(),"group-list"===t){e.props.history.push("/admin/community/tool/feed/group-list#group")}else if("crawler-list"===t){e.props.history.push("/admin/community/tool/feed/crawler-list")}else{var n="/admin/community/tool/feed/list?type=".concat(t);e.props.history.push(n)}})},e.setUserField=function(t){var n,r=e.state.filter;"userId"!==t?(n=r.userId,delete r.userId):"nick"!==t&&(n=r.nick,delete r.nick),e.setState({userField:t,filter:Object.assign({},r,Oe({},t,n))})},e.setUserValue=function(t){e.setState({userValue:t,filter:Object.assign({},e.state.filter,Oe({},e.state.userField,t||void 0))})},e.onDateRangeChange=function(t){var n=Object.assign({},e.state.filter);k.a.isEmpty(t)?(n.startTime=void 0,n.endTime=void 0):(n.startTime=t[0].unix(),n.endTime=t[1].unix()),e.setState({dateRange:t,filter:n})},e.onSortSelect=function(t,n){var r=e.state.filter,a=n.props.$data.field,o="";"topic"===e.state.currentTab?o=n.props.$data.id:"isLikeCount"===a?(delete r.isWeight,o=t):"isWeight"===a?(delete r.isLikeCount,o="1"):"isHot"===a&&(delete r.isLikeCount,delete r.isWeight,o="1"),e.setState({sortValue:t,filter:Object.assign({},r,Oe({},a,o))})},e.onFilterSelect=function(t,n,r){var a;e.setState((Oe(a={},t,n),Oe(a,"filter",Object.assign({},e.state.filter,Oe({},t,n||void 0))),a))},e.onBadgeChange=function(t){e.setState({badgeChecked:t,filter:Object.assign({},e.state.filter,{badge:t?1:void 0})})},e.onRunChange=function(t){e.setState({runChecked:t,filter:Object.assign({},e.state.filter,{run:t?1:void 0})})},e.changeGalleryIndex=function(t){e.setState({activeIndex:t})},e.onVideoPlayerClose=function(){e.setState({showVideoPlayer:!1,videoUrl:""})},e.onTopicNameChange=function(t){e.setState({topicName:t,filter:Object.assign({},e.state.filter,{topicName:t||void 0})})},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&je(e,t)}(t,o["a"]),n=t,(i=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,a,o,i,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.common.paginationConfig,n=t.defaultPageSize,r=t.defaultCurrent,a=this.props.location,(o=this.$qs.parse(a.search)).type?this.setState({currentTab:o.type}):"/admin/community/tool/feed"===this.props.location.pathname||o.type||(i=a.pathname.split("/"),l=i[i.length-1],this.setState({currentTab:l})),this.resetPagination(n,r);case 5:case"end":return e.stop()}},e,this)}))}},{key:"componentDidUpdate",value:function(){"/admin/community/tool/feed"===this.props.location.pathname&&this.props.history.replace("/admin/community/tool/feed/list?type=all")}},{key:"render",value:function(){var e=this,t=this.props.match,n=this.state.currentTab,r=this.state,o=r.currentFeed,i=r.showModal,c=r.onlyCarousel,s=r.activeIndex;return a.createElement("div",{className:"feed"},a.createElement(g.a,Object.assign({},this.props,{currentTab:n,onTabClick:this.onTabClick,title:"动态信息管理",tabs:[{id:"all",title:"全部动态",path:"/admin/community/tool/feed/list?type=all",tipComponent:function(){return a.createElement(f.a,{placement:"bottomLeft",content:a.createElement("div",null,a.createElement("p",null,"不包含勋章话题"),a.createElement("p",null,"不显示纯跑步记录")),trigger:"hover"},a.createElement(m.a,{style:{marginLeft:6},type:"info-circle"}))}},{id:"recommend",title:"推荐动态",path:"/admin/community/tool/feed/list?type=recommend"},{id:"topic",title:"话题动态",path:"/admin/community/tool/feed/list?type=topic"},{id:"group-list",title:"分群动态",path:"/admin/community/tool/feed/group-list"}]})),a.createElement(p.a,{path:"".concat(t.url,"/list"),render:function(t){return a.createElement(v.a,Object.assign({},t,{config:j(e)}))}}),a.createElement(p.a,{path:"/admin/community/tool/feed/group-list",render:function(e){return a.createElement(pe,Object.assign({},e))}}),a.createElement(p.a,{path:"/admin/community/tool/feed/crawler-list",render:function(e){return a.createElement(Ce,Object.assign({},e))}}),a.createElement("section",{className:"feed-modal"},a.createElement(W.a,Object.assign({title:c?"查看图片":"",visible:i},o,{onlyCarousel:c,onOk:this.toggleRecommendStatus.bind(this,o),onCancel:this.toggleFeedDetailModal.bind(this,null),activeGalleryIndex:s,changeGalleryIndex:this.changeGalleryIndex}))),a.createElement("section",null,a.createElement(l.a,{width:800,title:"播放视频",maskClosable:!0,onCancel:this.onVideoPlayerClose,visible:this.state.showVideoPlayer,footer:null},this.state.videoUrl&&a.createElement(X.Player,null,a.createElement("source",{src:this.state.videoUrl})))))}}])&&Ne(n.prototype,i),c&&Ne(n,c),t}();Me=r.b([Object(y.a)("/admin/community/tool/feed",{exact:!1}),Object(h.b)("common","shoe","community","feed"),h.c],Me);t.default=Me}}]);