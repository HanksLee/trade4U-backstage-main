(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1419:function(e,t,n){"use strict";n.d(t,"a",function(){return F});var r=n(1),a=n(109),o=(n(1422),n(146)),i=n.n(o),c=(n(167),n(353)),l=n.n(c),s=(n(578),n(352)),u=n.n(s),m=(n(248),n(1377)),p=n.n(m),d=(n(1376),n(1371)),f=n.n(d),h=(n(1370),n(168)),b=n.n(h),y=(n(354),n(23)),g=n.n(y),v=(n(351),n(582)),E=n.n(v),w=(n(581),n(584)),S=n.n(w),k=(n(583),n(580)),C=n.n(k),O=(n(579),n(11)),N=n(16),T=n.n(N);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function R(e,t){return!t||"object"!==j(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function I(e,t){return(I=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=l.a.Option,_=u.a.Group,$=f.a.RangePicker,B=C.a.CheckableTag,L={SelectInput:function(e){var t=e.selectValue,n=e.inputValue,a=e.placeholder,o=e.options,i=e.onSelectChange,c=e.onInputChange,s=e.onPressEnter,m=e.selectStyle;return r.createElement(_,{compact:!0},r.createElement(l.a,{style:m?Object.assign({width:110},m):{width:110},value:t,onChange:i},o&&o.map(function(e,t){return r.createElement(D,{key:t,value:e.value},e.title)})),r.createElement(u.a,{style:{width:238},value:n,onChange:c,placeholder:a,onPressEnter:s}))},Select:function(e){var t=e.option,n=e.label,a=e.mode,o=e.onSearch,i=e.onSelect,c=e.onBlur,s=e.onFocus,u=e.value,m=e.placeholder,p=e.showSearch,d=e.width,f=e.filterOption,h=e.onChange,b=e.allowClear,y=e.onPopupScroll;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(l.a,{allowClear:b,value:u,mode:a||!1,style:{minWidth:d||258,width:d},showSearch:p,placeholder:m,filterOption:f,onSearch:o,onSelect:i,onChange:h,onBlur:c,onPopupScroll:y,onFocus:s},t.data.map(function(e){return r.createElement(D,{key:e[t.key]||e.id,value:e[t.value]||e.id,$data:e},e[t.title])}))))},DatePicker:function(e){var t=e.label,n=e.placeholder,a=e.onChange,o=e.value,i=e.style,c=e.format,l=e.showTime;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(f.a,{format:c||!1,style:i,showTime:l,placeholder:n,value:o,onChange:a})))},RangePicker:function(e){var t=e.label,n=e.alias,a=e.placeholder,o=e.onChange,c=e.value,l=e.showTime,s=e.format;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement($,{style:{width:400},showTime:l,format:s,placeholder:a,value:c,onChange:o}),r.createElement("span",{className:"common-list-control-date-alias"},!O.a.isEmpty(n)&&n.map(function(e,t){return r.createElement(i.a,{key:t,onClick:function(){return o([T()(Date.now()-864e5*e).startOf("day"),T()()])}},e," 天内")}))))},Input:function(e){var t=e.label,n=e.value,a=e.placeholder,o=e.onChange,i=e.width,c=e.onPressEnter;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(u.a,{style:{minWidth:i||258},value:n,onChange:o,placeholder:a,onPressEnter:c})))},Checkbox:function(e){var t=e.label,n=e.value,a=e.onChange;return r.createElement(b.a,{checked:n,onChange:a},t)},CheckableTag:function(e){var t=e.label,n=e.option,a=e.value,o=e.onChange;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},!O.a.isEmpty(n)&&n.map(function(e){return r.createElement(B,{key:e.value,checked:e.value===a,onChange:function(){o(e)}},e.title)})))},Label:function(e,t){var n=e.label;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},t))},Custom:function(e){return r.createElement("div",null,(void 0).props.children)}},F=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=R(this,P(t).apply(this,arguments))).state={collapse:!0},e.toggleCollapse=function(t){e.setState({collapse:!e.state.collapse})},e.renderSearcher=function(){var t=e.props.config,n=t.searcher,a=t.table,o=e.state.collapse;return n&&r.createElement("section",{className:"common-list-search"},e.renderWidgets(n.widgets),a&&a.tableHeader&&a.tableHeader(),r.createElement("div",{className:"common-list-search-right"},!n.hideSearcher&&r.createElement(r.Fragment,null,r.createElement(i.a,{type:"primary",onClick:n.onSearch},"查询"),r.createElement(i.a,{onClick:n.onReset},"重置")),n.collapseControl&&n.collapseControl.showMoreBtn&&r.createElement("span",{className:"common-list-serach-more"},r.createElement("a",{onClick:e.toggleCollapse},o?"更多":"收起"," ",r.createElement(g.a,{type:o?"down":"up"})))))},e.renderWidgets=function(t){var n=e.state.collapse,a=e.props.config.searcher;return t&&r.createElement("div",{className:"common-list-search-left"},t.map(function(t,o){return Array.isArray(t)?r.createElement("div",{key:o,className:"common-list-search-row",style:{display:a.collapseControl&&a.collapseControl.showMoreBtn&&n&&o>0?"none":"flex"}},t.map(function(t){return r.createElement("div",{key:t.label,className:"common-list-search-col",style:Object.assign({},t.style)},L[t.type]&&L[t.type](t,t.children?e.renderWidgets(t.children):null))})):r.createElement("div",{key:t.label,className:"common-list-search-row ".concat(t.className)},L[t.type]&&L[t.type](t,t.children?e.renderWidgets(t.children):null))}))},e.renderAddBtn=function(){var t=e.props.config,n=t.addBtn,a=t.searcher;return n&&r.createElement("section",{className:"common-list-addbtn",style:n.style},"function"==typeof n.title?r.createElement(n.title,null):n.title,r.createElement("div",{className:"common-list-search-batch"},a.batchControl.showBatchControl&&r.createElement(l.a,{placeholder:a.batchControl.placeholder,style:{minWidth:120},defaultValue:void 0,onChange:a.batchControl.onBatch},a.batchControl.options.map(function(e){return r.createElement(D,{key:e.value,value:e.value},e.title)}))))},e.renderTableHeader=function(){var t=e.props.config.tableHeader;return r.createElement("section",{className:"common-list-table-header"},t&&t())},e.renderTable=function(){var t=e.props.config.table,n=t.rowKey,a=t.rowSelection,o=t.columns,i=t.dataSource,c=t.pagination,l=t.onChange,s=t.loading,u=t.locale;return r.createElement("section",{className:"common-list-table"},r.createElement(p.a,{locale:u,rowKey:n||"id",rowSelection:a,columns:o,dataSource:i,loading:s,pagination:c,onChange:l}))},e.renderCards=function(){var t=e.props.config.cards,n=t.dataSource,a=t.loading,o=t.pagination,i=t.renderCard,c=t.addBtn;return r.createElement("div",{className:"common-list-cards-wrapper"},r.createElement("ul",{className:"common-list-cards"},a?r.createElement("div",{className:"common-list-cards-loading"},r.createElement(S.a,null)):r.createElement(r.Fragment,null,r.createElement("li",{className:"common-list-card add-btn"},r.createElement("div",{className:"common-list-card-item",onClick:c.onAddBtnClick},c.icon?r.createElement("img",{src:c.icon,alt:""}):r.createElement(g.a,{type:"plus-circle"}),r.createElement("p",null,c.title))),n.map(function(e){return r.createElement("li",{className:"common-list-card"},r.createElement("div",{className:"common-list-card-item"},i(e)))}))),r.createElement("section",{className:"common-list-cards-pagination"},r.createElement(E.a,Object.assign({},o))))},e}var n,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&I(e,t)}(t,a["a"]),n=t,(o=[{key:"render",value:function(){var e=this.props.config;return r.createElement("div",{className:"common-list"},this.renderSearcher(),this.renderAddBtn(),this.renderTableHeader(),e.table&&this.renderTable(),e.cards&&this.renderCards())}}])&&x(n.prototype,o),c&&x(n,c),t}()},1420:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1),a=n(1375),o=n.n(a),i=(n(1374),n(11));n(1421);function c(e){var t=i.a.getPageBreadcrumb(e.location.pathname),n=e.title,a=e.links,c=e.tabs,l=e.currentTab;return r.createElement("div",{className:"common-header"},r.createElement("section",{className:"common-header-breadcrumb"},t&&r.createElement(o.a,null,t.map(function(e,t){return r.createElement(o.a.Item,{key:t},e.title)}))),r.createElement("section",{className:"common-header-title"},r.createElement("h2",null,n),r.createElement("div",{className:"common-header-links"},a&&a.map(function(t,n){return r.createElement("a",{key:n,onClick:function(){e.history.push(t.path)}},t.title)}))),r.createElement("section",{className:"common-header-tabs"},c&&c.map(function(t,n){return r.createElement("a",{onClick:function(){e.onTabClick(t.id)},className:"".concat(l===t.id?"tab-active":""," ")},r.createElement("span",null,t.title),t.tipComponent&&t.tipComponent())})))}},1421:function(e,t,n){},1422:function(e,t,n){},1445:function(e,t,n){},1446:function(e,t,n){},1515:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(1),o=n(109),i=(n(1368),n(1378),n(351),n(586),n(120)),c=n(110),l=n(1420),s=n(200),u=n(11),m=n(1369),p=n.n(m),d=n(1379),f=n.n(d),h=(n(1445),n(1419)),b=n(146),y=n.n(b),g=(n(167),n(23)),v=n.n(g),E=n(1385),w=n.n(E),S=(n(1384),n(1383)),k=n.n(S),C=n(1390),O=n.n(C),N=(n(1389),n(16)),T=n.n(N);function j(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var x=function(e){var t=e.state,n=t.selectedRowKeys,o=t.showPopconfirmId,i={selectedRowKeys:n,onChange:function(t,n){e.setState({selectedRowKeys:t})}},c=[{title:"用户头像&名称",width:260,render:function(e,t){return a.createElement("div",{style:{display:"flex",alignItems:"center"}},a.createElement("img",{src:t.faceUrl,alt:"",style:{width:40,borderRadius:"50%",marginRight:6}}),a.createElement(k.a,{content:t.nick},u.a.ellipsis(t.nick||" -- ",20)))}},{title:"用户 ID",width:140,dataIndex:"uid",render:function(e,t){return e}},{title:"推荐简介",width:300,dataIndex:"userDescribe",render:function(e,t){return a.createElement(k.a,{content:t.userDescribe},u.a.ellipsis(t.userDescribe||" -- ",20))}},{title:"性别",width:120,dataIndex:"gender",render:function(e,t){return 1==e?"男":"女"}},{title:"跑量",width:180,dataIndex:"runAmount",render:function(e,t){return t.allMeter/1e3+" km"}},{title:"粉丝",width:100,dataIndex:"fansTotal",render:function(e,t){return e}},{title:"序号",dataIndex:"priority",width:200,render:function(t,n){return a.createElement("div",{className:"talent-order-".concat(n.uid)},a.createElement("p",null,n.priority," ",a.createElement(w.a,{visible:n.id===o,icon:null,title:e.renderOrderElem(n),getPopupContainer:function(){return document.getElementsByClassName("talent-order-".concat(n.uid))[0]},onConfirm:e.confirmOrder.bind(void 0,n),onCancel:e.cancelOrder,okText:"确定",cancelText:"取消"},a.createElement(v.a,{type:"edit",onClick:function(){return e.setState({showPopconfirmId:n.id,order:{key:n.id,value:n.priority}})}}))," "))}},{title:"状态",width:300,dataIndex:"status",render:function(e,t){var n=1==e?"上架":"下架",r=1==e?"success":"error";return a.createElement(O.a,{status:r,text:n})}},{title:"推荐时间",dataIndex:"createTime",width:200,render:function(e,t){return e?T()(e).format("YYYY.MM.DD HH:mm"):"--"}},{title:"操作",width:300,render:function(t,n){return a.createElement("div",{className:"common-list-table-operation"},a.createElement("span",{onClick:function(){e.props.community.setCurrentTalent(n),e.toggleTalentModal()}},"编辑简介"),"    ",a.createElement("span",{onClick:function(){return r.a(void 0,void 0,void 0,regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:e.blockOperation([n.id],n.status);case 1:case"end":return t.stop()}},t)}))}},1==n.status?"下架":"上架"),"    ",a.createElement("span",{onClick:function(){return e.delOperation([n.id])}},"移除"))}}],l={batchControl:{placeholder:"批量操作",showBatchControl:!u.a.isEmpty(e.state.selectedRowKeys),options:[{title:"上架",value:"upshelf"},{title:"下架",value:"downshelf"},{title:"移除",value:"delete"}],onBatch:function(t,n){e.onBatch(t)}},widgets:[{type:"SelectInput",label:"搜索",style:{width:110},placeholder:"请输入用户 ID 或昵称",options:[{title:"用户 ID",value:"uid"},{title:"用户昵称",value:"nick"}],inputValue:e.state.userValue,selectValue:e.state.userField,onSelectChange:function(t){e.setUserField(t)},onInputChange:function(t){e.setUserValue(t.target.value)},onPressEnter:function(){e.onSearch()}},{type:"Label",label:"其他选项",className:"other-opts",children:[{type:"Select",label:"排序",showSearch:!1,placeholder:"请选择排序选项",style:{marginLeft:30},value:e.state.sortValue,option:{key:"id",value:"id",title:"title",data:[{id:"2",title:"按推荐时间",field:"sortNum"},{id:"1",title:"按序号",field:"sortNum"}]},onSelect:function(t,n){e.onSortSelect(t,n)},onBlur:function(){}},{type:"Label",label:"筛选",className:"other-opts",children:[[{type:"Select",label:"",showSearch:!1,placeholder:"全部状态",value:e.state.status,option:{key:"status",value:"status",title:"title",data:[{id:void 0,title:"全部"},{id:1,title:"上架"},{id:2,title:"下架"}]},onSelect:function(t,n){e.onFilterSelect("status",t,n)},onBlur:function(){}}]]}]}],onSearch:function(){e.onSearch()},onReset:function(){e.onReset()}},s=Object.assign({},e.props.common.paginationConfig,{current:e.state.currentPage,total:e.props.community.talentListMeta.total,onShowSizeChange:function(t,n){e.resetPagination(n,t)}});return{addBtn:{title:function(){return a.createElement(y.a,{type:"primary",onClick:function(){e.props.community.setCurrentTalent({}),e.toggleTalentModal()}},a.createElement(v.a,{type:"plus"}),"添加达人")},style:{marginTop:-20}},searcher:l,table:{rowKey:"id",rowSelection:i,columns:c,dataSource:u.a.isEmpty(e.props.community.talentList)?[]:e.props.community.talentList,loading:e.state.tableLoading,pagination:s,onChange:function(t,n,r){var a={pageNum:t.current,pageSize:t.pageSize};if(!u.a.isEmpty(n))for(var o=0,i=Object.entries(n);o<i.length;o++){var c=j(i[o],2),l=c[0],s=c[1];a[l]=s?s[0]:void 0}a=u.a.isEmpty(r)?Object.assign({},a,{pageSize:a.pageSize,pageNum:a.pageNum}):Object.assign({},a,function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}({pageSize:a.pageSize,pageNum:a.pageNum},r.field,"".concat("descend"===r.order?1:0))),e.setState({filter:Object.assign({},a),currentPage:t.current},function(){e.getDataList(e.state.filter)})}}}},R=n(1373),P=n.n(R),I=(n(1372),n(352)),D=n.n(I);n(248),n(1446);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function $(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function B(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function L(e){return(L=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function F(e,t){return(F=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var V=P.a.Item,M=D.a.TextArea,z=function(e,t,n){return{labelCol:{span:e,offset:n},wrapperCol:{span:t}}},A=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=B(this,L(t).apply(this,arguments))).state={userIds:void 0,desc:void 0},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&F(e,t)}(t,o["a"]),n=t,(i=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.props.onRef(this);case 1:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){var e=this,t=this.props.community,n=t.currentTalent,r=t.setCurrentTalent,o=this.props.form.getFieldDecorator;return a.createElement("div",{className:"editor talent-editor"},a.createElement(P.a,{className:"editor-form"},u.a.isEmpty(n)&&a.createElement(V,Object.assign({},z(4,16),{label:"用户 ID"}),a.createElement(M,{placeholder:"多个用户，请换行分隔",rows:6,onChange:function(t){var n=t.target.value;e.setState({userIds:n.split(",").map(function(e){return e.trim()}).join(",")})}})),!u.a.isEmpty(n)&&a.createElement(V,Object.assign({label:"推荐简介"},z(4,16)),o("desc",{initialValue:n.userDescribe,rules:[]})(a.createElement(M,{placeholder:"请输入简介，最多 20 个字",rows:6,onChange:function(e){r({userDescribe:e.target.value},!1)}})))))}}])&&$(n.prototype,i),c&&$(n,c),t}(),K=A=r.b([P.a.create(),Object(c.b)("common","community")],A);function W(e){return(W="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function U(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Y(e){return(Y=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function J(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t){return(G=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var q=p.a.confirm,Q=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=Y(t).apply(this,arguments),(e=!o||"object"!==W(o)&&"function"!=typeof o?J(n):o).$talentEditor=null,e.state={tableLoading:!1,selectedRowKeys:[],currentPage:1,filter:{},userField:"uid",userValue:void 0,sortValue:void 0,status:void 0,modalVisible:!1,order:{key:void 0,value:void 0}},e.resetPagination=function(t,n){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({filter:Object.assign({},this.state.filter,{pageSize:t,pageNum:n})},function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.filter,this.getDataList(t);case 2:case"end":return e.stop()}},e,this)}))});case 1:case"end":return e.stop()}},e,this)}))},e.getDataList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=Object.assign({},e.state.filter,t);e.setState({filter:n,tableLoading:!0},function(){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.community.getTalentList(n);case 2:this.setState({tableLoading:!1});case 3:case"end":return e.stop()}},e,this)}))})},e.setUserField=function(t){var n,r=e.state.filter;"uid"!==t?(n=r.uid,delete r.uid):"nick"!==t&&(n=r.nick,delete r.nick),e.setState({userField:t,filter:Object.assign({},r,H({},t,n))})},e.setUserValue=function(t){e.setState({userValue:t,filter:Object.assign({},e.state.filter,H({},e.state.userField,t||void 0))})},e.onFilterSelect=function(t,n,r){var a;e.setState((H(a={},t,n),H(a,"filter",Object.assign({},e.state.filter,H({},t,n||void 0))),a),function(){e.onSearch()})},e.blockOperation=function(t,n){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){var r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.props.common.userInfo,1!=n){e.next=7;break}return e.next=4,this.$api.community.downshelfTalents({params:{ids:t.join(","),updateBy:r.empId}});case 4:a=e.sent,e.next=10;break;case 7:return e.next=9,this.$api.community.upshelfTalents({params:{ids:t.join(","),updateBy:r.empId}});case 9:a=e.sent;case 10:0!=a.data.ret?this.$msg.error(a.data.msg):this.getDataList(this.state.filter);case 11:case"end":return e.stop()}},e,this)}))},e.delOperation=function(t){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.props.common.userInfo,q({title:"达人删除操作",content:"请问是否删除当前选中的达人",onOk:function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.community.deleteTalents({params:{ids:t.join(","),updateBy:n.empId}});case 2:0==(r=e.sent).data.ret?this.getDataList(this.state.filter):this.$msg.error(r.data.msg);case 4:case"end":return e.stop()}},e,this)}))},onCancel:function(){}});case 2:case"end":return e.stop()}},e,this)}))},e.onSearch=function(){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.filter).uid||!Number.isNaN(Number(t.uid))){e.next=3;break}return e.abrupt("return",this.$msg.error("请输入正确用户 ID"));case 3:this.setState({filter:Object.assign({},t,{pageNum:1}),currentPage:1},function(){n.getDataList(n.state.filter)});case 4:case"end":return e.stop()}},e,this)}))},e.onReset=function(){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={pageNum:1,pageSize:this.state.filter.pageSize},this.setState({filter:t,currentPage:1,userValue:void 0,sortValue:void 0,status:void 0},function(){n.getDataList(n.state.filter)});case 2:case"end":return e.stop()}},e,this)}))},e.onSortSelect=function(t,n){var r=e.state.filter,a=n.props.$data.field,o=n.props.$data.id;e.setState({sortValue:t,filter:Object.assign({},r,H({},a,o))},function(){e.onSearch()})},e.onBatch=function(t){var n=e.state.selectedRowKeys;if(t&&u.a.isEmpty(n))return e.$msg.warning("请选择至少一条记录");"upshelf"===t?e.blockOperation(n,2):"downshelf"===t?e.blockOperation(n,1):"delete"===t&&e.delOperation(n)},e.onModalConfirm=function(){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r,a,o,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.props.community.currentTalent,n=this.props.common.userInfo,!t.id){e.next=11;break}if(!(t.userDescribe.length>20)){e.next=5;break}return e.abrupt("return",this.$msg.warn("推荐简介不得超过 20 个字"));case 5:return a={id:t.id,userDescribe:t.userDescribe,updateBy:n.empId},e.next=8,this.$api.community.updateTalents({params:a});case 8:r=e.sent,e.next=21;break;case 11:if(!u.a.isEmpty(this.$talentEditor.state.userIds)){e.next=13;break}return e.abrupt("return",this.$msg.warn("用户 ID 不能为空"));case 13:if(o=u.a.removeSpareLF(this.$talentEditor.state.userIds).split("\n").join(","),/^[\d,]+$/g.test(o)){e.next=17;break}return e.abrupt("return",this.$msg.warn("请输入合法用户 ID"));case 17:return i={uids:o,createBy:n.empId},e.next=20,this.$api.community.addTalents({params:i});case 20:r=e.sent;case 21:0==r.data.ret?(this.$msg.success(t.uid?"编辑简介成功":"添加达人成功"),this.toggleTalentModal(),this.getDataList(this.state.filter)):this.$msg.error(r.data.msg);case 22:case"end":return e.stop()}},e,this)}))},e.renderOrderElem=function(t){var n=e.state.order;return a.createElement("div",{key:t.id},a.createElement("span",null,"排序  "),a.createElement(f.a,{min:0,onChange:e.changeOrder.bind(J(e),t.id),value:n.value}))},e.confirmOrder=function(t){return r.a(J(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.order,n=this.props.common.userInfo,e.next=4,this.$api.community.updateTalentWeight({params:{id:t.key,priority:t.value,updateBy:n.empId}});case 4:0==(r=e.sent).data.ret?(this.$msg.success("修改排序成功"),this.getDataList(this.state.filter),this.cancelOrder()):this.$msg.error(r.data.msg);case 6:case"end":return e.stop()}},e,this)}))},e.cancelOrder=function(){e.setState({showPopconfirmId:0,order:{key:void 0,value:void 0}})},e.changeOrder=function(t,n){return n&&Number.isNaN(Number(n))?e.$msg.error("请输入正确排序值"):n&&n.toString().length>3?e.$msg.error("排序值不得超过 3 位"):void e.setState({order:{key:t,value:n}})},e.onModalCancel=function(){e.setState({modalVisible:!1}),e.props.community.setCurrentTalent({})},e.toggleTalentModal=function(){e.setState({modalVisible:!e.state.modalVisible})},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&G(e,t)}(t,o["a"]),n=t,(i=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.common.paginationConfig,n=t.defaultPageSize,r=t.defaultCurrent,this.resetPagination(n,r);case 2:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){var e=this,t=this.state.modalVisible,n=this.props.community.currentTalent;return a.createElement("div",{className:"talent-list"},a.createElement(h.a,Object.assign({},this.props,{config:x(this)})),t&&a.createElement(p.a,{visible:t,title:u.a.isEmpty(n.id)?"添加达人":"编辑达人",onOk:this.onModalConfirm,onCancel:this.onModalCancel},a.createElement(K,{onRef:function(t){return e.$talentEditor=t}})))}}])&&U(n.prototype,i),c&&U(n,c),t}(),X=Q=r.b([Object(c.b)("common","community"),c.c],Q);function Z(e){return(Z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ee(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function te(e,t){return!t||"object"!==Z(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function ne(e){return(ne=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function re(e,t){return(re=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ae=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=te(this,ne(t).apply(this,arguments))).state={currentTab:"talent",filter:{}},e.onTabClick=function(t){e.setState({currentTab:t},function(){var n="/admin/community/tool/user/".concat(t);e.props.history.push(n)})},e.toggleTab=function(t){e.setState({currentTab:t})},e}var n,c,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&re(e,t)}(t,o["a"]),n=t,s=[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.location.pathname.split("/");return"user"===n[n.length-1]?{currentTab:"talent-list"}:null}}],(c=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:"/admin/community/tool/user"===this.props.location.pathname?this.props.history.replace("/admin/community/tool/user/talent-list"):this.setState({currentTab:"talent-list"});case 2:case"end":return e.stop()}},e,this)}))}},{key:"componentDidUpdate",value:function(e,t){"/admin/community/tool/user"===this.props.location.pathname&&("talent-list"!==t.currentTab&&this.setState({currentTab:"talent-list"}),this.props.history.replace("/admin/community/tool/user/talent-list"))}},{key:"render",value:function(){var e=this,t=this.state.currentTab;return a.createElement("div",{className:"topic-category"},a.createElement(l.a,Object.assign({},this.props,{currentTab:t,onTabClick:this.onTabClick,title:"用户管理",tabs:[{id:"talent-list",title:"推荐达人",path:"/admin/community/tool/user/talent-list"}]})),a.createElement(i.a,{path:"/admin/community/tool/user/talent-list",render:function(t){return a.createElement(X,Object.assign({},t,{toggleTab:e.toggleTab}))}}))}}])&&ee(n.prototype,c),s&&ee(n,s),t}();ae=r.b([Object(s.a)("/admin/community/tool/user",{exact:!1}),Object(c.b)("common","community"),c.c],ae);t.default=ae}}]);