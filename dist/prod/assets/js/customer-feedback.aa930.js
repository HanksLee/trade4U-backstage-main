(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{1419:function(e,t,n){"use strict";n.d(t,"a",function(){return V});var r=n(1),a=n(109),o=(n(1422),n(146)),l=n.n(o),c=(n(167),n(353)),i=n.n(c),s=(n(578),n(352)),u=n.n(s),m=(n(248),n(1377)),p=n.n(m),f=(n(1376),n(1371)),d=n.n(f),h=(n(1370),n(168)),y=n.n(h),g=(n(354),n(23)),v=n.n(g),b=(n(351),n(582)),E=n.n(b),w=(n(581),n(584)),k=n.n(w),C=(n(583),n(580)),S=n.n(C),x=(n(579),n(11)),O=n(16),N=n.n(O);function R(e){return(R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return!t||"object"!==R(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function P(e){return(P=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var M=i.a.Option,_=u.a.Group,D=d.a.RangePicker,L=S.a.CheckableTag,F={SelectInput:function(e){var t=e.selectValue,n=e.inputValue,a=e.placeholder,o=e.options,l=e.onSelectChange,c=e.onInputChange,s=e.onPressEnter,m=e.selectStyle;return r.createElement(_,{compact:!0},r.createElement(i.a,{style:m?Object.assign({width:110},m):{width:110},value:t,onChange:l},o&&o.map(function(e,t){return r.createElement(M,{key:t,value:e.value},e.title)})),r.createElement(u.a,{style:{width:238},value:n,onChange:c,placeholder:a,onPressEnter:s}))},Select:function(e){var t=e.option,n=e.label,a=e.mode,o=e.onSearch,l=e.onSelect,c=e.onBlur,s=e.onFocus,u=e.value,m=e.placeholder,p=e.showSearch,f=e.width,d=e.filterOption,h=e.onChange,y=e.allowClear,g=e.onPopupScroll;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(i.a,{allowClear:y,value:u,mode:a||!1,style:{minWidth:f||258,width:f},showSearch:p,placeholder:m,filterOption:d,onSearch:o,onSelect:l,onChange:h,onBlur:c,onPopupScroll:g,onFocus:s},t.data.map(function(e){return r.createElement(M,{key:e[t.key]||e.id,value:e[t.value]||e.id,$data:e},e[t.title])}))))},DatePicker:function(e){var t=e.label,n=e.placeholder,a=e.onChange,o=e.value,l=e.style,c=e.format,i=e.showTime;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(d.a,{format:c||!1,style:l,showTime:i,placeholder:n,value:o,onChange:a})))},RangePicker:function(e){var t=e.label,n=e.alias,a=e.placeholder,o=e.onChange,c=e.value,i=e.showTime,s=e.format;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(D,{style:{width:400},showTime:i,format:s,placeholder:a,value:c,onChange:o}),r.createElement("span",{className:"common-list-control-date-alias"},!x.a.isEmpty(n)&&n.map(function(e,t){return r.createElement(l.a,{key:t,onClick:function(){return o([N()(Date.now()-864e5*e).startOf("day"),N()()])}},e," 天内")}))))},Input:function(e){var t=e.label,n=e.value,a=e.placeholder,o=e.onChange,l=e.width,c=e.onPressEnter;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(u.a,{style:{minWidth:l||258},value:n,onChange:o,placeholder:a,onPressEnter:c})))},Checkbox:function(e){var t=e.label,n=e.value,a=e.onChange;return r.createElement(y.a,{checked:n,onChange:a},t)},CheckableTag:function(e){var t=e.label,n=e.option,a=e.value,o=e.onChange;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},!x.a.isEmpty(n)&&n.map(function(e){return r.createElement(L,{key:e.value,checked:e.value===a,onChange:function(){o(e)}},e.title)})))},Label:function(e,t){var n=e.label;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},t))},Custom:function(e){return r.createElement("div",null,(void 0).props.children)}},V=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=j(this,P(t).apply(this,arguments))).state={collapse:!0},e.toggleCollapse=function(t){e.setState({collapse:!e.state.collapse})},e.renderSearcher=function(){var t=e.props.config,n=t.searcher,a=t.table,o=e.state.collapse;return n&&r.createElement("section",{className:"common-list-search"},e.renderWidgets(n.widgets),a&&a.tableHeader&&a.tableHeader(),r.createElement("div",{className:"common-list-search-right"},!n.hideSearcher&&r.createElement(r.Fragment,null,r.createElement(l.a,{type:"primary",onClick:n.onSearch},"查询"),r.createElement(l.a,{onClick:n.onReset},"重置")),n.collapseControl&&n.collapseControl.showMoreBtn&&r.createElement("span",{className:"common-list-serach-more"},r.createElement("a",{onClick:e.toggleCollapse},o?"更多":"收起"," ",r.createElement(v.a,{type:o?"down":"up"})))))},e.renderWidgets=function(t){var n=e.state.collapse,a=e.props.config.searcher;return t&&r.createElement("div",{className:"common-list-search-left"},t.map(function(t,o){return Array.isArray(t)?r.createElement("div",{key:o,className:"common-list-search-row",style:{display:a.collapseControl&&a.collapseControl.showMoreBtn&&n&&o>0?"none":"flex"}},t.map(function(t){return r.createElement("div",{key:t.label,className:"common-list-search-col",style:Object.assign({},t.style)},F[t.type]&&F[t.type](t,t.children?e.renderWidgets(t.children):null))})):r.createElement("div",{key:t.label,className:"common-list-search-row ".concat(t.className)},F[t.type]&&F[t.type](t,t.children?e.renderWidgets(t.children):null))}))},e.renderAddBtn=function(){var t=e.props.config,n=t.addBtn,a=t.searcher;return n&&r.createElement("section",{className:"common-list-addbtn",style:n.style},"function"==typeof n.title?r.createElement(n.title,null):n.title,r.createElement("div",{className:"common-list-search-batch"},a.batchControl.showBatchControl&&r.createElement(i.a,{placeholder:a.batchControl.placeholder,style:{minWidth:120},defaultValue:void 0,onChange:a.batchControl.onBatch},a.batchControl.options.map(function(e){return r.createElement(M,{key:e.value,value:e.value},e.title)}))))},e.renderTableHeader=function(){var t=e.props.config.tableHeader;return r.createElement("section",{className:"common-list-table-header"},t&&t())},e.renderTable=function(){var t=e.props.config.table,n=t.rowKey,a=t.rowSelection,o=t.columns,l=t.dataSource,c=t.pagination,i=t.onChange,s=t.loading,u=t.locale;return r.createElement("section",{className:"common-list-table"},r.createElement(p.a,{locale:u,rowKey:n||"id",rowSelection:a,columns:o,dataSource:l,loading:s,pagination:c,onChange:i}))},e.renderCards=function(){var t=e.props.config.cards,n=t.dataSource,a=t.loading,o=t.pagination,l=t.renderCard,c=t.addBtn;return r.createElement("div",{className:"common-list-cards-wrapper"},r.createElement("ul",{className:"common-list-cards"},a?r.createElement("div",{className:"common-list-cards-loading"},r.createElement(k.a,null)):r.createElement(r.Fragment,null,r.createElement("li",{className:"common-list-card add-btn"},r.createElement("div",{className:"common-list-card-item",onClick:c.onAddBtnClick},c.icon?r.createElement("img",{src:c.icon,alt:""}):r.createElement(v.a,{type:"plus-circle"}),r.createElement("p",null,c.title))),n.map(function(e){return r.createElement("li",{className:"common-list-card"},r.createElement("div",{className:"common-list-card-item"},l(e)))}))),r.createElement("section",{className:"common-list-cards-pagination"},r.createElement(E.a,Object.assign({},o))))},e}var n,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,a["a"]),n=t,(o=[{key:"render",value:function(){var e=this.props.config;return r.createElement("div",{className:"common-list"},this.renderSearcher(),this.renderAddBtn(),this.renderTableHeader(),e.table&&this.renderTable(),e.cards&&this.renderCards())}}])&&I(n.prototype,o),c&&I(n,c),t}()},1420:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1),a=n(1375),o=n.n(a),l=(n(1374),n(11));n(1421);function c(e){var t=l.a.getPageBreadcrumb(e.location.pathname),n=e.title,a=e.links,c=e.tabs,i=e.currentTab;return r.createElement("div",{className:"common-header"},r.createElement("section",{className:"common-header-breadcrumb"},t&&r.createElement(o.a,null,t.map(function(e,t){return r.createElement(o.a.Item,{key:t},e.title)}))),r.createElement("section",{className:"common-header-title"},r.createElement("h2",null,n),r.createElement("div",{className:"common-header-links"},a&&a.map(function(t,n){return r.createElement("a",{key:n,onClick:function(){e.history.push(t.path)}},t.title)}))),r.createElement("section",{className:"common-header-tabs"},c&&c.map(function(t,n){return r.createElement("a",{onClick:function(){e.onTabClick(t.id)},className:"".concat(i===t.id?"tab-active":""," ")},r.createElement("span",null,t.title),t.tipComponent&&t.tipComponent())})))}},1421:function(e,t,n){},1422:function(e,t,n){},1423:function(e,t,n){"use strict";var r=function(e){var t=e;return 15===e.length&&(t=function(e){if(/^\d{15}$/.test(e)){e=e.substr(0,6)+"19"+e.substr(6,e.length-6);for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=0,r=0;r<e.length;r++)n+=parseInt(e.substr(r,1))*t[r];return e+["1","0","X","9","8","7","6","5","4","3","2"][n%11]}return e}(e)),function(e){if(!/^\d{17}(\d|x)$/i.test(e))return!1;return null!=={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙",21:"辽宁",22:"吉林",23:"黑龙",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",83:"台湾",91:"国外"}[parseInt(e.substr(0,2))]}(t)},a=function(e){return/^[HMhm]{1}([0-9]{8})$/.test(e)},o=function(e){return/^[0-9]{8}$/.test(e)||/^[0-9]{10}$/.test(e)},l=function(e){return/^[a-zA-Z]{5, 17}$/.test(e)||/^[a-zA-Z0-9]$/.test(e)},c=n(11);function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return u});var s={isNonEmpty:function(e,t,n){if(0!==e&&c.a.isEmpty(e))return n&&n(),t},maxLength:function(e,t,n,r){if(e.length>t)return r&&r(),n},minLength:function(e,t,n,r){if(e.length<t)return r&&r(),n},isEmail:function(e,t,n){if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e))return n&&n(),t},isMobile:function(e,t,n){if(!/^(13[0-9]|14[57]|15[012356789]|16[0-9]|18[0-9]|17[0-9]|19[0-9])\d{8}$/.test(e))return n&&n(),t},isID:function(e,t,n,c){var i=null;if("id"===t?i=r:"HKMC"===t?i=a:"TW"===t?i=o:"PSPort"===t&&(i=l),!i(e))return c&&c(),n},isNumber:function(e,t,n){if(e&&Number.isNaN(Number(e)))return n&&n(),t},isHexColor:function(e,t,n){var r=e.toString();if(!r||!function(e){if("#"!==e[0])return!1;var t=e.slice(1);return 6===t.length&&/^[0-9a-fA-f]{6}$/.test(t)}(r))return n&&n(),t},customReg:function(e,t,n,r){var a=e.toString();if(!a||!new RegExp(t).test(a))return r&&r(),n}},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=[]}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){var n=this,r=!0,a=!1,o=void 0;try{for(var l,c=function(){var t=l.value,r=t.strategy.split(":");n.cache.push(function(){var n=r.shift();return r.unshift(e),r.push(t.errMsg),r.push(t.cb),s[n].apply(null,r)})},i=t[Symbol.iterator]();!(r=(l=i.next()).done);r=!0)c()}catch(e){a=!0,o=e}finally{try{r||null==i.return||i.return()}finally{if(a)throw o}}}},{key:"start",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.cache[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=(0,r.value)();if(o)return o}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}}])&&i(t.prototype,n),r&&i(t,r),e}()},1426:function(e,t,n){"use strict";n.d(t,"a",function(){return f});var r=n(1),a=n(582),o=n.n(a),l=(n(581),n(1387)),c=n.n(l);n(1386),n(1427);function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return!t||"object"!==i(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var f=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=u(this,m(t).apply(this,arguments))).$carousel=null,e.changeGalleryIndex=function(t,n){e.props.changeGalleryIndex&&e.props.changeGalleryIndex(t-1)},e}var n,a,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}(t,r["Component"]),n=t,(a=[{key:"componentDidMount",value:function(){var e=this.props.activeIndex;this.$carousel.goTo(e)}},{key:"componentDidUpdate",value:function(){var e=this.props.activeIndex;this.$carousel.goTo(e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.source,a=t.activeIndex;return r.createElement("div",{className:"gallery"},r.createElement("section",{className:"gallery-carousel"},r.createElement(c.a,{ref:function(t){return e.$carousel=t},dots:!1},n&&n.map(function(e){return r.createElement("div",{className:"gallery-item"},r.createElement("h3",{className:"gallery-item-img",style:{backgroundImage:"url(".concat(e.src||e.url||e.imgUrl||e.colorImgUrl,")")}}))}))),r.createElement("section",{className:"gallery-pagination"},r.createElement(o.a,{pageSize:1,current:a+1,total:n.length,onChange:this.changeGalleryIndex})))}}])&&s(n.prototype,a),l&&s(n,l),t}();f.defaultProps={activeIndex:0,source:[]}},1427:function(e,t,n){},1489:function(e,t,n){},1490:function(e,t,n){},1524:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(1),o=n.n(a),l=n(109),c=n(200),i=(n(1489),n(120)),s=n(1369),u=n.n(s),m=(n(1368),n(352)),p=n.n(m),f=(n(248),n(353)),d=n.n(f),h=(n(578),n(72)),y=n.n(h),g=(n(249),n(203)),v=n.n(g),b=(n(250),n(23)),E=n.n(b),w=(n(351),n(1373)),k=n.n(w),C=(n(1372),n(110)),S=n(1420),x=n(1419),O=n(1390),N=n.n(O),R=(n(1389),n(146)),I=n.n(R),j=(n(167),n(202)),P=n.n(j),T=(n(355),n(11)),M=n(16),_=n.n(M),D=n(1406),L=n.n(D);n(1490);function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function V(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function G(e,t){return!t||"object"!==F(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function B(e){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var Y=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=G(this,B(t).apply(this,arguments))).state={expand:!1},e.toggleLines=function(t){t.preventDefault(),e.setState({expand:!e.state.expand})},e}var n,r,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,a["Component"]),n=t,(r=[{key:"render",value:function(){var e=this.props,t=e.width,n=e.lines,r=e.content,a=e.more,l=e.less,c=this.state.expand;return o.a.createElement("div",{className:"ellipsis-text"},o.a.createElement(L.a,{width:t,line:c?100:n,truncateText:"...",text:r,textTruncateChild:o.a.createElement("span",null,o.a.createElement("a",{href:"#",className:"expand-text",onClick:this.toggleLines},a,o.a.createElement(E.a,{type:"down"})))}),c&&o.a.createElement("span",null,o.a.createElement("a",{href:"#",className:"expand-text",onClick:this.toggleLines},l)))}}])&&V(n.prototype,r),l&&V(n,l),t}();Y.defaultProps={lines:3,more:"更多",less:"收起 >"};var A=Y,$=function(e){var t={selectedRowKeys:e.state.selectedRowKeys,onChange:function(t,n){e.setState({selectedRowKeys:t})}},n=Object.assign({},e.props.customer.paginationConfig,{current:e.props.customer.paginationConfig.current,onChange:function(t,n){e.resetPagination(n,t)},onShowSizeChange:function(t,n){e.resetPagination(n,t)}}),r=[{width:80,title:"UID",dataIndex:"uid"},{width:120,title:"创建时间",dataIndex:"createTime",render:function(e,t){return _()(e).format("YYYY-MM-DD HH:mm:ss")}},{width:150,title:"反馈类型",dataIndex:"type",render:function(t,n){if("number"==typeof t&&t>0){var r=e.props.customer.typeList.find(function(e){return e.id===t});return r?r.value:""}}},{title:"反馈内容",render:function(t,n){var r=[];return r=n.imgs.filter(function(e){return!!e}).map(function(e){return{url:e}}),a.createElement("div",null,a.createElement("div",null,a.createElement(A,{lines:3,content:n.content})),a.createElement("div",{className:"feedback-imgs"},r.map(function(t,n){return a.createElement("a",{key:n,onClick:function(){e.setState({currentGallery:r,currentGalleryIndex:n,galleryVisible:!0})}},a.createElement("img",{src:t.url,alt:"",style:{objectFit:"contain"}}))})))}},{width:120,title:"状态",dataIndex:"status",render:function(e,t){var n={0:{status:"processing",text:"待回复"},1:{status:"success",text:"已回复"},2:{status:"warning",text:"无效反馈"},9:{status:"default",text:"已删除"}};return a.createElement("div",null,a.createElement(N.a,{status:n[e].status,text:n[e].text}),t.respContent&&a.createElement(P.a,{placement:"bottomLeft",title:t.respContent,arrowPointAtCenter:!0},a.createElement("div",{style:{color:"#999"}},"查看 >")))}},{width:80,title:"备注",dataIndex:"remark"},{width:80,title:"操作人",dataIndex:"handleUser"},{width:100,title:"操作",render:function(t,n){return 9!==n.status?a.createElement("div",{className:"common-list-table-operation"},a.createElement("span",{onClick:function(){return e.goToEditor(n)}},"编辑"),a.createElement("span",{className:"common-list-table-operation-spliter"}),a.createElement("span",{onClick:function(){return e.deleteFeedbackByIds(n.id)}},"删除")):null}}];return{addBtn:{title:function(){return a.createElement(I.a,{type:"primary",onClick:function(){window.open("https://data.thejoyrun.com")}},"导出Excel")}},searcher:{batchControl:{placeholder:"请选择",showBatchControl:!T.a.isEmpty(e.state.selectedRowKeys),options:[{title:"删除",value:"delete"}],onBatch:function(t){e.onBatch(t)}},widgets:[[{type:"Input",label:"UID",placeholder:"请输入UID",value:e.state.uidInputValue||void 0,onChange:function(t){e.setUidInputValue(t.target.value)}},{type:"Select",label:"状态",showSearch:!1,placeholder:"请选择状态",allowClear:!1,width:150,value:e.state.searchStatus,option:{key:"id",value:"value",title:"text",data:e.props.customer.statusList||[]},onSelect:function(t,n){e.onStatusSelect(t,n)}},{type:"Select",label:"反馈类型",showSearch:!1,placeholder:"请选择反馈类型",allowClear:!1,width:200,value:e.state.searchType,option:{key:"id",value:"id",title:"value",data:e.props.customer.typeList||[]},onSelect:function(t,n){e.onTypeSelect(t,n)}}],{type:"RangePicker",label:"创建时间",placeholder:["开始日期","结束日期"],showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",alias:[1,7,30],value:e.state.searchDateRange||[],onChange:function(t){e.onSearchDateRangeChange(t)}}],onSearch:function(t){e.onSearch(t)},onReset:function(){e.onReset()}},table:{rowKey:"id",rowSelection:t,columns:r,pagination:n,dataSource:e.state.allList,onChange:function(e,t,n){}}}},K=n(1426),U=n(1423);function z(e){return(z="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function Z(e){return(Z=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function q(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function J(e,t){return(J=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var X=u.a.confirm,Q=d.a.Option,ee=p.a.TextArea,te=k.a.Item,ne=y.a.Item,re={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:12}}},ae=[],oe=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=Z(t).apply(this,arguments),(e=!o||"object"!==z(o)&&"function"!=typeof o?q(n):o).state={selectedRowKeys:[],filter:{},modalVisible:!1,galleryVisible:!1,confirmLoading:!1,allList:[],currentPage:1,currentGallery:[],currentGalleryIndex:0,uidInputValue:void 0,searchStatus:void 0,searchType:void 0,searchRemark:void 0,searchDateRange:[],truncateLines:3},e.resetPagination=function(t,n){return r.a(q(e),void 0,void 0,regeneratorRuntime.mark(function e(){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({filter:Object.assign({},this.state.filter,{limit:t,pageNum:n})},function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.filter,e.next=3,this.props.customer.getAllList(t);case 3:r=e.sent,this.props.customer.setPaginationCurrent(n),this.setState({allList:r});case 6:case"end":return e.stop()}},e,this)}))});case 1:case"end":return e.stop()}},e,this)}))},e.goToEditor=function(t){t&&t.id&&(e.setState({modalVisible:!0}),e.props.customer.setCurrentFeedback(t,!0))},e.renderEditModal=function(){var t=e.state,n=t.modalVisible,r=t.confirmLoading;return n&&a.createElement(u.a,{title:"编辑用户反馈",visible:n,onOk:e.handleEditModalOk,confirmLoading:r,onCancel:e.handleEditModalCancel,okText:"保存",cancelText:"取消",zIndex:99,width:700},e.renderModalContent())},e.handleEditModalOk=function(){return r.a(q(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.customer.getCurrentFeedback,this.props.form.validateFields(function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getValidation(t))){e.next=3;break}return e.abrupt("return",this.$msg.warn(n));case 3:return r=this.props.common.userInfo.empName,this.setState({confirmLoading:!0}),e.next=7,this.props.customer.updateFeedback(r,this.state.filter);case 7:a=e.sent,this.setState({allList:a,confirmLoading:!1,modalVisible:!1});case 9:case"end":return e.stop()}},e,this)}))});case 2:case"end":return e.stop()}},e,this)}))},e.getValidation=function(e){var t=new U.a;return t.add(e.status,[{strategy:"isNonEmpty",errMsg:"请选择状态"}]),t.add(e.remark,[{strategy:"isNonEmpty",errMsg:"请选择备注"}]),t.start()},e.handleEditModalCancel=function(){e.setState({modalVisible:!1})},e.handleMenuClick=function(t){var n=e.props.customer.addDefaultReplyToContent(t.key);e.props.form.setFieldsValue({respContent:n})},e.renderModalContent=function(){var t=e.props.customer,n=e.props.customer.getCurrentFeedback,r=e.props.customer.getRemarkList,o=e.props.form.getFieldDecorator,l=a.createElement(y.a,{onClick:e.handleMenuClick},e.props.customer.replyList.map(function(e){return a.createElement(ne,{key:e.content},e.content)}));return a.createElement(k.a,Object.assign({className:"customer-feedback-edit-modal custom-label-width"},re),a.createElement(te,{label:"UID"},n.uid),a.createElement(te,{label:"提交时间"},_()(n.createTime).format("YYYY-MM-DD HH:mm:ss")),a.createElement(te,{label:"反馈类型"},n.typeContent),a.createElement(te,{label:"图片"},a.createElement("div",{className:"feedback-imgs"},n.showImgs.map(function(t,r){return t&&a.createElement("a",{key:r,onClick:function(){e.setState({currentGallery:n.showImgs,currentGalleryIndex:r,galleryVisible:!0})}},a.createElement("img",{src:t.url,alt:"",style:{objectFit:"contain"}}))}))),a.createElement(te,{label:"反馈内容"},n.content),a.createElement(te,{label:"状态"},o("status",{initialValue:n&&n.status,rules:[{required:!0,type:"number",message:"请选择状态"}]})(a.createElement(d.a,{style:{width:150},onChange:function(e){t.setCurrentFeedback({status:e},!1)}},t.editStatusList.map(function(e){return a.createElement(Q,{key:e.value,value:e.value},e.text)})))),a.createElement(te,{label:"回复"},o("respContent",{initialValue:n&&n.respContent,rules:[]})(a.createElement(ee,{style:{width:420},onChange:function(e){t.setCurrentFeedback({respContent:e.target.value},!1)}})),a.createElement(v.a,{overlay:l,trigger:["click"]},a.createElement("a",{className:"ant-dropdown-link",href:"#"},"添加快捷回复 ",a.createElement(E.a,{type:"down"})))),a.createElement(te,{label:"备注"},o("remark",{initialValue:n&&n.remark,rules:[{required:!0,message:"请选择备注"}]})(a.createElement(d.a,{style:{width:150},onChange:function(e){t.setCurrentFeedback({remark:e},!1)}},r.map(function(e){return a.createElement(Q,{key:e.id,value:e.content},e.content)}))),"其他"==n.remark&&a.createElement(p.a,{style:{width:238},onChange:function(e){e.target.value&&t.setCurrentFeedback({remarkDetail:e.target.value},!1)},placeholder:"请输入..."})),a.createElement(te,{label:"操作人"},n.handleUser),a.createElement(te,{label:"操作时间"},n.handleTime))},e.changeGalleryIndex=function(t){e.setState({currentGalleryIndex:t})},e.onGalleryModalOk=function(){e.setState({currentGallery:[],currentGalleryIndex:0,galleryVisible:!1})},e.onGalleryModalCancel=function(){e.setState({currentGallery:[],currentGalleryIndex:0,galleryVisible:!1})},e.deleteFeedbackByIds=function(t){return r.a(q(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:X({title:"删除用户反馈操作",content:"用户反馈将被删除，请问是否确认？",onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.props.common.userInfo.empName,e.next=3,this.props.customer.deleteFeedbackByIds(n,t,this.state.filter);case 3:r=e.sent,this.setState({allList:r});case 5:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}});case 1:case"end":return e.stop()}},e)}))},e.onBatch=function(t){return r.a(q(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n,a,o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.selectedRowKeys,"delete"===t&&(a=n.join(","),X({title:"批量删除用户反馈操作",content:"以下id：[".concat(a,"]的用户反馈将会被删除，请问是否确认？"),onOk:function(){return r.a(o,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.common.userInfo.empName,e.next=3,this.props.customer.deleteFeedbackByIds(t,a,this.state.filter);case 3:n=e.sent,this.setState({selectedRowKeys:[],allList:n});case 5:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(o,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({selectedRowKeys:[]});case 1:case"end":return e.stop()}},e,this)}))}}));case 2:case"end":return e.stop()}},e,this)}))},e.onSearch=function(){return r.a(q(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({filter:Object.assign({},this.state.filter,{pageNum:1})},function(){return r.a(t,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.customer.getAllList(this.state.filter);case 2:t=e.sent,this.props.customer.setPaginationCurrent(1),this.setState({allList:t});case 5:case"end":return e.stop()}},e,this)}))});case 1:case"end":return e.stop()}},e,this)}))},e.onTypeSelect=function(t,n){t&&e.setState({searchType:t,filter:Object.assign({},e.state.filter,{type:t})})},e.onStatusSelect=function(t,n){e.setState({searchStatus:t,filter:Object.assign({},e.state.filter,{status:t})})},e.onRemarkSelect=function(t,n){e.setState({searchRemark:t,filter:Object.assign({},e.state.filter,{remark:t})})},e.onSearchDateRangeChange=function(t){e.setState({searchDateRange:t,filter:Object.assign({},e.state.filter,{startTime:t[0]?_()(t[0]).format("YYYY-MM-DD HH:mm:ss"):"",endTime:t[1]?_()(t[1]).format("YYYY-MM-DD HH:mm:ss"):""})})},e.onReset=function(){return r.a(q(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return delete(t=Object.assign({},this.state.filter,{pageNum:1})).type,delete t.status,delete t.startTime,delete t.endTime,delete t.uid,delete t.remark,this.props.customer.setPaginationCurrent(1),e.next=10,this.props.customer.getAllList(t);case 10:n=e.sent,this.setState({allList:n,filter:t,searchDateRange:[],searchRemark:void 0,searchStatus:void 0,searchType:void 0,uidInputValue:void 0});case 12:case"end":return e.stop()}},e,this)}))},e.setUidInputValue=function(t){e.setState({uidInputValue:t,filter:Object.assign({},e.state.filter,{uid:t})})},e}var n,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&J(e,t)}(t,l["a"]),n=t,(o=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.customer.paginationConfig,n=t.defaultPageSize,r=t.defaultCurrent,this.resetPagination(n,r);case 2:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){var e=this,t=this.props.match,n=this.state,r=n.currentGallery,o=n.currentGalleryIndex,l=n.galleryVisible;return a.createElement("div",{className:"customer-feedback"},a.createElement(S.a,Object.assign({},this.props,{links:ae,title:"用户反馈管理"})),a.createElement(i.a,{path:"".concat(t.url),render:function(t){return a.createElement(x.a,Object.assign({},t,{config:$(e)}))}}),a.createElement(u.a,{title:"用户反馈图片",visible:l,onOk:this.onGalleryModalOk,onCancel:this.onGalleryModalCancel,zIndex:100},a.createElement(K.a,{source:r,activeIndex:o,changeGalleryIndex:this.changeGalleryIndex})),this.renderEditModal())}}])&&W(n.prototype,o),c&&W(n,c),t}();oe=r.b([Object(c.a)("/admin/customer/feedback",{exact:!1}),k.a.create(),Object(C.b)("common","customer"),C.c],oe);t.default=oe}}]);