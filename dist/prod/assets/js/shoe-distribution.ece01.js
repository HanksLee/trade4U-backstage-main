(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{1419:function(e,t,n){"use strict";n.d(t,"a",function(){return _});var r=n(1),a=n(109),o=(n(1422),n(146)),i=n.n(o),c=(n(167),n(353)),s=n.n(c),l=(n(578),n(352)),u=n.n(l),m=(n(248),n(1377)),d=n.n(m),p=(n(1376),n(1371)),f=n.n(p),h=(n(1370),n(168)),g=n.n(h),b=(n(354),n(23)),v=n.n(b),y=(n(351),n(582)),E=n.n(y),S=(n(581),n(584)),w=n.n(S),C=(n(583),n(580)),N=n.n(C),k=(n(579),n(11)),O=n(16),R=n.n(O);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function j(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function x(e){return(x=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e,t){return(L=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var D=s.a.Option,$=u.a.Group,B=f.a.RangePicker,F=N.a.CheckableTag,T={SelectInput:function(e){var t=e.selectValue,n=e.inputValue,a=e.placeholder,o=e.options,i=e.onSelectChange,c=e.onInputChange,l=e.onPressEnter,m=e.selectStyle;return r.createElement($,{compact:!0},r.createElement(s.a,{style:m?Object.assign({width:110},m):{width:110},value:t,onChange:i},o&&o.map(function(e,t){return r.createElement(D,{key:t,value:e.value},e.title)})),r.createElement(u.a,{style:{width:238},value:n,onChange:c,placeholder:a,onPressEnter:l}))},Select:function(e){var t=e.option,n=e.label,a=e.mode,o=e.onSearch,i=e.onSelect,c=e.onBlur,l=e.onFocus,u=e.value,m=e.placeholder,d=e.showSearch,p=e.width,f=e.filterOption,h=e.onChange,g=e.allowClear,b=e.onPopupScroll;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(s.a,{allowClear:g,value:u,mode:a||!1,style:{minWidth:p||258,width:p},showSearch:d,placeholder:m,filterOption:f,onSearch:o,onSelect:i,onChange:h,onBlur:c,onPopupScroll:b,onFocus:l},t.data.map(function(e){return r.createElement(D,{key:e[t.key]||e.id,value:e[t.value]||e.id,$data:e},e[t.title])}))))},DatePicker:function(e){var t=e.label,n=e.placeholder,a=e.onChange,o=e.value,i=e.style,c=e.format,s=e.showTime;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(f.a,{format:c||!1,style:i,showTime:s,placeholder:n,value:o,onChange:a})))},RangePicker:function(e){var t=e.label,n=e.alias,a=e.placeholder,o=e.onChange,c=e.value,s=e.showTime,l=e.format;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(B,{style:{width:400},showTime:s,format:l,placeholder:a,value:c,onChange:o}),r.createElement("span",{className:"common-list-control-date-alias"},!k.a.isEmpty(n)&&n.map(function(e,t){return r.createElement(i.a,{key:t,onClick:function(){return o([R()(Date.now()-864e5*e).startOf("day"),R()()])}},e," 天内")}))))},Input:function(e){var t=e.label,n=e.value,a=e.placeholder,o=e.onChange,i=e.width,c=e.onPressEnter;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(u.a,{style:{minWidth:i||258},value:n,onChange:o,placeholder:a,onPressEnter:c})))},Checkbox:function(e){var t=e.label,n=e.value,a=e.onChange;return r.createElement(g.a,{checked:n,onChange:a},t)},CheckableTag:function(e){var t=e.label,n=e.option,a=e.value,o=e.onChange;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},!k.a.isEmpty(n)&&n.map(function(e){return r.createElement(F,{key:e.value,checked:e.value===a,onChange:function(){o(e)}},e.title)})))},Label:function(e,t){var n=e.label;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},t))},Custom:function(e){return r.createElement("div",null,(void 0).props.children)}},_=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=j(this,x(t).apply(this,arguments))).state={collapse:!0},e.toggleCollapse=function(t){e.setState({collapse:!e.state.collapse})},e.renderSearcher=function(){var t=e.props.config,n=t.searcher,a=t.table,o=e.state.collapse;return n&&r.createElement("section",{className:"common-list-search"},e.renderWidgets(n.widgets),a&&a.tableHeader&&a.tableHeader(),r.createElement("div",{className:"common-list-search-right"},!n.hideSearcher&&r.createElement(r.Fragment,null,r.createElement(i.a,{type:"primary",onClick:n.onSearch},"查询"),r.createElement(i.a,{onClick:n.onReset},"重置")),n.collapseControl&&n.collapseControl.showMoreBtn&&r.createElement("span",{className:"common-list-serach-more"},r.createElement("a",{onClick:e.toggleCollapse},o?"更多":"收起"," ",r.createElement(v.a,{type:o?"down":"up"})))))},e.renderWidgets=function(t){var n=e.state.collapse,a=e.props.config.searcher;return t&&r.createElement("div",{className:"common-list-search-left"},t.map(function(t,o){return Array.isArray(t)?r.createElement("div",{key:o,className:"common-list-search-row",style:{display:a.collapseControl&&a.collapseControl.showMoreBtn&&n&&o>0?"none":"flex"}},t.map(function(t){return r.createElement("div",{key:t.label,className:"common-list-search-col",style:Object.assign({},t.style)},T[t.type]&&T[t.type](t,t.children?e.renderWidgets(t.children):null))})):r.createElement("div",{key:t.label,className:"common-list-search-row ".concat(t.className)},T[t.type]&&T[t.type](t,t.children?e.renderWidgets(t.children):null))}))},e.renderAddBtn=function(){var t=e.props.config,n=t.addBtn,a=t.searcher;return n&&r.createElement("section",{className:"common-list-addbtn",style:n.style},"function"==typeof n.title?r.createElement(n.title,null):n.title,r.createElement("div",{className:"common-list-search-batch"},a.batchControl.showBatchControl&&r.createElement(s.a,{placeholder:a.batchControl.placeholder,style:{minWidth:120},defaultValue:void 0,onChange:a.batchControl.onBatch},a.batchControl.options.map(function(e){return r.createElement(D,{key:e.value,value:e.value},e.title)}))))},e.renderTableHeader=function(){var t=e.props.config.tableHeader;return r.createElement("section",{className:"common-list-table-header"},t&&t())},e.renderTable=function(){var t=e.props.config.table,n=t.rowKey,a=t.rowSelection,o=t.columns,i=t.dataSource,c=t.pagination,s=t.onChange,l=t.loading,u=t.locale;return r.createElement("section",{className:"common-list-table"},r.createElement(d.a,{locale:u,rowKey:n||"id",rowSelection:a,columns:o,dataSource:i,loading:l,pagination:c,onChange:s}))},e.renderCards=function(){var t=e.props.config.cards,n=t.dataSource,a=t.loading,o=t.pagination,i=t.renderCard,c=t.addBtn;return r.createElement("div",{className:"common-list-cards-wrapper"},r.createElement("ul",{className:"common-list-cards"},a?r.createElement("div",{className:"common-list-cards-loading"},r.createElement(w.a,null)):r.createElement(r.Fragment,null,r.createElement("li",{className:"common-list-card add-btn"},r.createElement("div",{className:"common-list-card-item",onClick:c.onAddBtnClick},c.icon?r.createElement("img",{src:c.icon,alt:""}):r.createElement(v.a,{type:"plus-circle"}),r.createElement("p",null,c.title))),n.map(function(e){return r.createElement("li",{className:"common-list-card"},r.createElement("div",{className:"common-list-card-item"},i(e)))}))),r.createElement("section",{className:"common-list-cards-pagination"},r.createElement(E.a,Object.assign({},o))))},e}var n,o,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&L(e,t)}(t,a["a"]),n=t,(o=[{key:"render",value:function(){var e=this.props.config;return r.createElement("div",{className:"common-list"},this.renderSearcher(),this.renderAddBtn(),this.renderTableHeader(),e.table&&this.renderTable(),e.cards&&this.renderCards())}}])&&P(n.prototype,o),c&&P(n,c),t}()},1420:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1),a=n(1375),o=n.n(a),i=(n(1374),n(11));n(1421);function c(e){var t=i.a.getPageBreadcrumb(e.location.pathname),n=e.title,a=e.links,c=e.tabs,s=e.currentTab;return r.createElement("div",{className:"common-header"},r.createElement("section",{className:"common-header-breadcrumb"},t&&r.createElement(o.a,null,t.map(function(e,t){return r.createElement(o.a.Item,{key:t},e.title)}))),r.createElement("section",{className:"common-header-title"},r.createElement("h2",null,n),r.createElement("div",{className:"common-header-links"},a&&a.map(function(t,n){return r.createElement("a",{key:n,onClick:function(){e.history.push(t.path)}},t.title)}))),r.createElement("section",{className:"common-header-tabs"},c&&c.map(function(t,n){return r.createElement("a",{onClick:function(){e.onTabClick(t.id)},className:"".concat(s===t.id?"tab-active":""," ")},r.createElement("span",null,t.title),t.tipComponent&&t.tipComponent())})))}},1421:function(e,t,n){},1422:function(e,t,n){},1423:function(e,t,n){"use strict";var r=function(e){var t=e;return 15===e.length&&(t=function(e){if(/^\d{15}$/.test(e)){e=e.substr(0,6)+"19"+e.substr(6,e.length-6);for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=0,r=0;r<e.length;r++)n+=parseInt(e.substr(r,1))*t[r];return e+["1","0","X","9","8","7","6","5","4","3","2"][n%11]}return e}(e)),function(e){if(!/^\d{17}(\d|x)$/i.test(e))return!1;return null!=={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙",21:"辽宁",22:"吉林",23:"黑龙",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",83:"台湾",91:"国外"}[parseInt(e.substr(0,2))]}(t)},a=function(e){return/^[HMhm]{1}([0-9]{8})$/.test(e)},o=function(e){return/^[0-9]{8}$/.test(e)||/^[0-9]{10}$/.test(e)},i=function(e){return/^[a-zA-Z]{5, 17}$/.test(e)||/^[a-zA-Z0-9]$/.test(e)},c=n(11);function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return u});var l={isNonEmpty:function(e,t,n){if(0!==e&&c.a.isEmpty(e))return n&&n(),t},maxLength:function(e,t,n,r){if(e.length>t)return r&&r(),n},minLength:function(e,t,n,r){if(e.length<t)return r&&r(),n},isEmail:function(e,t,n){if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e))return n&&n(),t},isMobile:function(e,t,n){if(!/^(13[0-9]|14[57]|15[012356789]|16[0-9]|18[0-9]|17[0-9]|19[0-9])\d{8}$/.test(e))return n&&n(),t},isID:function(e,t,n,c){var s=null;if("id"===t?s=r:"HKMC"===t?s=a:"TW"===t?s=o:"PSPort"===t&&(s=i),!s(e))return c&&c(),n},isNumber:function(e,t,n){if(e&&Number.isNaN(Number(e)))return n&&n(),t},isHexColor:function(e,t,n){var r=e.toString();if(!r||!function(e){if("#"!==e[0])return!1;var t=e.slice(1);return 6===t.length&&/^[0-9a-fA-f]{6}$/.test(t)}(r))return n&&n(),t},customReg:function(e,t,n,r){var a=e.toString();if(!a||!new RegExp(t).test(a))return r&&r(),n}},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=[]}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){var n=this,r=!0,a=!1,o=void 0;try{for(var i,c=function(){var t=i.value,r=t.strategy.split(":");n.cache.push(function(){var n=r.shift();return r.unshift(e),r.push(t.errMsg),r.push(t.cb),l[n].apply(null,r)})},s=t[Symbol.iterator]();!(r=(i=s.next()).done);r=!0)c()}catch(e){a=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(a)throw o}}}},{key:"start",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.cache[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=(0,r.value)();if(o)return o}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}}])&&s(t.prototype,n),r&&s(t,r),e}()},1484:function(e,t,n){},1485:function(e,t,n){},1522:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(1),o=n(109),i=n(200),c=n(120),s=n(72),l=n.n(s),u=(n(249),n(1369)),m=n.n(u),d=(n(1368),n(1484),n(110)),p=n(1420),f=n(1419),h=n(146),g=n.n(h),b=(n(167),n(23)),v=n.n(b),y=(n(351),n(250),n(11));function E(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,a=!1,o=void 0;try{for(var i,c=e[Symbol.iterator]();!(r=(i=c.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}var S=function(e){var t={selectedRowKeys:e.state.selectedRowKeys,onChange:function(t,n){e.setState({selectedRowKeys:t})}},n=[{title:"排序",dataIndex:"ranking"},{width:120,title:"跑鞋 ID",dataIndex:"shoeId",sorter:!0},{width:120,title:"配图",dataIndex:"coverImg",render:function(e,t){return e&&a.createElement("div",{style:{backgroundColor:"#e8e8e8",border:"1px solid rgba(232, 232, 232, 1)",width:60,height:60}},a.createElement("img",{src:e,style:{objectFit:"contain"}}))}},{title:"跑鞋商品名称",render:function(e,t){return"".concat(t.brandName," ").concat(t.shoeName)}},{title:"官方售价",render:function(e,t){return"￥ ".concat(y.a.parsePrice(t.price))}},{title:"渠道",render:function(e,t){return y.a.isEmpty(t.shoeSalecanalRelList)?"--":t.shoeSalecanalRelList.map(function(e){return a.createElement("p",{style:{marginBottom:10}},e.canalName)})}},{title:"优惠券",render:function(e,t){return y.a.isEmpty(t.shoeSalecanalRelList)?"--":t.shoeSalecanalRelList.map(function(e){return a.createElement("p",{style:{marginBottom:10}},"￥ ".concat(y.a.parsePrice(e.discountPrice)))})}},{title:"链接状态",render:function(e,t){return"--"}},{title:"点击量",dataIndex:"clickNum",render:function(e,t){return y.a.isEmpty(t.shoeSalecanalRelList)?"--":t.shoeSalecanalRelList.map(function(e){return a.createElement("p",{style:{marginBottom:10}},e.clickCount)})}},{width:120,title:"操作",render:function(t,n){return a.createElement("div",{className:"common-list-table-operation"},a.createElement("span",{onClick:function(){return e.goToEditor(n)}},"编辑"),a.createElement("span",{className:"common-list-table-operation-spliter"}),a.createElement("span",{onClick:function(){return e.deleteRecord(n.shoeSaleId)}},"删除"))}}],r=Object.assign({},e.props.common.paginationConfig,{total:e.props.shoe.distributionListMeta.total,current:e.state.currentPage,onChange:function(e,t){},onShowSizeChange:function(t,n){e.resetPagination(n,t)}});return{addBtn:{title:function(){return a.createElement(g.a,{type:"primary",onClick:function(){return e.goToEditor({})}},a.createElement(v.a,{type:"plus"})," 添加")}},searcher:{batchControl:{placeholder:"请选择",showBatchControl:!y.a.isEmpty(e.state.selectedRowKeys),options:[{title:"删除",value:"delete"}],onBatch:function(t){e.onBatch(t)}},widgets:[{type:"SelectInput",label:"跑鞋",placeholder:"请输入跑鞋 ID 或跑鞋型号",options:[{title:"跑鞋 ID",value:"shoeId"},{title:"跑鞋型号",value:"shoeName"}],inputValue:e.state.shoeValue,selectValue:e.state.shoeField,onSelectChange:function(t){e.setShoeField(t)},onInputChange:function(t){e.setShoeValue(t.target.value)},onPressEnter:function(t){e.onSearch()}}],onSearch:function(){e.onSearch()},onReset:function(){e.onReset()}},table:{rowKey:"shoeSaleId",rowSelection:t,columns:n,dataSource:e.props.shoe.distributionList,pagination:r,onChange:function(t,n,r){var a={pageNum:t.current,pageSize:t.pageSize};if(!y.a.isEmpty(n))for(var o=0,i=Object.entries(n);o<i.length;o++){var c=E(i[o],2),s=c[0],l=c[1];a[s]=l?l[0]:void 0}y.a.isEmpty(r)?(delete a.orderBy,delete a.sort):(a.orderBy="".concat(r.field),a.sort="".concat("descend"===r.order?"desc":"asc")),e.setState({filter:Object.assign({},e.state.filter,a),currentPage:t.current},function(){e.getDataList(e.state.filter)})}}}},w=n(352),C=n.n(w),N=(n(248),n(1373)),k=n.n(N),O=(n(1372),n(353)),R=n.n(O),I=(n(578),n(1379)),P=n.n(I),j=(n(1378),n(580)),x=n.n(j),L=(n(579),n(202)),D=n.n(L),$=(n(355),n(1485),n(1423)),B=n(585),F=n.n(B),T=n(1382),_=n.n(T),V=n(147),z=n.n(V),M=n(87),A=n.n(M);function H(e){return(H="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function K(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function W(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function Z(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function q(e,t){return(q=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var G=k.a.Item,J=(C.a.Group,R.a.Option),X=function(e,t,n){return{labelCol:{span:e,offset:n},wrapperCol:{span:t}}},Q=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=U(t).apply(this,arguments),(e=!o||"object"!==H(o)&&"function"!=typeof o?Z(n):o).$selectRef=null,e.state={shoeOptions:[],shoeOptionsMeta:{total:0,pageNum:1,pageSize:20},selectVisible:!1,channelOptions:[]},e.onSubmit=function(){var t=e.props.shoe,n=t.currentDistribution,r=t.setCurrentDistribution,a=!(y.a.isEmpty(n)||!n.shoeSaleId),o={ranking:n.ranking||0,shoeId:n.shoeId,shoeSalecanalRelList:A()(n.shoeSalecanalRelList).map(function(e){return e.id&&e.id.toString().indexOf("add")>=0&&delete e.id,e})},i=e.getValidation(o);if(i)return e.$msg.warn(i);a&&(o.shoeSaleId=n.shoeSaleId),e.$api.shoe.updateDistribution(o).then(function(t){0==t.data.ret?(a?e.$msg.success("渠道编辑成功"):e.$msg.success("渠道添加成功"),r({},!0),e.onCancel(),setTimeout(function(){e.props.getDataList()},300)):e.$msg.error(t.data.msg)})},e.getValidation=function(e){var t=new $.a;(t.add(e.shoeId,[{strategy:"isNonEmpty",errMsg:"请选择跑鞋"}]),y.a.isEmpty(e.shoeSalecanalRelList))||e.shoeSalecanalRelList.filter(function(e){return 1!=e.delFlag}).forEach(function(e,n){t.add(e.canalId,[{strategy:"isNonEmpty",errMsg:"第 ".concat(n+1," 个渠道不能为空")}]),t.add(e.canalPrice,[{strategy:"isNonEmpty",errMsg:"第 ".concat(n+1," 个官方售价不能为空")}]),t.add(e.canalUrl,[{strategy:"isNonEmpty",errMsg:"第 ".concat(n+1," 个商品链接不能为空")}]),e.discountPrice&&t.add(e.discountUrl,[{strategy:"isNonEmpty",errMsg:"第 ".concat(n+1," 个优惠券链接不能为空")}]),e.discountUrl&&t.add(e.discountPrice,[{strategy:"isNonEmpty",errMsg:"第 ".concat(n+1," 个优惠券价格不能为空")}])});return t.start()},e.onShoeSearch=z()(function(t){return r.a(Z(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.shoe.getSkuList({shoeName:t,pageNum:1,pageSize:10});case 2:n=e.sent,this.setState({shoeOptions:n.data.data.list||[]});case 4:case"end":return e.stop()}},e,this)}))},500),e.onShoeSelect=function(t,n){var r=n.props.$data;e.props.shoe.setCurrentDistribution({shoeId:t,shoeName:r.shoeName,brandName:r.brandName,coverImg:r.coverImg},!1),e.setState({selectVisible:!1})},e.onShoeBlur=function(){e.setState({selectVisible:!1})},e.onCancel=function(){e.props.shoe.setCurrentDistribution({},!0),e.props.form.resetFields(),e.props.shoe.toggleDistributionVisible()},e.renderChannels=function(){var t=e.props.shoe,n=t.currentDistribution,o=t.setCurrentDistribution,i=(e.props.form.getFieldDecorator,e.state.channelOptions),c=!y.a.isEmpty(n)&&!y.a.isEmpty(n.shoeSalecanalRelList)&&n.shoeSalecanalRelList||[];return c=A()(c),a.createElement(a.Fragment,null,c.map(function(t){return a.createElement("section",{className:"shoe-distribution-channel",key:t.id,style:{display:1==t.delFlag?"none":"block"}},a.createElement("div",{style:{borderBottom:"2px dashed rgba(0, 0, 0, 0.06)",marginBottom:20}}),a.createElement(G,Object.assign({label:"渠道",className:"channel-select"},X(6,14),{required:!0}),a.createElement(R.a,{value:t&&t.canalId&&t.canalId.toString(),allowClear:!0,style:{minWidth:258},getPopupContainer:function(){return document.getElementsByClassName("channel-select")[0]},showSearch:!0,placeholder:"请选择渠道",filterOption:!1,onFocus:function(){return r.a(Z(e),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))},onPopupScroll:function(){},onSearch:function(){},onChange:function(n,r){var a=y.a.isEmpty(r)?null:r.props.$data;c.forEach(function(e){});for(var i=0,s=Object.values(c);i<s.length;i++){if(s[i].canalId===a.canalId)return e.$msg.warn("渠道已存在")}var l=c.map(function(e){return e.id==t.id&&(e.canalId=a.canalId),e});o({shoeSalecanalRelList:l},!1)}},i.map(function(e){return a.createElement(J,{key:e.canalId,$data:e},e.canalName)}))),a.createElement(G,Object.assign({label:"官方售价"},X(6,14),{required:!0}),a.createElement(P.a,{value:t&&t.canalPrice&&y.a.parsePrice(t.canalPrice),min:0,style:{width:"100%"},formatter:function(e){return"￥ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\￥\s?|(,*)/g,"")},onChange:function(e){var n=c.map(function(n){return n.id==t.id&&(n.canalPrice=100*e),n});o({shoeSalecanalRelList:n},!1)}})),a.createElement(G,Object.assign({label:"商品链接"},X(6,14),{required:!0}),a.createElement(C.a,{value:t&&t.canalUrl,placeholder:"请输入商品链接",onChange:function(e){var n=c.map(function(n){return n.id==t.id&&(n.canalUrl=e.target.value),n});o({shoeSalecanalRelList:n},!1)}})),a.createElement(G,Object.assign({label:"优惠券价格"},X(6,14)),a.createElement(P.a,{value:t&&t.discountPrice&&y.a.parsePrice(t.discountPrice),min:0,style:{width:"100%"},formatter:function(e){return"￥ ".concat(e).replace(/\B(?=(\d{3})+(?!\d))/g,",")},parser:function(e){return e.replace(/\￥\s?|(,*)/g,"")},onChange:function(e){var n=c.map(function(n){return n.id==t.id&&(n.discountPrice=100*e),n});o({shoeSalecanalRelList:n},!1)}})),a.createElement(G,Object.assign({label:"优惠券链接"},X(6,14)),a.createElement(C.a,{value:t&&t.discountUrl,placeholder:"请输入优惠券链接",onChange:function(e){var n=c.map(function(n){return n.id==t.id&&(n.discountUrl=e.target.value),n});o({shoeSalecanalRelList:n},!1)}})),a.createElement(G,Object.assign({label:"返点"},X(6,14)),a.createElement(C.a,{value:t&&t.returnPoint,placeholder:"请输入返点值",onChange:function(e){var n=c.map(function(n){return n.id==t.id&&(n.returnPoint=e.target.value),n});o({shoeSalecanalRelList:n},!1)}})),a.createElement(G,{className:"shoe-distribution-channel-close"},a.createElement("div",{onClick:function(){var e=y.a.isEmpty(n.shoeSalecanalRelList)?[]:A()(n.shoeSalecanalRelList);e=n.shoeSaleId?e.map(function(e){return e.id===t.id&&(e.delFlag=1),e}):e.filter(function(e){return e.id!=t.id}),o({shoeSalecanalRelList:e},!1)}},a.createElement(v.a,{type:"close-circle"}))))}))},e.handleClose=function(t){e.props.shoe.setCurrentDistribution({shoeId:void 0,brandName:void 0,shoeName:void 0},!1)},e.renderEditor=function(){e.props.form.getFieldDecorator;var t=e.props.shoe,n=t.setCurrentDistribution,o=t.currentDistribution,i=(t.channelOptions,e.state),c=i.selectVisible,s=i.shoeOptions,l="".concat(o.brandName,"-").concat(o.shoeName),u=l&&l.length>20,m=a.createElement(x.a,{key:o.shoeId,closable:!0,onClose:function(){return e.handleClose(o.shoeId)}},u?"".concat(l.slice(0,20),"..."):l);return a.createElement(k.a,{className:"editor-form"},a.createElement(G,{required:!0},!o.shoeSaleId&&a.createElement("div",{className:"editor-specific-shoe"},a.createElement("span",null,"选择跑鞋："),o.shoeId&&(u?a.createElement(D.a,{title:l,key:o.shoeId},m):m),c&&a.createElement(R.a,{style:{width:220},ref:function(t){return e.$selectRef=t},showSearch:!0,placeholder:"请输入跑鞋型号",filterOption:!1,onFocus:function(){return r.a(Z(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.shoe.getSkuList({pageNum:1,pageSize:20});case 2:t=e.sent,this.setState({shoeOptions:t.data.data.list,shoeOptionsMeta:{total:t.data.data.total,pageNum:t.data.data.pageNum,pageSize:t.data.data.pageSize}});case 4:case"end":return e.stop()}},e,this)}))},onPopupScroll:F()(function(t){return r.a(Z(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n,r,a,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state,r=n.shoeOptions,a=n.shoeOptionsMeta,!(!(!t||!t.target)&&t.target.scrollHeight-(t.target.scrollTop+t.target.clientHeight)<=10&&a.total>r.length)){e.next=7;break}return e.next=5,this.$api.shoe.getSkuList({pageNum:a.pageNum+1,pageSize:20});case 5:o=e.sent,this.setState({shoeOptions:_()(this.state.shoeOptions,o.data.data.list,"shoeId"),shoeOptionsMeta:{total:o.data.data.total,pageNum:o.data.data.pageNum,pageSize:o.data.data.pageSize}});case 7:case"end":return e.stop()}},e,this)}))},300),onSearch:e.onShoeSearch,onSelect:e.onShoeSelect,onBlur:e.onShoeBlur},s.map(function(e){return a.createElement(J,{key:e.shoeId,value:e.shoeId,$data:e},"".concat(e.brandName,"-").concat(e.shoeName))})),!c&&(y.a.isEmpty(o)||!o.id)&&!o.shoeId&&a.createElement(x.a,{style:{background:"#fff",borderStyle:"dashed"},onClick:function(){e.setState({selectVisible:!0},function(){return e.$selectRef.focus()})}},a.createElement(v.a,{type:"plus"}),"添加")),!y.a.isEmpty(o)&&o.shoeId&&a.createElement("div",{className:"shoe-distribution-shoeInfo"},a.createElement("span",null,a.createElement("p",null,"商品名称：",l),a.createElement("p",null,"ID：",o.shoeId)),a.createElement("span",{className:"cover-img"},a.createElement("img",{src:o.coverImg})))),e.renderChannels(),a.createElement(G,Object.assign({},X(6,18)),a.createElement("a",{style:{color:"#1890ff"},onClick:function(){n({shoeSalecanalRelList:y.a.isEmpty(o)||y.a.isEmpty(o.shoeSalecanalRelList)?[{id:"add-"+y.a.randomNum(1,1e5),delFlag:0}]:[].concat(K(o.shoeSalecanalRelList),[{id:"add-"+y.a.randomNum(1,1e5),delFlag:0}])},!1)}},"+ 新增渠道")))},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&q(e,t)}(t,o["a"]),n=t,(i=[{key:"componentWillMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.shoe.getChannelList({pageSize:100,pageNum:1});case 2:t=e.sent,this.setState({channelOptions:t.data.data.list});case 4:case"end":return e.stop()}},e,this)}))}},{key:"render",value:function(){var e=this.props.shoe,t=e.distributionVisible,n=e.currentDistribution;return a.createElement(m.a,{className:"shoe-distribution-editor-modal",visible:t,title:!y.a.isEmpty(n)&&n.shoeSaleId?"编辑渠道":"添加渠道",onOk:this.onSubmit,onCancel:this.onCancel},this.renderEditor())}}])&&W(n.prototype,i),c&&W(n,c),t}(),Y=Q=r.b([k.a.create(),Object(d.b)("common","community","shoe"),d.c],Q);function ee(e){return(ee="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ne(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function re(e){return(re=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ae(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function oe(e,t){return(oe=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ie=m.a.confirm,ce=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=re(t).apply(this,arguments),(e=!o||"object"!==ee(o)&&"function"!=typeof o?ae(n):o).state={shoeField:"shoeId",shoeValue:void 0,tableLoading:!1,currentPage:1,selectedRowKeys:[]},e.getDataList=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.setState({tableLoading:!0,filter:Object.assign({},e.state.filter,t)},function(){return r.a(ae(e),void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$store.shoe.getDistributionList(Object.assign({},this.state.filter,t));case 2:this.setState({tableLoading:!1});case 3:case"end":return e.stop()}},e,this)}))})},e.resetPagination=function(t,n){return r.a(ae(e),void 0,void 0,regeneratorRuntime.mark(function e(){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({filter:Object.assign({},this.state.filter,{pageSize:t,pageNum:n})},function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.state.filter,this.getDataList(t);case 2:case"end":return e.stop()}},e,this)}))});case 1:case"end":return e.stop()}},e,this)}))},e.onSearch=function(){return r.a(ae(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.state.filter).shoeId||!Number.isNaN(Number(t.shoeId))){e.next=3;break}return e.abrupt("return",this.$msg.error("请输入正确 shoeId"));case 3:this.setState({filter:Object.assign({},t,{pageNum:1}),currentPage:1},function(){n.getDataList(n.state.filter)});case 4:case"end":return e.stop()}},e,this)}))},e.onReset=function(){return r.a(ae(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t={pageNum:1,pageSize:this.state.filter.pageSize},this.setState({shoeValue:void 0,filter:t,currentPage:1},function(){n.getDataList(n.state.filter)});case 2:case"end":return e.stop()}},e,this)}))},e.goToEditor=function(t){e.props.shoe.toggleDistributionVisible(),e.props.shoe.setCurrentDistribution(t,!0,!1)},e.renderMenu=function(t){var n=a.createElement("span",{onClick:e.deleteRecord.bind(ae(e),t.shoeId)},"删除"),r={1:[n],0:[n]};return r[t.isStarting]&&a.createElement(l.a,null,r[t.isStarting].map(function(e){return a.createElement(l.a.Item,null,e)}))},e.deleteRecord=function(t){return r.a(ae(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:ie({title:"跑鞋渠道删除操作",content:a.createElement("span",null,"请问是否确定删除当前选中的跑鞋渠道"),onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=null,!(t instanceof Array)){e.next=7;break}return e.next=4,this.$api.shoe.deleteDistribution({ids:t});case 4:n=e.sent,e.next=10;break;case 7:return e.next=9,this.$api.shoe.deleteDistribution({ids:[t]});case 9:n=e.sent;case 10:0==n.data.ret?(this.$msg.success("跑鞋渠道删除成功"),this.getDataList()):this.$msg.error(n.data.msg);case 11:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}});case 1:case"end":return e.stop()}},e)}))},e.setShoeField=function(t){var n=e.state.filter;"shoeId"!==t?delete n.shoeId:"shoeName"!==t&&delete n.shoeName,e.setState({shoeField:t,shoeValue:void 0,filter:Object.assign({},n,te({},t,void 0))})},e.setShoeValue=function(t){e.setState({shoeValue:t,filter:Object.assign({},e.state.filter,te({},e.state.shoeField,t||void 0))})},e.onBatch=function(t){return r.a(ae(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.state.selectedRowKeys,!t||!y.a.isEmpty(n)){e.next=3;break}return e.abrupt("return",this.$msg.warning("请选择至少一条记录"));case 3:"delete"===t&&this.deleteRecord(n);case 4:case"end":return e.stop()}},e,this)}))},e}var n,i,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&oe(e,t)}(t,o["a"]),n=t,(i=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.common.paginationConfig,n=t.defaultPageSize,r=t.defaultCurrent,this.resetPagination(n,r);case 2:case"end":return e.stop()}},e,this)}))}},{key:"componentDidUpdate",value:function(){"/admin/shoe/distribution/shoe-distribution"===this.props.location.pathname&&this.props.history.replace("/admin/shoe/distribution/shoe-distribution/list")}},{key:"render",value:function(){var e=this,t=this.props.match;return a.createElement("div",null,a.createElement(p.a,Object.assign({},this.props,{links:[],title:"跑鞋分销（推荐商品）"})),a.createElement(c.a,{path:"".concat(t.url,"/list"),render:function(t){return a.createElement(f.a,Object.assign({},t,{config:S(e)}))}}),a.createElement(Y,{getDataList:function(){e.getDataList()}}))}}])&&ne(n.prototype,i),s&&ne(n,s),t}();ce=r.b([Object(i.a)("/admin/shoe/distribution/shoe-distribution",{exact:!1}),Object(d.b)("common","shoe"),d.c],ce);t.default=ce}}]);