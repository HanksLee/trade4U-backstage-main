(window.webpackJsonp=window.webpackJsonp||[]).push([[25],{1419:function(e,t,n){"use strict";n.d(t,"a",function(){return L});var r=n(1),a=n(109),o=(n(1422),n(146)),i=n.n(o),s=(n(167),n(353)),l=n.n(s),c=(n(578),n(352)),u=n.n(c),m=(n(248),n(1377)),p=n.n(m),d=(n(1376),n(1371)),f=n.n(d),h=(n(1370),n(168)),g=n.n(h),v=(n(354),n(23)),b=n.n(v),y=(n(351),n(582)),k=n.n(y),E=(n(581),n(584)),w=n.n(E),S=(n(583),n(580)),C=n.n(S),N=(n(579),n(11)),R=n(16),x=n.n(R);function O(e){return(O="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function I(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function T(e,t){return!t||"object"!==O(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e,t){return(V=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var j=l.a.Option,P=u.a.Group,U=f.a.RangePicker,Y=C.a.CheckableTag,D={SelectInput:function(e){var t=e.selectValue,n=e.inputValue,a=e.placeholder,o=e.options,i=e.onSelectChange,s=e.onInputChange,c=e.onPressEnter,m=e.selectStyle;return r.createElement(P,{compact:!0},r.createElement(l.a,{style:m?Object.assign({width:110},m):{width:110},value:t,onChange:i},o&&o.map(function(e,t){return r.createElement(j,{key:t,value:e.value},e.title)})),r.createElement(u.a,{style:{width:238},value:n,onChange:s,placeholder:a,onPressEnter:c}))},Select:function(e){var t=e.option,n=e.label,a=e.mode,o=e.onSearch,i=e.onSelect,s=e.onBlur,c=e.onFocus,u=e.value,m=e.placeholder,p=e.showSearch,d=e.width,f=e.filterOption,h=e.onChange,g=e.allowClear,v=e.onPopupScroll;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(l.a,{allowClear:g,value:u,mode:a||!1,style:{minWidth:d||258,width:d},showSearch:p,placeholder:m,filterOption:f,onSearch:o,onSelect:i,onChange:h,onBlur:s,onPopupScroll:v,onFocus:c},t.data.map(function(e){return r.createElement(j,{key:e[t.key]||e.id,value:e[t.value]||e.id,$data:e},e[t.title])}))))},DatePicker:function(e){var t=e.label,n=e.placeholder,a=e.onChange,o=e.value,i=e.style,s=e.format,l=e.showTime;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(f.a,{format:s||!1,style:i,showTime:l,placeholder:n,value:o,onChange:a})))},RangePicker:function(e){var t=e.label,n=e.alias,a=e.placeholder,o=e.onChange,s=e.value,l=e.showTime,c=e.format;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(U,{style:{width:400},showTime:l,format:c,placeholder:a,value:s,onChange:o}),r.createElement("span",{className:"common-list-control-date-alias"},!N.a.isEmpty(n)&&n.map(function(e,t){return r.createElement(i.a,{key:t,onClick:function(){return o([x()(Date.now()-864e5*e).startOf("day"),x()()])}},e," 天内")}))))},Input:function(e){var t=e.label,n=e.value,a=e.placeholder,o=e.onChange,i=e.width,s=e.onPressEnter;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},r.createElement(u.a,{style:{minWidth:i||258},value:n,onChange:o,placeholder:a,onPressEnter:s})))},Checkbox:function(e){var t=e.label,n=e.value,a=e.onChange;return r.createElement(g.a,{checked:n,onChange:a},t)},CheckableTag:function(e){var t=e.label,n=e.option,a=e.value,o=e.onChange;return r.createElement(r.Fragment,null,t&&r.createElement("span",{className:"common-list-label"},"".concat(t,"：")),r.createElement("span",{className:"common-list-control"},!N.a.isEmpty(n)&&n.map(function(e){return r.createElement(Y,{key:e.value,checked:e.value===a,onChange:function(){o(e)}},e.title)})))},Label:function(e,t){var n=e.label;return r.createElement(r.Fragment,null,n&&r.createElement("span",{className:"common-list-label"},"".concat(n,"：")),r.createElement("span",{className:"common-list-control"},t))},Custom:function(e){return r.createElement("div",null,(void 0).props.children)}},L=function(e){function t(){var e;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),(e=T(this,M(t).apply(this,arguments))).state={collapse:!0},e.toggleCollapse=function(t){e.setState({collapse:!e.state.collapse})},e.renderSearcher=function(){var t=e.props.config,n=t.searcher,a=t.table,o=e.state.collapse;return n&&r.createElement("section",{className:"common-list-search"},e.renderWidgets(n.widgets),a&&a.tableHeader&&a.tableHeader(),r.createElement("div",{className:"common-list-search-right"},!n.hideSearcher&&r.createElement(r.Fragment,null,r.createElement(i.a,{type:"primary",onClick:n.onSearch},"查询"),r.createElement(i.a,{onClick:n.onReset},"重置")),n.collapseControl&&n.collapseControl.showMoreBtn&&r.createElement("span",{className:"common-list-serach-more"},r.createElement("a",{onClick:e.toggleCollapse},o?"更多":"收起"," ",r.createElement(b.a,{type:o?"down":"up"})))))},e.renderWidgets=function(t){var n=e.state.collapse,a=e.props.config.searcher;return t&&r.createElement("div",{className:"common-list-search-left"},t.map(function(t,o){return Array.isArray(t)?r.createElement("div",{key:o,className:"common-list-search-row",style:{display:a.collapseControl&&a.collapseControl.showMoreBtn&&n&&o>0?"none":"flex"}},t.map(function(t){return r.createElement("div",{key:t.label,className:"common-list-search-col",style:Object.assign({},t.style)},D[t.type]&&D[t.type](t,t.children?e.renderWidgets(t.children):null))})):r.createElement("div",{key:t.label,className:"common-list-search-row ".concat(t.className)},D[t.type]&&D[t.type](t,t.children?e.renderWidgets(t.children):null))}))},e.renderAddBtn=function(){var t=e.props.config,n=t.addBtn,a=t.searcher;return n&&r.createElement("section",{className:"common-list-addbtn",style:n.style},"function"==typeof n.title?r.createElement(n.title,null):n.title,r.createElement("div",{className:"common-list-search-batch"},a.batchControl.showBatchControl&&r.createElement(l.a,{placeholder:a.batchControl.placeholder,style:{minWidth:120},defaultValue:void 0,onChange:a.batchControl.onBatch},a.batchControl.options.map(function(e){return r.createElement(j,{key:e.value,value:e.value},e.title)}))))},e.renderTableHeader=function(){var t=e.props.config.tableHeader;return r.createElement("section",{className:"common-list-table-header"},t&&t())},e.renderTable=function(){var t=e.props.config.table,n=t.rowKey,a=t.rowSelection,o=t.columns,i=t.dataSource,s=t.pagination,l=t.onChange,c=t.loading,u=t.locale;return r.createElement("section",{className:"common-list-table"},r.createElement(p.a,{locale:u,rowKey:n||"id",rowSelection:a,columns:o,dataSource:i,loading:c,pagination:s,onChange:l}))},e.renderCards=function(){var t=e.props.config.cards,n=t.dataSource,a=t.loading,o=t.pagination,i=t.renderCard,s=t.addBtn;return r.createElement("div",{className:"common-list-cards-wrapper"},r.createElement("ul",{className:"common-list-cards"},a?r.createElement("div",{className:"common-list-cards-loading"},r.createElement(w.a,null)):r.createElement(r.Fragment,null,r.createElement("li",{className:"common-list-card add-btn"},r.createElement("div",{className:"common-list-card-item",onClick:s.onAddBtnClick},s.icon?r.createElement("img",{src:s.icon,alt:""}):r.createElement(b.a,{type:"plus-circle"}),r.createElement("p",null,s.title))),n.map(function(e){return r.createElement("li",{className:"common-list-card"},r.createElement("div",{className:"common-list-card-item"},i(e)))}))),r.createElement("section",{className:"common-list-cards-pagination"},r.createElement(k.a,Object.assign({},o))))},e}var n,o,s;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&V(e,t)}(t,a["a"]),n=t,(o=[{key:"render",value:function(){var e=this.props.config;return r.createElement("div",{className:"common-list"},this.renderSearcher(),this.renderAddBtn(),this.renderTableHeader(),e.table&&this.renderTable(),e.cards&&this.renderCards())}}])&&I(n.prototype,o),s&&I(n,s),t}()},1420:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=n(1),a=n(1375),o=n.n(a),i=(n(1374),n(11));n(1421);function s(e){var t=i.a.getPageBreadcrumb(e.location.pathname),n=e.title,a=e.links,s=e.tabs,l=e.currentTab;return r.createElement("div",{className:"common-header"},r.createElement("section",{className:"common-header-breadcrumb"},t&&r.createElement(o.a,null,t.map(function(e,t){return r.createElement(o.a.Item,{key:t},e.title)}))),r.createElement("section",{className:"common-header-title"},r.createElement("h2",null,n),r.createElement("div",{className:"common-header-links"},a&&a.map(function(t,n){return r.createElement("a",{key:n,onClick:function(){e.history.push(t.path)}},t.title)}))),r.createElement("section",{className:"common-header-tabs"},s&&s.map(function(t,n){return r.createElement("a",{onClick:function(){e.onTabClick(t.id)},className:"".concat(l===t.id?"tab-active":""," ")},r.createElement("span",null,t.title),t.tipComponent&&t.tipComponent())})))}},1421:function(e,t,n){},1422:function(e,t,n){},1423:function(e,t,n){"use strict";var r=function(e){var t=e;return 15===e.length&&(t=function(e){if(/^\d{15}$/.test(e)){e=e.substr(0,6)+"19"+e.substr(6,e.length-6);for(var t=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2],n=0,r=0;r<e.length;r++)n+=parseInt(e.substr(r,1))*t[r];return e+["1","0","X","9","8","7","6","5","4","3","2"][n%11]}return e}(e)),function(e){if(!/^\d{17}(\d|x)$/i.test(e))return!1;return null!=={11:"北京",12:"天津",13:"河北",14:"山西",15:"内蒙",21:"辽宁",22:"吉林",23:"黑龙",31:"上海",32:"江苏",33:"浙江",34:"安徽",35:"福建",36:"江西",37:"山东",41:"河南",42:"湖北",43:"湖南",44:"广东",45:"广西",46:"海南",50:"重庆",51:"四川",52:"贵州",53:"云南",54:"西藏",61:"陕西",62:"甘肃",63:"青海",64:"宁夏",65:"新疆",71:"台湾",81:"香港",82:"澳门",83:"台湾",91:"国外"}[parseInt(e.substr(0,2))]}(t)},a=function(e){return/^[HMhm]{1}([0-9]{8})$/.test(e)},o=function(e){return/^[0-9]{8}$/.test(e)||/^[0-9]{10}$/.test(e)},i=function(e){return/^[a-zA-Z]{5, 17}$/.test(e)||/^[a-zA-Z0-9]$/.test(e)},s=n(11);function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.d(t,"a",function(){return u});var c={isNonEmpty:function(e,t,n){if(0!==e&&s.a.isEmpty(e))return n&&n(),t},maxLength:function(e,t,n,r){if(e.length>t)return r&&r(),n},minLength:function(e,t,n,r){if(e.length<t)return r&&r(),n},isEmail:function(e,t,n){if(!/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/.test(e))return n&&n(),t},isMobile:function(e,t,n){if(!/^(13[0-9]|14[57]|15[012356789]|16[0-9]|18[0-9]|17[0-9]|19[0-9])\d{8}$/.test(e))return n&&n(),t},isID:function(e,t,n,s){var l=null;if("id"===t?l=r:"HKMC"===t?l=a:"TW"===t?l=o:"PSPort"===t&&(l=i),!l(e))return s&&s(),n},isNumber:function(e,t,n){if(e&&Number.isNaN(Number(e)))return n&&n(),t},isHexColor:function(e,t,n){var r=e.toString();if(!r||!function(e){if("#"!==e[0])return!1;var t=e.slice(1);return 6===t.length&&/^[0-9a-fA-f]{6}$/.test(t)}(r))return n&&n(),t},customReg:function(e,t,n,r){var a=e.toString();if(!a||!new RegExp(t).test(a))return r&&r(),n}},u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cache=[]}var t,n,r;return t=e,(n=[{key:"add",value:function(e,t){var n=this,r=!0,a=!1,o=void 0;try{for(var i,s=function(){var t=i.value,r=t.strategy.split(":");n.cache.push(function(){var n=r.shift();return r.unshift(e),r.push(t.errMsg),r.push(t.cb),c[n].apply(null,r)})},l=t[Symbol.iterator]();!(r=(i=l.next()).done);r=!0)s()}catch(e){a=!0,o=e}finally{try{r||null==l.return||l.return()}finally{if(a)throw o}}}},{key:"start",value:function(){var e=!0,t=!1,n=void 0;try{for(var r,a=this.cache[Symbol.iterator]();!(e=(r=a.next()).done);e=!0){var o=(0,r.value)();if(o)return o}}catch(e){t=!0,n=e}finally{try{e||null==a.return||a.return()}finally{if(t)throw n}}}}])&&l(t.prototype,n),r&&l(t,r),e}()},1424:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(1);n(1425);function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return!t||"object"!==a(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function l(e,t){return(l=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var c={hot:"hot",normal:"normal",wait:"wait",block:"block"},u=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),i(this,s(t).apply(this,arguments))}var n,a,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&l(e,t)}(t,r["Component"]),n=t,(a=[{key:"render",value:function(){var e=this.props,t=e.text,n=e.type;return r.createElement("span",{className:"status-text ".concat(c[n])},r.createElement("span",{className:"status-text-dot ".concat(c[n])}),r.createElement("span",null,t))}}])&&o(n.prototype,a),u&&o(n,u),t}()},1425:function(e,t,n){},1488:function(e,t,n){},1533:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(1),o=n(109),i=n(200),s=n(120),l=n(1369),c=n.n(l),u=(n(1368),n(352)),m=n.n(u),p=(n(248),n(353)),d=n.n(p),f=(n(578),n(1381)),h=n.n(f),g=(n(1380),n(23)),v=n.n(g),b=(n(351),n(1373)),y=n.n(b),k=(n(1372),n(1371)),E=n.n(k),w=(n(1370),n(1488),n(110)),S=n(1420),C=n(1419),N=n(146),R=n.n(N),x=(n(167),n(1424)),O=n(11),I=function(e){var t={selectedRowKeys:e.state.selectedRowKeys,onChange:function(t,n){e.setState({selectedRowKeys:t})}},n=[{width:100,title:"ID",dataIndex:"pasterId"},{width:150,title:"贴纸",dataIndex:"pasterImgUlr",render:function(e,t){return a.createElement("img",{className:"sticker-img",src:t.pasterImgUlr,alt:""})}},{width:150,title:"名称",dataIndex:"pasterName"},{width:100,title:"排序",dataIndex:"pasterSort"},{width:120,title:"使用次数",dataIndex:"useNum",render:function(e,t){return a.createElement("span",null,t.useNum?t.useNum:0)}},{width:120,title:"状态",dataIndex:"status",render:function(e,t){return 1===t.status?a.createElement(x.a,{type:"normal",text:"上架中"}):a.createElement(x.a,{type:"block",text:"未上架"})}},{width:120,title:"备注",dataIndex:"pasterRemark"},{width:150,title:"操作",render:function(t,n){return a.createElement("div",{className:"common-list-table-operation"},a.createElement("span",{onClick:function(){return e.goToEditor(n)}},"编辑"),a.createElement("span",{className:"common-list-table-operation-spliter"}),a.createElement("span",{onClick:function(){return e.addOrEditUnlockCondition(n)}},"限制条件"),a.createElement("span",{className:"common-list-table-operation-spliter"}),a.createElement("span",{onClick:function(){return e.deleteStickerById(n.pasterId)}},"删除"))}}],r=Object.assign({},e.props.sticker.paginationConfig,{onChange:function(t,n){e.resetPagination(n,t)},onShowSizeChange:function(t,n){e.resetPagination(n,t)}});return{addBtn:{title:function(){return a.createElement(R.a,{type:"primary",onClick:function(){return e.goToEditor({})}},a.createElement(v.a,{type:"plus"})," 新建贴纸")}},searcher:{batchControl:{placeholder:"请选择",showBatchControl:!O.a.isEmpty(e.state.selectedRowKeys),options:[{title:"删除",value:"delete"}],onBatch:function(t){e.onBatch(t)}},widgets:[{type:"SelectInput",label:"贴纸",placeholder:"请输入贴纸 ID 或名称",options:[{title:"贴纸 ID",value:"pasterId"},{title:"贴纸名称",value:"pasterName"}],inputValue:e.state.SearchInputValue,selectValue:e.state.SearchSelectValue,onSelectChange:function(t){e.setSearchSelectValue(t)},onInputChange:function(t){e.setSearchInputValue(t.target.value)}},{type:"RangePicker",label:"创建起止日期",placeholder:["开始日期","结束日期"],showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",alias:[1,7,30],value:e.state.dateRange||[],onChange:function(t){e.onDateRangeChange(t)}}],onSearch:function(){e.onSearch()},onReset:function(){e.onReset()}},table:{rowKey:"pasterId",columns:n,dataSource:e.state.stickerlist,pagination:r,rowSelection:t,onChange:function(e,t,n){}}}},T=n(16),M=n.n(T),V=n(1423);function j(e){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function P(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function U(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function H(e,t){return(H=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var _=c.a.confirm,$=d.a.Option,A=m.a.TextArea,B=y.a.Item,F=E.a.RangePicker,K=m.a.Group,q={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:12}}},W={labelCol:{xs:{span:2},sm:{span:3}},wrapperCol:{xs:{span:24},sm:{span:20}}},z=[],Z=function(e){function t(){var e,n,o;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),n=this,o=D(t).apply(this,arguments),(e=!o||"object"!==j(o)&&"function"!=typeof o?L(n):o).state={selectedRowKeys:[],filter:{},SearchInputValue:void 0,SearchSelectValue:"pasterId",dateRange:[],modalVisible:!1,unlockModalVisible:!1,modalType:"",confirmLoading:!1,unlockConfirmLoading:!1,stickerlist:[],shelfDateRange:[]},e.resetPagination=function(t,n){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({filter:Object.assign({},this.state.filter,{limit:t,pageNum:n})},function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.state.filter,e.next=3,this.props.sticker.getStickerList(t);case 3:r=e.sent,this.props.sticker.setPaginationCurrent(n),this.setState({stickerlist:r});case 6:case"end":return e.stop()}},e,this)}))});case 1:case"end":return e.stop()}},e,this)}))},e.goToEditor=function(t){e.showModal(t)},e.addOrEditUnlockCondition=function(t){e.showUnlockModal(t)},e.onSearch=function(){e.setState({filter:Object.assign({},e.state.filter,{pageNum:1})},function(){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.sticker.getStickerList(this.state.filter);case 2:t=e.sent,this.props.sticker.setPaginationCurrent(1),this.setState({stickerlist:t});case 5:case"end":return e.stop()}},e,this)}))})},e.onReset=function(){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return delete(t=Object.assign({},this.state.filter,{pageNum:1})).pasterId,delete t.pasterName,delete t.startTime,delete t.endTime,this.props.sticker.setPaginationCurrent(1),e.next=8,this.props.sticker.getStickerList(t);case 8:n=e.sent,this.setState({stickerlist:n,filter:t,SearchInputValue:void 0,SearchSelectValue:"pasterId",dateRange:[]});case 10:case"end":return e.stop()}},e,this)}))},e.onBatch=function(t){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n=this.state.selectedRowKeys,"delete"===t&&_({title:"批量删除贴纸操作",content:"以下贴纸将会被删除，请问是否确认？",onOk:function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.join(","),e.next=3,this.props.sticker.batchDelete(t,this.state.filter);case 3:r=e.sent,this.setState({selectedRowKeys:[],stickerlist:r});case 5:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.setState({selectedRowKeys:[]});case 1:case"end":return e.stop()}},e,this)}))}});case 2:case"end":return e.stop()}},e,this)}))},e.setSearchSelectValue=function(t){var n,r=e.state.filter;"pasterId"!==t?(n=r.pasterId,delete r.pasterId):"pasterName"!==t&&(n=r.pasterName,delete r.pasterName),e.setState({SearchSelectValue:t,filter:Object.assign({},r,U({},t,n))})},e.setSearchInputValue=function(t){e.setState({SearchInputValue:t,filter:Object.assign({},e.state.filter,U({},e.state.SearchSelectValue,t||void 0))})},e.onDateRangeChange=function(t){e.setState({dateRange:t,filter:Object.assign({},e.state.filter,{startTime:t[0]?M()(t[0]).format("YYYY-MM-DD HH:mm:ss"):"",endTime:t[1]?M()(t[1]).format("YYYY-MM-DD HH:mm:ss"):""})})},e.renderAddOrEditModal=function(){var t=e.state,n=t.modalVisible,r=t.confirmLoading,o=t.modalType;return n&&a.createElement(c.a,{title:"add"===o?"新建贴纸":"编辑贴纸",visible:n,onOk:e.handleOk,confirmLoading:r,onCancel:e.handleCancel,okText:"保存",cancelText:"取消",width:700},e.renderModalContent("add"===o))},e.renderModalContent=function(t){var n=e.props.sticker,r=n.newSticker,o=n.currentNewSticker,i=e.props.form.getFieldDecorator,s=a.createElement("div",null,a.createElement(v.a,{type:"plus"}),a.createElement("div",{className:"ant-upload-text"},r.imgUrl&&r.imgUrl.length>0?"替换贴纸":"上传贴纸")),l=e.props.common.userInfo.empName;return a.createElement(y.a,Object.assign({className:"sticker-edit-modal sticker-custom-label-width"},q),a.createElement(B,{label:"创建人"},t?l:r.createUser),a.createElement(B,{label:"创建时间"},t?"创建后生成":M()(r.createTime).format("YYYY-MM-DD HH:mm:ss")),a.createElement(B,{label:"ID"},t?"创建后生成":r.pasterId),a.createElement(B,{label:"排序"},i("pasterSort",{initialValue:r&&r.pasterSort,rules:[{required:!0,message:"请输入排序"},{pattern:/^([1-9]{1}[0-9]{0,2})$/,message:"请输入1-999"}]})(a.createElement(m.a,{type:"number",style:{width:200},onChange:function(e){n.setNewSticker({pasterSort:e.target.value},!1)}}))),a.createElement(B,{label:"上下架时间"},i("shelfTime",{initialValue:r&&r.shelfTime,rules:[{required:!0,message:"请选择上下架时间"}]})(a.createElement(F,{style:{width:400},showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",placeholder:["开始日期","结束日期"],onChange:function(e){2===e.length&&n.setNewSticker({shelfTime:e,pasterShelvesTime:M()(e[0]).format("YYYY-MM-DD HH:mm:ss"),pasterUnderTime:M()(e[1]).format("YYYY-MM-DD HH:mm:ss")},!1)}}))),a.createElement(B,{className:"upload-line",label:"上传文件"},i("pasterImgUlr",{initialValue:r&&r.pasterImgUlr,rules:[{required:!0,message:"请上传图片"}]})(a.createElement("span",null,a.createElement(h.a,{className:"",accept:"image/png",customRequest:e.customRequest.bind(L(e)),listType:"picture-card",fileList:o&&o.imgUrl,onChange:e.handleUpload.bind(L(e))},s),a.createElement("span",{className:"upload-tip"},"支持扩展名：.PNG; 小于150kb")))),a.createElement(B,{label:"名称"},i("pasterName",{initialValue:r&&r.pasterName,rules:[{required:!0,message:"请输入名称"},{max:20,message:"超过最大输入长度20"}]})(a.createElement(m.a,{maxLength:20,style:{width:320},onChange:function(e){n.setNewSticker({pasterName:e.target.value},!1)}}))),a.createElement(B,{className:"remark-line",label:"备注"},i("pasterRemark",{initialValue:r&&r.pasterRemark,rules:[{max:100,message:"超过最大输入长度100"}]})(a.createElement("span",null,a.createElement(A,{maxLength:100,style:{width:320},value:r.pasterRemark,onChange:function(e){n.setNewSticker({pasterRemark:e.target.value},!1)}})))))},e.normFile=function(e){return e&&e.fileList},e.customRequest=function(t){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t.file.size/1024>150)){e.next=2;break}return e.abrupt("return",this.$msg.error("图片大小不得超过 150kb"));case 2:return(n=new FormData).append("fileName",t.file),n.append("ypModel","sticker"),e.next=7,this.props.sticker.getUploadUrl(n);case 7:(r=e.sent)&&"0"===r.data.ret&&r.data.data&&r.data.data.fileName&&(a=r.data.data.fileName,this.props.sticker.setNewSticker({imgUrl:[{url:a}],pasterImgUlr:a},!1));case 9:case"end":return e.stop()}},e,this)}))},e.handleUpload=function(t){0===P(t.fileList).length&&e.props.sticker.setNewSticker({imgUrl:[],pasterImgUlr:void 0},!1)},e.showModal=function(t){t&&t.pasterId?(e.setState({modalVisible:!0,modalType:"edit"}),t.shelfTime=[M()(t.pasterShelvesTime),M()(t.pasterUnderTime)],e.props.sticker.setNewSticker(t),e.props.sticker.setLastOperation("edit")):(e.setState({modalVisible:!0,modalType:"add"}),"edit"===e.props.sticker.lastOperation&&e.props.sticker.setNewSticker({}),e.props.sticker.setLastOperation("add"))},e.showUnlockModal=function(t){t&&t.pasterId&&(e.setState({unlockModalVisible:!0}),e.props.sticker.setLockRule({pasterId:t.pasterId,type:1===t.type?t.type:0,limitValue:t.limitValue,tips:t.tips}))},e.renderUnlockAddOrEditModal=function(){var t=e.state,n=t.unlockModalVisible,r=t.unlockConfirmLoading;return n&&a.createElement(c.a,{title:"限制条件",visible:n,onOk:e.handleUnlockSubmit,confirmLoading:r,onCancel:e.handleUnlockCancel,okText:"保存",cancelText:"取消",width:700},e.renderUnlockModalContent())},e.renderUnlockModalContent=function(){var t=e.props.sticker,n=t.lockRule,r=e.props.form.getFieldDecorator;return a.createElement(y.a,Object.assign({className:"sticker-edit-modal"},W,{labelAlign:"left"}),a.createElement(B,{required:!0},a.createElement(K,{compact:!0},a.createElement("span",{className:"ant-form-item-required"}),a.createElement(d.a,{style:{width:150},defaultValue:0,value:n&&n.type,onChange:function(e){t.setLockRule({type:e},!1)}},t.unlockConditions.map(function(e){return a.createElement($,{key:e.value,value:e.value},e.text)})),r("limitValue",{initialValue:n&&n.limitValue,rules:[{required:!0,message:"请输入里程数"},{pattern:/^([1-9][0-9]*\.?[0-9]{0,2})$|^(0(\.[0-9]{0,2})?)$/,message:"里程数只能输入规范的数值，最多两位小数"}]})(a.createElement(m.a,{style:{width:238},onChange:function(e){t.setLockRule({limitValue:e.target.value},!1)},placeholder:"请输入..."})))),a.createElement(B,{label:"提示语"},r("tip",{initialValue:n&&n.tips,rules:[{required:!0,message:"请输入提示语"},{max:30,message:"超过最大输入长度30"}]})(a.createElement(A,{placeholder:"请输入...",style:{width:320},onChange:function(e){t.setLockRule({tips:e.target.value},!1)}}))))},e.handleOk=function(){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,a=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.sticker,n=t.currentNewSticker,(0,t.setNewSticker)({pasterShelvesTime:M()(n.pasterShelvesTime).format("YYYY-MM-DD HH:mm:ss"),pasterUnderTime:M()(n.pasterUnderTime).format("YYYY-MM-DD HH:mm:ss")},!1),this.props.form.validateFields(function(e,t){return r.a(a,void 0,void 0,regeneratorRuntime.mark(function e(){var t,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.getValidation(n))){e.next=5;break}return e.abrupt("return",this.$msg.warn(t));case 5:if(/^([1-9]{1}[0-9]{0,2})$/.test(n.pasterSort)){e.next=8;break}return e.abrupt("return",this.$msg.warn("排序请输入1-999"));case 8:return r=this.props.common.userInfo.empName,this.setState({confirmLoading:!0}),e.next=12,this.props.sticker.updateSticker(r,this.state.filter,this.state.modalType);case 12:a=e.sent,this.setState({stickerlist:a,modalVisible:!1,confirmLoading:!1});case 14:case"end":return e.stop()}},e,this)}))});case 3:case"end":return e.stop()}},e,this)}))},e.getValidation=function(e){var t=new V.a;return t.add(e.pasterSort,[{strategy:"isNonEmpty",errMsg:"请输入排序"}]),t.add(e.pasterShelvesTime,[{strategy:"isNonEmpty",errMsg:"请选择上下架时间"}]),t.add(e.pasterName,[{strategy:"isNonEmpty",errMsg:"请输入名称"}]),t.add(e.pasterName,[{strategy:"maxLength:".concat(20),errMsg:"姓名超过最大输入长度20"}]),t.add(e.pasterImgUlr,[{strategy:"isNonEmpty",errMsg:"请上传图片"}]),e.pasterRemark&&t.add(e.pasterRemark,[{strategy:"maxLength:".concat(100),errMsg:"备注超过最大输入长度100"}]),t.start()},e.handleCancel=function(){e.setState({modalVisible:!1})},e.handleUnlockSubmit=function(){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var t,n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.sticker.lockRule,this.props.form.validateFields(function(e,a){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n,r,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this.getUnlockValidation(t))){e.next=5;break}return e.abrupt("return",this.$msg.warn(n));case 5:if(/^([1-9][0-9]*\.?[0-9]{0,2})$|^(0(\.[0-9]{0,2})?)$/.test(t.limitValue)){e.next=10;break}return e.abrupt("return",this.$msg.warn("里程数只能输入规范的数值，最多两位小数"));case 10:if(!/^(.*\.)$/.test(t.limitValue)){e.next=12;break}return e.abrupt("return",this.$msg.warn("小数点后需有数字"));case 12:return r=this.props.common.userInfo.empName,this.setState({unlockConfirmLoading:!0}),e.next=16,this.props.sticker.updateLockRule(r,this.state.filter);case 16:a=e.sent,this.setState({stickerlist:a,unlockModalVisible:!1,unlockConfirmLoading:!1});case 18:case"end":return e.stop()}},e,this)}))});case 2:case"end":return e.stop()}},e,this)}))},e.getUnlockValidation=function(e){var t=new V.a;return t.add(e.limitValue,[{strategy:"isNonEmpty",errMsg:"请输入里程数"}]),t.add(e.tips,[{strategy:"isNonEmpty",errMsg:"请输入提示语"}]),t.add(e.tips,[{strategy:"maxLength:".concat(30),errMsg:"提示语超过最大输入长度30"}]),t.start()},e.handleUnlockCancel=function(){e.setState({unlockModalVisible:!1})},e.deleteStickerById=function(t){return r.a(L(e),void 0,void 0,regeneratorRuntime.mark(function e(){var n=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:_({title:"删除贴纸操作",content:"贴纸将会被删除，请问是否确认？",onOk:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.props.sticker.deleteStickerById(t,this.state.filter);case 2:n=e.sent,this.setState({stickerlist:n});case 4:case"end":return e.stop()}},e,this)}))},onCancel:function(){return r.a(n,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}});case 1:case"end":return e.stop()}},e)}))},e}var n,i,l;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&H(e,t)}(t,o["a"]),n=t,(i=[{key:"componentDidMount",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){var t,n,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.props.common.paginationConfig,n=t.defaultPageSize,r=t.defaultCurrent,this.resetPagination(n,r);case 2:case"end":return e.stop()}},e,this)}))}},{key:"componentWillReact",value:function(){}},{key:"componentDidUpdate",value:function(){return r.a(this,void 0,void 0,regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e)}))}},{key:"render",value:function(){var e=this,t=this.props.match;return a.createElement("div",null,a.createElement(S.a,Object.assign({},this.props,{links:z,title:"贴纸管理"})),a.createElement(s.a,{path:"".concat(t.url),render:function(t){return a.createElement(C.a,Object.assign({},t,{config:I(e)}))}}),this.renderAddOrEditModal(),this.renderUnlockAddOrEditModal())}}])&&Y(n.prototype,i),l&&Y(n,l),t}();Z=r.b([Object(i.a)("/admin/commerce/sticker",{exact:!1}),y.a.create(),Object(w.b)("common","sticker"),w.c],Z);t.default=Z}}]);