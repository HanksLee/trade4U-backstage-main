(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1014:function(e,t,n){"use strict";n.d(t,"a",(function(){return c}));var r=n(0),o=n(998),i=n.n(o),a=(n(997),n(33));n(1016);function c(e){var t=a.a.getPageBreadcrumb(e.location.pathname),n=e.title,o=e.links,c=e.tabs,u=e.currentTab;return r.createElement("div",{className:"common-header"},r.createElement("section",{className:"common-header-breadcrumb"},t&&r.createElement(i.a,null,t.map((function(e,t){return r.createElement(i.a.Item,{key:t},e.title)})))),r.createElement("section",{className:"common-header-title"},r.createElement("h2",null,n),r.createElement("div",{className:"common-header-links"},o&&o.map((function(t,n){return r.createElement("a",{key:n,onClick:function(){e.history.push(t.path)}},t.title)})))),r.createElement("section",{className:"common-header-tabs"},c&&c.map((function(t,n){return r.createElement("a",{onClick:function(){e.onTabClick(t.id)},className:"".concat(u===t.id?"tab-active":""," ")},r.createElement("span",null,t.title),t.tipComponent&&t.tipComponent())}))))}},1015:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(0),o=n(92);function i(e,t){return function(n){return function(){return r.createElement(o.b,Object.assign({path:e},Object.assign({exact:!0},t),{render:function(e){return r.createElement(n,Object.assign({},e))}}))}}}},1016:function(e,t,n){},1024:function(e,t,n){},1025:function(e,t,n){},1034:function(e,t,n){"use strict";n.r(t);var r=n(8),o=n(0),i=n(81),a=n(1015),c=(n(1025),n(82)),u=n(1014);function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function p(e,t){return!t||"object"!==s(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function d(e,t){return(d=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var b=function(e){function t(){var e;return l(this,t),(e=p(this,m(t).apply(this,arguments))).state={},e}var n,r,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&d(e,t)}(t,e),n=t,(r=[{key:"render",value:function(){return o.createElement("div",null,o.createElement(u.a,Object.assign({},this.props,{links:[],title:"权限管理"})))}}])&&f(n.prototype,r),i&&f(n,i),t}(i.a);b=Object(r.b)([Object(a.a)("/dashboard/auth",{exact:!1}),Object(c.b)("common"),c.c],b),t.default=b},1035:function(e,t,n){"use strict";n.r(t);var r=n(8),o=n(1014),i=n(1006),a=n.n(i),c=n(0),u=n(81),s=n(1012),l=n(1013);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var h=-1,v=function(e){function t(){return p(this,t),d(this,b(t).apply(this,arguments))}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){var e=this.props,t=e.isSorting,n=e.isOver,o=e.connectDragSource,i=e.connectDropTarget,a=(e.moveRow,Object(r.c)(e,["isSorting","isOver","connectDragSource","connectDropTarget","moveRow"])),u=Object.assign({},a.style),s=a.className;return n&&t&&(a.index>h&&(s+=" drop-over-downward"),a.index<h&&(s+=" drop-over-upward"),u=Object.assign(Object.assign({},u),{cursor:"move"})),o(i(c.createElement("tr",Object.assign({},a,{className:s,style:u}))))}}])&&m(n.prototype,o),i&&m(n,i),t}(u.a),g={canDrag:function(e){return e.isSorting},beginDrag:function(e){return h=e.index,{record:e.record,index:e.index}}},w=Object(s.a)("row",{canDrop:function(e,t){var n=t.getItem().record,r=e.record;return n.parent===r.parent},drop:function(e,t){var n=t.getItem().index,r=e.index;n!==r&&(e.moveRow(n,r,t.getItem().record),t.getItem().index=r)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))(Object(l.a)("row",g,(function(e){return{connectDragSource:e.dragSource()}}))(v)),O=n(90),E=n.n(O),S=(n(410),n(151)),M=n.n(S),j=(n(278),n(996)),k=n.n(j);n(995);function _(e){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function x(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return!t||"object"!==_(t)&&"function"!=typeof t?T(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function T(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function N(e,t){return(N=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=E.a.Item,D=function(e){function t(){var e;return x(this,t),(e=P(this,R(t).apply(this,arguments))).handleSubmit=function(){var t=e.props,n=t.form,o=t.menu;n.validateFields((function(t,n){return Object(r.a)(T(e),void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=12;break}if(r=n,o){e.next=8;break}return e.next=5,this.$api.menus.createMenu(r);case 5:this.$msg.success("创建成功"),e.next=11;break;case 8:return e.next=10,this.$api.menus.updateMenu(o.id,r);case 10:this.$msg.success("编辑成功");case 11:this.props.onOk();case 12:case"end":return e.stop()}}),e,this)})))}))},e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&N(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){var e,t=this.props,n=t.menu,r=t.onCancel,o=t.form.getFieldDecorator;return c.createElement(k.a,{visible:!0,title:n?"编辑菜单":"添加菜单",onOk:this.handleSubmit,onCancel:r},c.createElement(E.a,null,c.createElement(L,Object.assign({label:"菜单名称"},{labelCol:{span:4,offset:e},wrapperCol:{span:20}},{required:!0}),o("name",{initialValue:n&&n.name,rules:[{required:!0,message:"请填写菜单名称"}]})(c.createElement(M.a,{placeholder:"请输入菜单名称",style:{display:"inline-block",width:200}})))))}}])&&C(n.prototype,o),i&&C(n,i),t}(u.a),$=E.a.create()(D);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?V(e):t}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var B=E.a.Item,z=function(e){function t(){var e;return F(this,t),(e=J(this,U(t).apply(this,arguments))).handleSubmit=function(){var t=e.props,n=t.form,o=t.menu,i=t.mode;n.validateFields((function(t,n){return Object(r.a)(V(e),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=11;break}if("add"!==i){e.next=7;break}return e.next=4,this.$api.menus.createMenu(Object.assign(Object.assign({},n),{parent:o.id}));case 4:this.$msg.success("创建成功"),e.next=10;break;case 7:return e.next=9,this.$api.menus.updateMenu(o.id,n);case 9:this.$msg.success("编辑成功");case 10:this.props.onOk();case 11:case"end":return e.stop()}}),e,this)})))}))},e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){var e=this.props,t=e.form,n=e.mode,r=e.menu;"edit"===n&&t.setFieldsValue({name:r.name})}},{key:"render",value:function(){var e,t=this.props,n=t.onCancel,r=t.form,o=t.mode,i=r.getFieldDecorator;return c.createElement(k.a,{visible:!0,title:"add"===o?"新增子菜单":"编辑子菜单",onOk:this.handleSubmit,onCancel:n},c.createElement(E.a,null,c.createElement(B,Object.assign({label:"子菜单名称"},{labelCol:{span:5,offset:e},wrapperCol:{span:19}},{required:!0}),i("name",{rules:[{required:!0,message:"请填写子菜单名称"}]})(c.createElement(M.a,{placeholder:"请输入子菜单名称",style:{display:"inline-block",width:200}})))))}}])&&q(n.prototype,o),i&&q(n,i),t}(u.a),A=E.a.create()(z),G=n(1009),H=n(1015),K=n(1011),Q=n(95),X=n.n(Q),Y=(n(129),n(16)),Z=n.n(Y),ee=(n(197),n(1e3)),te=n.n(ee),ne=(n(999),n(1002)),re=n.n(ne);n(1001),n(1024);function oe(e){return(oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function ie(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function ae(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ce(e,t){return!t||"object"!==oe(t)&&"function"!=typeof t?se(e):t}function ue(e){return(ue=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function se(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function le(e,t){return(le=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var fe=function(e){function t(){var e;return ie(this,t),(e=ce(this,ue(t).apply(this,arguments))).state={menuList:[],currentMenu:null,currentMode:"add",isShowEditMenuModal:!1,isShowEditSubMenuModal:!1,isSorting:!1},e.getMenuList=function(){return Object(r.a)(se(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.menus.getMenuList();case 2:t=e.sent,this.setState({menuList:t.data});case 4:case"end":return e.stop()}}),e,this)})))},e.getTableColumns=function(){return[{key:"name",title:"菜单名称",dataIndex:"name"},{key:"action",title:"操作",render:function(t,n){return c.createElement("div",{className:"common-list-table-operation"},!n.parent&&c.createElement(c.Fragment,null,c.createElement("span",{onClick:function(){return e.showEditSubMenuModal(n,"add")}},"添加"),c.createElement("span",{className:"common-list-table-operation-spliter"})),n.parent?c.createElement("span",{onClick:function(){return e.showEditSubMenuModal(n,"edit")}},"编辑"):c.createElement("span",{onClick:function(){return e.showEditMenuModal(n)}},"编辑"),c.createElement("span",{className:"common-list-table-operation-spliter"}),e.state.isSorting?c.createElement("span",null,"删除"):c.createElement(re.a,{title:"确认删除？",onConfirm:function(){return e.deleteMenu(n.id)}},c.createElement("span",null,"删除")))}}]},e.showEditMenuModal=function(t){e.state.isSorting||(t&&e.setState({currentMenu:t}),e.setState({isShowEditMenuModal:!0}))},e.hideEditMenuModal=function(){e.setState({isShowEditMenuModal:!1,currentMenu:null})},e.showEditSubMenuModal=function(t,n){e.state.isSorting||(e.setState({currentMenu:t}),e.setState({isShowEditSubMenuModal:!0,currentMode:n}))},e.hideEditSubMenuModal=function(){e.setState({isShowEditSubMenuModal:!1,currentMenu:null})},e.handleUpdateMenu=function(){e.hideEditMenuModal(),e.hideEditSubMenuModal(),e.getMenuList()},e.deleteMenu=function(t){return Object(r.a)(se(e),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.menus.deleteMenu(t);case 2:this.getMenuList();case 3:case"end":return e.stop()}}),e,this)})))},e.editMenusSort=function(){e.setState({isSorting:!0})},e.moveRow=function(t,n,r){var o=e.state.menuList,i=a()(o);if(r.parent){for(var c=0;c<i.length;c++)if(i[c].id===r.parent){var u=i[c].children;u.splice(n,0,u.splice(t,1)[0]);break}}else i.splice(n,0,i.splice(t,1)[0]);e.setState({menuList:i})},e.formatMenuListWithPriority=function(e){var t=a()(e);return t.forEach((function(e,t){e.priority=t,e.children&&e.children.forEach((function(e,t){e.priority=t}))})),t.map((function(e){var t={};return t.id=e.id,t.priority=e.priority,e.children&&(t.children=e.children.map((function(e){return{id:e.id,priority:e.priority}}))),t}))},e.saveMenusSort=function(){return Object(r.a)(se(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.formatMenuListWithPriority(this.state.menuList),e.next=3,this.$api.menus.sortMenuList({data:JSON.stringify(t)});case 3:this.setState({isSorting:!1}),this.getMenuList();case 5:case"end":return e.stop()}}),e,this)})))},e}var n,i,u;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&le(e,t)}(t,e),n=t,(i=[{key:"componentDidMount",value:function(){this.getMenuList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.currentMenu,r=t.menuList,i=t.isShowEditMenuModal,a=t.isShowEditSubMenuModal,u=t.currentMode,s=t.isSorting;return c.createElement("div",null,c.createElement(o.a,Object.assign({},this.props,{links:[],title:"菜单管理"})),c.createElement("div",{className:"panel-block common-list"},c.createElement("section",{className:"common-list-addbtn"},c.createElement(X.a,{type:"primary",onClick:function(){return e.showEditMenuModal()},disabled:s},c.createElement(Z.a,{type:"plus"})," 添加"),s?c.createElement(X.a,{onClick:function(){return e.saveMenusSort()}},"保存菜单顺序"):c.createElement(X.a,{type:"primary",onClick:this.editMenusSort},"编辑菜单顺序")),c.createElement("section",{className:"common-list-table"},c.createElement(K.a,{backend:G.a},c.createElement(te.a,{columns:this.getTableColumns(),childrenColumnName:"children",dataSource:r,pagination:!1,components:{body:{row:w}},onRow:function(t,n){return{record:t,isSorting:s,index:n,moveRow:e.moveRow}}})))),i&&c.createElement($,{menu:n,onOk:this.handleUpdateMenu,onCancel:this.hideEditMenuModal}),a&&c.createElement(A,{mode:u,menu:n,onOk:this.handleUpdateMenu,onCancel:this.hideEditSubMenuModal}))}}])&&ae(n.prototype,i),u&&ae(n,u),t}(u.a);fe=Object(r.b)([Object(H.a)("/dashboard/menu",{exact:!1})],fe);t.default=fe}}]);