(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{1064:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(1),o=n(1046),i=n.n(o),a=(n(1045),n(34));n(1065);function u(e){var t=a.a.getPageBreadcrumb(e.location.pathname),n=e.title,o=e.links,u=e.tabs,c=e.currentTab;return r.createElement("div",{className:"common-header"},r.createElement("section",{className:"common-header-breadcrumb"},t&&r.createElement(i.a,null,t.map((function(e,t){return r.createElement(i.a.Item,{key:t},e.title)})))),r.createElement("section",{className:"common-header-title"},r.createElement("h2",null,n),r.createElement("div",{className:"common-header-links"},o&&o.map((function(t,n){return r.createElement("a",{key:n,onClick:function(){e.history.push(t.path)}},t.title)})))),r.createElement("section",{className:"common-header-tabs"},u&&u.map((function(t,n){return r.createElement("a",{onClick:function(){e.onTabClick(t.id)},className:"".concat(c===t.id?"tab-active":""," ")},r.createElement("span",null,t.title),t.tipComponent&&t.tipComponent())}))))}},1065:function(e,t,n){},1066:function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(1),o=n(94);function i(e,t){return function(n){return function(){return r.createElement(o.b,Object.assign({path:e},Object.assign({exact:!0},t),{render:function(e){return r.createElement(n,Object.assign({},e))}}))}}}},1073:function(e,t,n){},1083:function(e,t,n){"use strict";n.r(t);var r=n(8),o=n(1064),i=n(1053),a=n.n(i),u=n(1),c=n(84),s=n(1063),l=n(1062);function f(e){return(f="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function m(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function d(e,t){return!t||"object"!==f(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function h(e,t){return(h=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var y=-1,v=function(e){function t(){return p(this,t),d(this,b(t).apply(this,arguments))}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&h(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){var e=this.props,t=e.isSorting,n=e.isOver,o=e.connectDragSource,i=e.connectDropTarget,a=(e.moveRow,Object(r.c)(e,["isSorting","isOver","connectDragSource","connectDropTarget","moveRow"])),c=Object.assign({},a.style),s=a.className;return n&&t&&(a.index>y&&(s+=" drop-over-downward"),a.index<y&&(s+=" drop-over-upward"),c=Object.assign(Object.assign({},c),{cursor:"move"})),o(i(u.createElement("tr",Object.assign({},a,{className:s,style:c}))))}}])&&m(n.prototype,o),i&&m(n,i),t}(c.a),g={canDrag:function(e){return e.isSorting},beginDrag:function(e){return y=e.index,{record:e.record,index:e.index}}},w=Object(s.a)("row",{canDrop:function(e,t){var n=t.getItem().record,r=e.record;return n.parent===r.parent},drop:function(e,t){var n=t.getItem().index,r=e.index;n!==r&&(e.moveRow(n,r,t.getItem().record),t.getItem().index=r)}},(function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver()}}))(Object(l.a)("row",g,(function(e){return{connectDragSource:e.dragSource()}}))(v)),E=n(86),S=n.n(E),M=(n(434),n(134)),O=n.n(M),j=(n(204),n(1052)),k=n.n(j);n(1051);function x(e){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function C(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function P(e,t){return!t||"object"!==x(t)&&"function"!=typeof t?N(e):t}function R(e){return(R=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function N(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function T(e,t){return(T=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var L=S.a.Item,D=function(e){function t(){var e;return _(this,t),(e=P(this,R(t).apply(this,arguments))).handleSubmit=function(){var t=e.props,n=t.form,o=t.menu;n.validateFields((function(t,n){return Object(r.a)(N(e),void 0,void 0,regeneratorRuntime.mark((function e(){var r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=12;break}if(r=n,o){e.next=8;break}return e.next=5,this.$api.menus.createMenu(r);case 5:this.$msg.success("创建成功"),e.next=11;break;case 8:return e.next=10,this.$api.menus.updateMenu(o.id,r);case 10:this.$msg.success("编辑成功");case 11:this.props.onOk();case 12:case"end":return e.stop()}}),e,this)})))}))},e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&T(e,t)}(t,e),n=t,(o=[{key:"render",value:function(){var e,t=this.props,n=t.menu,r=t.onCancel,o=t.form.getFieldDecorator;return u.createElement(k.a,{visible:!0,title:n?"编辑菜单":"添加菜单",onOk:this.handleSubmit,onCancel:r},u.createElement(S.a,null,u.createElement(L,Object.assign({label:"菜单名称"},{labelCol:{span:4,offset:e},wrapperCol:{span:20}},{required:!0}),o("name",{initialValue:n&&n.name,rules:[{required:!0,message:"请填写菜单名称"}]})(u.createElement(O.a,{placeholder:"请输入菜单名称",style:{display:"inline-block",width:200}})))))}}])&&C(n.prototype,o),i&&C(n,i),t}(c.a),$=S.a.create()(D);function I(e){return(I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function F(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function q(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function J(e,t){return!t||"object"!==I(t)&&"function"!=typeof t?V(e):t}function U(e){return(U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function V(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var B=S.a.Item,K=function(e){function t(){var e;return F(this,t),(e=J(this,U(t).apply(this,arguments))).handleSubmit=function(){var t=e.props,n=t.form,o=t.menu,i=t.mode;n.validateFields((function(t,n){return Object(r.a)(V(e),void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=11;break}if("add"!==i){e.next=7;break}return e.next=4,this.$api.menus.createMenu(Object.assign(Object.assign({},n),{parent:o.id}));case 4:this.$msg.success("创建成功"),e.next=10;break;case 7:return e.next=9,this.$api.menus.updateMenu(o.id,n);case 9:this.$msg.success("编辑成功");case 10:this.props.onOk();case 11:case"end":return e.stop()}}),e,this)})))}))},e}var n,o,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,e),n=t,(o=[{key:"componentDidMount",value:function(){var e=this.props,t=e.form,n=e.mode,r=e.menu;"edit"===n&&t.setFieldsValue({name:r.name})}},{key:"render",value:function(){var e,t=this.props,n=t.onCancel,r=t.form,o=t.mode,i=r.getFieldDecorator;return u.createElement(k.a,{visible:!0,title:"add"===o?"新增子菜单":"编辑子菜单",onOk:this.handleSubmit,onCancel:n},u.createElement(S.a,null,u.createElement(B,Object.assign({label:"子菜单名称"},{labelCol:{span:5,offset:e},wrapperCol:{span:19}},{required:!0}),i("name",{rules:[{required:!0,message:"请填写子菜单名称"}]})(u.createElement(O.a,{placeholder:"请输入子菜单名称",style:{display:"inline-block",width:200}})))))}}])&&q(n.prototype,o),i&&q(n,i),t}(c.a),z=S.a.create()(K),A=n(1066),G=n(97),H=n.n(G),Q=(n(133),n(17)),X=n.n(Q),Y=(n(203),n(1044)),Z=n.n(Y),ee=(n(1043),n(1050)),te=n.n(ee);n(1049),n(1073);function ne(e){return(ne="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function re(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function oe(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function ie(e,t){return!t||"object"!==ne(t)&&"function"!=typeof t?ue(e):t}function ae(e){return(ae=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function ue(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function ce(e,t){return(ce=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var se=function(e){function t(){var e;return re(this,t),(e=ie(this,ae(t).apply(this,arguments))).state={menuList:[],currentMenu:null,currentMode:"add",isShowEditMenuModal:!1,isShowEditSubMenuModal:!1,isSorting:!1},e.getMenuList=function(){return Object(r.a)(ue(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.menus.getMenuList();case 2:t=e.sent,this.setState({menuList:t.data});case 4:case"end":return e.stop()}}),e,this)})))},e.getTableColumns=function(){return[{key:"name",title:"菜单名称",dataIndex:"name"},{key:"action",title:"操作",render:function(t,n){return u.createElement("div",{className:"common-list-table-operation"},!n.parent&&u.createElement(u.Fragment,null,u.createElement("span",{onClick:function(){return e.showEditSubMenuModal(n,"add")}},"添加"),u.createElement("span",{className:"common-list-table-operation-spliter"})),n.parent?u.createElement("span",{onClick:function(){return e.showEditSubMenuModal(n,"edit")}},"编辑"):u.createElement("span",{onClick:function(){return e.showEditMenuModal(n)}},"编辑"),u.createElement("span",{className:"common-list-table-operation-spliter"}),e.state.isSorting?u.createElement("span",null,"删除"):u.createElement(te.a,{title:"确认删除？",onConfirm:function(){return e.deleteMenu(n.id)}},u.createElement("span",null,"删除")))}}]},e.showEditMenuModal=function(t){e.state.isSorting||(t&&e.setState({currentMenu:t}),e.setState({isShowEditMenuModal:!0}))},e.hideEditMenuModal=function(){e.setState({isShowEditMenuModal:!1,currentMenu:null})},e.showEditSubMenuModal=function(t,n){e.state.isSorting||(e.setState({currentMenu:t}),e.setState({isShowEditSubMenuModal:!0,currentMode:n}))},e.hideEditSubMenuModal=function(){e.setState({isShowEditSubMenuModal:!1,currentMenu:null})},e.handleUpdateMenu=function(){e.hideEditMenuModal(),e.hideEditSubMenuModal(),e.getMenuList()},e.deleteMenu=function(t){return Object(r.a)(ue(e),void 0,void 0,regeneratorRuntime.mark((function e(){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$api.menus.deleteMenu(t);case 2:204===(n=e.sent).status?this.getMenuList():this.$msg.error(n.data.message);case 4:case"end":return e.stop()}}),e,this)})))},e.editMenusSort=function(){e.setState({isSorting:!0})},e.moveRow=function(t,n,r){var o=e.state.menuList,i=a()(o);if(r.parent){for(var u=0;u<i.length;u++)if(i[u].id===r.parent){var c=i[u].children;c.splice(n,0,c.splice(t,1)[0]);break}}else i.splice(n,0,i.splice(t,1)[0]);e.setState({menuList:i})},e.formatMenuListWithPriority=function(e){var t=a()(e);return t.forEach((function(e,t){e.priority=t,e.children&&e.children.forEach((function(e,t){e.priority=t}))})),t.map((function(e){var t={};return t.id=e.id,t.priority=e.priority,e.children&&(t.children=e.children.map((function(e){return{id:e.id,priority:e.priority}}))),t}))},e.saveMenusSort=function(){return Object(r.a)(ue(e),void 0,void 0,regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.formatMenuListWithPriority(this.state.menuList),e.next=3,this.$api.menus.sortMenuList({data:JSON.stringify(t)});case 3:this.setState({isSorting:!1}),this.getMenuList();case 5:case"end":return e.stop()}}),e,this)})))},e}var n,i,c;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&ce(e,t)}(t,e),n=t,(i=[{key:"componentDidMount",value:function(){this.getMenuList()}},{key:"render",value:function(){var e=this,t=this.state,n=t.currentMenu,r=t.menuList,i=t.isShowEditMenuModal,a=t.isShowEditSubMenuModal,c=t.currentMode,s=t.isSorting;return u.createElement("div",null,u.createElement(o.a,Object.assign({},this.props,{links:[],title:"菜单管理"})),u.createElement("div",{className:"panel-block common-list"},u.createElement("section",{className:"common-list-addbtn"},u.createElement(H.a,{type:"primary",onClick:function(){return e.showEditMenuModal()},disabled:s},u.createElement(X.a,{type:"plus"})," 添加"),s?u.createElement(H.a,{onClick:function(){return e.saveMenusSort()}},"保存菜单顺序"):u.createElement(H.a,{type:"primary",onClick:this.editMenusSort},"编辑菜单顺序")),u.createElement("section",{className:"common-list-table"},u.createElement(Z.a,{rowKey:"id",columns:this.getTableColumns(),childrenColumnName:"children",dataSource:r,pagination:!1,components:{body:{row:w}},onRow:function(t,n){return{record:t,isSorting:s,index:n,moveRow:e.moveRow}}}))),i&&u.createElement($,{menu:n,onOk:this.handleUpdateMenu,onCancel:this.hideEditMenuModal}),a&&u.createElement(z,{mode:c,menu:n,onOk:this.handleUpdateMenu,onCancel:this.hideEditSubMenuModal}))}}])&&oe(n.prototype,i),c&&oe(n,c),t}(c.a);se=Object(r.b)([Object(A.a)("/dashboard/menu",{exact:!1})],se);t.default=se}}]);